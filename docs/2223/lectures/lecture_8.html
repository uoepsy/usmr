<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Week 8: The Linear Model (ctd)</title>
    <meta charset="utf-8" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/animate.css/animate.xaringan.css" rel="stylesheet" />
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="libs/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/rglWebGL-binding/rglWebGL.js"></script>
    <link href="libs/rglwidgetClass/rgl.css" rel="stylesheet" />
    <script src="libs/rglwidgetClass/rglClass.src.js"></script>
    <script src="libs/rglwidgetClass/utils.src.js"></script>
    <script src="libs/rglwidgetClass/buffer.src.js"></script>
    <script src="libs/rglwidgetClass/subscenes.src.js"></script>
    <script src="libs/rglwidgetClass/shaders.src.js"></script>
    <script src="libs/rglwidgetClass/textures.src.js"></script>
    <script src="libs/rglwidgetClass/projection.src.js"></script>
    <script src="libs/rglwidgetClass/mouse.src.js"></script>
    <script src="libs/rglwidgetClass/init.src.js"></script>
    <script src="libs/rglwidgetClass/pieces.src.js"></script>
    <script src="libs/rglwidgetClass/draw.src.js"></script>
    <script src="libs/rglwidgetClass/controls.src.js"></script>
    <script src="libs/rglwidgetClass/selection.src.js"></script>
    <script src="libs/rglwidgetClass/rglTimer.src.js"></script>
    <script src="libs/rglwidgetClass/pretty.src.js"></script>
    <script src="libs/rglwidgetClass/axes.src.js"></script>
    <script src="libs/rglwidgetClass/animation.src.js"></script>
    <!--html_preserve--><script type = "text/plain" id = "rgl-vertex-shader">
    #line 2 1
    // File 1 is the vertex shader
    #ifdef GL_ES
    #ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    #else
    precision mediump float;
    #endif
    #endif

    attribute vec3 aPos;
    attribute vec4 aCol;
    uniform mat4 mvMatrix;
    uniform mat4 prMatrix;
    varying vec4 vCol;
    varying vec4 vPosition;

    #ifdef NEEDS_VNORMAL
    attribute vec3 aNorm;
    uniform mat4 normMatrix;
    varying vec4 vNormal;
    #endif

    #if defined(HAS_TEXTURE) || defined (IS_TEXT)
    attribute vec2 aTexcoord;
    varying vec2 vTexcoord;
    #endif

    #ifdef FIXED_SIZE
    uniform vec3 textScale;
    #endif

    #ifdef FIXED_QUADS
    attribute vec3 aOfs;
    #endif

    #ifdef IS_TWOSIDED
    #ifdef HAS_NORMALS
    varying float normz;
    uniform mat4 invPrMatrix;
    #else
    attribute vec3 aPos1;
    attribute vec3 aPos2;
    varying float normz;
    #endif
    #endif // IS_TWOSIDED

    #ifdef FAT_LINES
    attribute vec3 aNext;
    attribute vec2 aPoint;
    varying vec2 vPoint;
    varying float vLength;
    uniform float uAspect;
    uniform float uLwd;
    #endif


    void main(void) {
      
    #ifndef IS_BRUSH
    #if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG)
      vPosition = mvMatrix * vec4(aPos, 1.);
    #endif
      
    #ifndef FIXED_QUADS
      gl_Position = prMatrix * vPosition;
    #endif
    #endif // !IS_BRUSH
      
    #ifdef IS_POINTS
      gl_PointSize = POINTSIZE;
    #endif
      
      vCol = aCol;
      
    #ifdef NEEDS_VNORMAL
      vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));
    #endif
      
    #ifdef IS_TWOSIDED
    #ifdef HAS_NORMALS
      /* normz should be calculated *after* projection */
      normz = (invPrMatrix*vNormal).z;
    #else
      vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));
      pos1 = pos1/pos1.w - gl_Position/gl_Position.w;
      vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));
      pos2 = pos2/pos2.w - gl_Position/gl_Position.w;
      normz = pos1.x*pos2.y - pos1.y*pos2.x;
    #endif
    #endif // IS_TWOSIDED
      
    #ifdef NEEDS_VNORMAL
      vNormal = vec4(normalize(vNormal.xyz/vNormal.w), 1);
    #endif
      
    #if defined(HAS_TEXTURE) || defined(IS_TEXT)
      vTexcoord = aTexcoord;
    #endif
      
    #if defined(FIXED_SIZE) && !defined(ROTATING)
      vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);
      pos = pos/pos.w;
      gl_Position = pos + vec4(aOfs*textScale, 0.);
    #endif
      
    #if defined(IS_SPRITES) && !defined(FIXED_SIZE)
      vec4 pos = mvMatrix * vec4(aPos, 1.);
      pos = pos/pos.w + vec4(aOfs,  0.);
      gl_Position = prMatrix*pos;
    #endif
      
    #ifdef FAT_LINES
      /* This code was inspired by Matt Deslauriers' code in 
       https://mattdesl.svbtle.com/drawing-lines-is-hard */
      vec2 aspectVec = vec2(uAspect, 1.0);
      mat4 projViewModel = prMatrix * mvMatrix;
      vec4 currentProjected = projViewModel * vec4(aPos, 1.0);
      currentProjected = currentProjected/currentProjected.w;
      vec4 nextProjected = projViewModel * vec4(aNext, 1.0);
      vec2 currentScreen = currentProjected.xy * aspectVec;
      vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;
      float len = uLwd;
      vec2 dir = vec2(1.0, 0.0);
      vPoint = aPoint;
      vLength = length(nextScreen - currentScreen)/2.0;
      vLength = vLength/(vLength + len);
      if (vLength > 0.0) {
        dir = normalize(nextScreen - currentScreen);
      }
      vec2 normal = vec2(-dir.y, dir.x);
      dir.x /= uAspect;
      normal.x /= uAspect;
      vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);
      gl_Position = currentProjected + offset;
    #endif
      
    #ifdef IS_BRUSH
      gl_Position = vec4(aPos, 1.);
    #endif
    }
    </script>
    <script type = "text/plain" id = "rgl-fragment-shader">
    #line 2 2
    // File 2 is the fragment shader
    #ifdef GL_ES
    #ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    #else
    precision mediump float;
    #endif
    #endif
    varying vec4 vCol; // carries alpha
    varying vec4 vPosition;
    #if defined(HAS_TEXTURE) || defined (IS_TEXT)
    varying vec2 vTexcoord;
    uniform sampler2D uSampler;
    #endif

    #ifdef HAS_FOG
    uniform int uFogMode;
    uniform vec3 uFogColor;
    uniform vec4 uFogParms;
    #endif

    #if defined(IS_LIT) && !defined(FIXED_QUADS)
    varying vec4 vNormal;
    #endif

    #if NCLIPPLANES > 0
    uniform vec4 vClipplane[NCLIPPLANES];
    #endif

    #if NLIGHTS > 0
    uniform mat4 mvMatrix;
    #endif

    #ifdef IS_LIT
    uniform vec3 emission;
    uniform float shininess;
    #if NLIGHTS > 0
    uniform vec3 ambient[NLIGHTS];
    uniform vec3 specular[NLIGHTS]; // light*material
    uniform vec3 diffuse[NLIGHTS];
    uniform vec3 lightDir[NLIGHTS];
    uniform bool viewpoint[NLIGHTS];
    uniform bool finite[NLIGHTS];
    #endif
    #endif // IS_LIT

    #ifdef IS_TWOSIDED
    uniform bool front;
    varying float normz;
    #endif

    #ifdef FAT_LINES
    varying vec2 vPoint;
    varying float vLength;
    #endif

    void main(void) {
      vec4 fragColor;
    #ifdef FAT_LINES
      vec2 point = vPoint;
      bool neg = point.y < 0.0;
      point.y = neg ? (point.y + vLength)/(1.0 - vLength) :
                     -(point.y - vLength)/(1.0 - vLength);
    #if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)
      if (neg && length(point) <= 1.0) discard;
    #endif
      point.y = min(point.y, 0.0);
      if (length(point) > 1.0) discard;
    #endif // FAT_LINES
      
    #ifdef ROUND_POINTS
      vec2 coord = gl_PointCoord - vec2(0.5);
      if (length(coord) > 0.5) discard;
    #endif
      
    #if NCLIPPLANES > 0
      for (int i = 0; i < NCLIPPLANES; i++)
        if (dot(vPosition, vClipplane[i]) < 0.0) discard;
    #endif
        
    #ifdef FIXED_QUADS
        vec3 n = vec3(0., 0., 1.);
    #elif defined(IS_LIT)
        vec3 n = normalize(vNormal.xyz);
    #endif
        
    #ifdef IS_TWOSIDED
        if ((normz <= 0.) != front) discard;
    #endif
        
    #ifdef IS_LIT
        vec3 eye = normalize(-vPosition.xyz/vPosition.w);
        vec3 lightdir;
        vec4 colDiff;
        vec3 halfVec;
        vec4 lighteffect = vec4(emission, 0.);
        vec3 col;
        float nDotL;
    #ifdef FIXED_QUADS
        n = -faceforward(n, n, eye);
    #endif
        
    #if NLIGHTS > 0
        for (int i=0;i<NLIGHTS;i++) {
          colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);
          lightdir = lightDir[i];
          if (!viewpoint[i])
            lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;
          if (!finite[i]) {
            halfVec = normalize(lightdir + eye);
          } else {
            lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);
            halfVec = normalize(lightdir + eye);
          }
          col = ambient[i];
          nDotL = dot(n, lightdir);
          col = col + max(nDotL, 0.) * colDiff.rgb;
          col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];
          lighteffect = lighteffect + vec4(col, colDiff.a);
        }
    #endif
        
    #else // not IS_LIT
        vec4 colDiff = vCol;
        vec4 lighteffect = colDiff;
    #endif
        
    #ifdef IS_TEXT
        vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
    #endif
        
    #ifdef HAS_TEXTURE
    #ifdef TEXTURE_rgb
        vec4 textureColor = lighteffect*vec4(texture2D(uSampler, vTexcoord).rgb, 1.);
    #endif
        
    #ifdef TEXTURE_rgba
        vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
    #endif
        
    #ifdef TEXTURE_alpha
        vec4 textureColor = texture2D(uSampler, vTexcoord);
        float luminance = dot(vec3(1.,1.,1.), textureColor.rgb)/3.;
        textureColor =  vec4(lighteffect.rgb, lighteffect.a*luminance);
    #endif
        
    #ifdef TEXTURE_luminance
        vec4 textureColor = vec4(lighteffect.rgb*dot(texture2D(uSampler, vTexcoord).rgb, vec3(1.,1.,1.))/3., lighteffect.a);
    #endif
        
    #ifdef TEXTURE_luminance_alpha
        vec4 textureColor = texture2D(uSampler, vTexcoord);
        float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;
        textureColor = vec4(lighteffect.rgb*luminance, lighteffect.a*textureColor.a);
    #endif
        
        fragColor = textureColor;

    #elif defined(IS_TEXT)
        if (textureColor.a < 0.1)
          discard;
        else
          fragColor = textureColor;
    #else
        fragColor = lighteffect;
    #endif // HAS_TEXTURE
        
    #ifdef HAS_FOG
        // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))
        // In Exp and Exp2: use density = density/far
        // fogF will be the proportion of fog
        // Initialize it to the linear value
        float fogF;
        if (uFogMode > 0) {
          fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);
          if (uFogMode > 1)
            fogF = mix(uFogParms.w, 1.0, fogF);
          fogF = fogF*uFogParms.z;
          if (uFogMode == 2)
            fogF = 1.0 - exp(-fogF);
          // Docs are wrong: use (density*c)^2, not density*c^2
          // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58
          else if (uFogMode == 3)
            fogF = 1.0 - exp(-fogF*fogF);
          fogF = clamp(fogF, 0.0, 1.0);
          gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);
        } else gl_FragColor = fragColor;
    #else
        gl_FragColor = fragColor;
    #endif // HAS_FOG
        
    }
    </script><!--/html_preserve-->
    <script src="libs/CanvasMatrix4/CanvasMatrix.src.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="mc_libs/tweaks.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# <b>Week 8: The Linear Model (ctd)</b>
]
.subtitle[
## Univariate Statistics and Methodology using R
]
.author[
### 
]
.institute[
### Department of Psychology<br/>The University of Edinburgh
]

---







class: inverse, center, middle
# Part 1
## Quick Refresh

---
# Some new data

.pull-left[
![](lecture_8_files/figure-html/frecap2-1.svg)&lt;!-- --&gt;
]
.pull-right[
![](lecture_8_files/img/playmo_police.jpg)

]

---
# Some new data

.pull-left[
![](lecture_8_files/figure-html/frecap22-1.svg)&lt;!-- --&gt;

.tc[
"for every extra 0.01% blood alcohol, reaction time slows down by around 32 ms"
]
]
.pull-right[
![](lecture_8_files/img/playmo_police.jpg)
]

---
# The Model

.pull-left[

```r
mod &lt;- lm(RT~BloodAlc, data=dat)
summary(mod)
```

```
## 
## Call:
## lm(formula = RT ~ BloodAlc, data = dat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -115.92  -40.42    1.05   42.93  126.64 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      321         91    3.53  0.00093 ***
## BloodAlc        3228        888    3.64  0.00067 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 55.8 on 48 degrees of freedom
## Multiple R-squared:  0.216,	Adjusted R-squared:   0.2 
## F-statistic: 13.2 on 1 and 48 DF,  p-value: 0.000673
```
]

???
- note the _huge_ affect of `BloodAlc`

- why is this? [pause?]

- because these are "real" units, not units x 100

---
# Another (identical) Model



```r
dat &lt;- dat %&gt;% mutate(BloodAlc100 = BloodAlc*100)
mod2 &lt;- lm(RT~BloodAlc100, data=dat)
summary(mod2)
```

```
## 
## Call:
## lm(formula = RT ~ BloodAlc100, data = dat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -115.92  -40.42    1.05   42.93  126.64 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   321.24      91.05    3.53  0.00093 ***
## BloodAlc100    32.28       8.88    3.64  0.00067 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 55.8 on 48 degrees of freedom
## Multiple R-squared:  0.216,	Adjusted R-squared:   0.2 
## F-statistic: 13.2 on 1 and 48 DF,  p-value: 0.000673
```


---
class: inverse, center, middle
# Part 2
## Checking Assumptions


---
# Assumptions of Linear Models

.pull-left[
.br3.bg-gray.white.pa2[
### required
- **linearity** of relationship(!)

- for the _residuals_:
  + **normality**
  + **homogeneity of variance**
  + **independence**
]
]
.pull-right[
.br3.bg-gray.white.pa2[
### desirable
&lt;!-- - uncorrelated predictors (no collinearity) --&gt;
- no 'bad' (overly influential) observations
]]

---
# Residuals

.pull-left[
`$$y_i=b_0+b_1\cdot{}x_i+\epsilon_i$$`
`$$\color{red}{\epsilon\sim{}N(0,\sigma)~\text{independently}}$$`
- normally distributed (mean should be `\(\simeq{}\)` zero)

- homogeneous (differences from `\(\hat{y}\)` shouldn't be systematically smaller or larger for different `\(x\)`)

- independent (residuals shouldn't influence other residuals)
]
.pull-right[
![](lecture_8_files/figure-html/resid-1.svg)&lt;!-- --&gt;
]

---
# At A Glance

```r
summary(mod)
```

```
## 
## Call:
## lm(formula = RT ~ BloodAlc, data = dat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
*## -115.92  -40.42    1.05   42.93  126.64 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      321         91    3.53  0.00093 ***
## BloodAlc        3228        888    3.64  0.00067 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 55.8 on 48 degrees of freedom
## Multiple R-squared:  0.216,	Adjusted R-squared:   0.2 
## F-statistic: 13.2 on 1 and 48 DF,  p-value: 0.000673
```

---
# In More Detail



.pull-left[
### linearity


```r
plot(mod,which=1)
```
- plots residuals `\(\epsilon_i\)` against fitted values `\(\hat{y}_i\)`

- the 'average residual' is roughly zero across `\(\hat{y}\)`, so relationship is likely to be linear
]
.pull-right[
![](lecture_8_files/figure-html/resid1-1.svg)
]

---
# In More Detail

.pull-left[
### normality


```r
hist(resid(mod))
```
]
.pull-right[
![](lecture_8_files/figure-html/resid2-1.svg)
]

---
count: false
# In More Detail

.pull-left[
### normality


```r
plot(density(resid(mod)))
```

- check that residuals `\(\epsilon\)` are approximately normally distributed

- in fact there's a better way of doing this...
]
.pull-right[
![](lecture_8_files/figure-html/resid3-1.svg)
]

---
name: QQ
# In More Detail

.pull-left[
### normality


```r
plot(mod,which=2)
```

- **Q-Q plot** compares the residuals `\(\epsilon\)` against a known distribution (here, normal)

- observations close to the straight line mean residuals are approximately normal

- numbered observations refer to _row numbers_ in the original data, for checking
]
.pull-right[
![](lecture_8_files/figure-html/resid4-1.svg)
]

---
# Q-Q Plots


.pull-left[
#### y axis

- Our residuals, in terms of "standard deviations from the mean": `\(\text{standardized residual} = \frac{\text{residual}-mean(\text{residual})}{sd(\text{residual})}\)`


```r
scale(resid(mod))
```
```
[1] -2.10063 -1.51541 -1.46399 -1.33279 -1.30350 
[6] -1.27782 -1.19769 -1.12129 -1.09559 -0.86440
...
...
```
]


--

.pull-right[
#### y axis

- we have 50 residuals.  

- for a normal distribution, what values _should_ 1/50th, 2/50th, 3/50th (etc) of the observations lie below? 

- expressed in "standard deviations from the mean"


```r
qnorm(c(1/50,2/50,3/50))
```

```
## [1] -2.054 -1.751 -1.555
```
]

--

- Q-Q Plot shows these values plotted against each other

???

it's actually not quite 1/50, but 0.5/50, because it's the centres of those areas
so this is the qqplot: 
plot(x=qnorm(seq(0.5,49.5)/50),y=sort(scale(resid(mod))))

---
template: QQ
---
# In More Detail

.pull-left[
### homogeneity of variance


```r
plot(mod,which=3)
```

- the _size_ of the residuals is approximately the same across values of `\(\hat{y}\)`
]
.pull-right[
![](lecture_8_files/figure-html/resid5-1.svg)
]

---
# Visual vs Other Methods

- statistical ways of checking assumptions are introduced in the reading

- they tend to have limitations (for example, they're susceptible to sample size)

- nothing beats looking at plots like these (and `plot(&lt;model&gt;)` makes it easy)

- however, two things:

--

.pt2[
1. there are no criteria for deciding exactly when assumptions are sufficiently met

  + it's a matter of experience and judgement
  
1. we need to talk about **independence** of residuals
]

---
class: inverse, center, middle, animated, flip
# End of Part 2

---
class: inverse, center, middle
# Part 3
## Independence, Influence

---
# Independence

- no easy way to check independence of residuals

- in part, because it depends on the _source_ of the observations

.pt2[
- one determinant might be a single person being observed multiple times

- e.g., my reaction times might tend to be slower than yours&lt;br/&gt;
  `\(\rightarrow\)` multivariate statistics
]

---
# Independence

- another determinant might be _time_

- observations in a sequence might be autocorrelated
  
- can be checked using the Durbin-Watson Test from the `car` package
  

```r
library(car)
dwt(mod)
```

```
##  lag Autocorrelation D-W Statistic p-value
*##    1         -0.1377          2.22    0.42
##  Alternative hypothesis: rho != 0
```

- shows no autocorrelation at lag 1

---
# Influence
.center[
![](lecture_8_files/figure-html/baddata1-1.svg)&lt;!-- --&gt;
]
- even substantial **outliers** may only have small effects on the model

- here, only the intercept is affected

---
# Influence
.center[
![](lecture_8_files/figure-html/baddata2-1.svg)&lt;!-- --&gt;
]
- observations with high **leverage** are inconsistent with other data, but may not be distorting the model

---
# Influence
.center[
![](lecture_8_files/figure-html/baddata3-1.svg)&lt;!-- --&gt;
]
- we care about observations with high **influence** (outliers with high leverage)

---
# Cook's Distance

.center[
![](lecture_8_files/figure-html/cook-1.svg)&lt;!-- --&gt;
]

- a standardised measure of "how much the model differs without observation `\(i\)`"

---
.flex.items-center[.w-10.pa1[![:scale 70%](lecture_8_files/img/danger.svg)] .f1.w-80.pa1[Cook's Distance]]

.pt3[
`$$D_i=\frac{\sum_{j=1}^{n}{(\hat{y}_j-\hat{y}_{j(i)})^2}}{(p+1)\hat{\sigma}^2}$$`
- `\(\hat{y}+j\)` is the `\(j\)`th fitted value
- `\(\hat{y}_{j(i)}\)` is the `\(j\)`th value from a fit which doesn't include observation `\(i\)`
- `\(p\)` is the number of regression coefficients
- `\(\hat{\sigma}^2\)` is the estimated variance from the fit, i.e., mean squared error
]

---
# Cook's Distance



.pull-left[

```r
plot(mod,which=4)
```

- observations labelled by row

- various rules of thumb, but start looking when Cook's Distance &gt; 0.5
]
.pull-right[
![](lecture_8_files/figure-html/cook2-1.svg)
]

---
class: animated, rollIn
# Learning to Read


.pull-left[
![](lecture_8_files/img/playmo_teach.jpg)
]
.pull-right[
- the Playmo School has been evaluating its reading programmes, using 50 students

- ages of students

- hours per week students spend reading of their own volition

- whether they are taught using phonics or whole-word methods

- **outcome: "reading age"**
]

---
count: false
# Learning to Read

.pull-left[
![](lecture_8_files/img/playmo_teach.jpg)
]
.pull-right[
.center[
<div id="chzwqgmpak" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#chzwqgmpak .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#chzwqgmpak .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#chzwqgmpak .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#chzwqgmpak .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#chzwqgmpak .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#chzwqgmpak .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#chzwqgmpak .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#chzwqgmpak .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#chzwqgmpak .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#chzwqgmpak .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#chzwqgmpak .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#chzwqgmpak .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#chzwqgmpak .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#chzwqgmpak .gt_from_md > :first-child {
  margin-top: 0;
}

#chzwqgmpak .gt_from_md > :last-child {
  margin-bottom: 0;
}

#chzwqgmpak .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#chzwqgmpak .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#chzwqgmpak .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#chzwqgmpak .gt_row_group_first td {
  border-top-width: 2px;
}

#chzwqgmpak .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#chzwqgmpak .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#chzwqgmpak .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#chzwqgmpak .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#chzwqgmpak .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#chzwqgmpak .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#chzwqgmpak .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#chzwqgmpak .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#chzwqgmpak .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#chzwqgmpak .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#chzwqgmpak .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#chzwqgmpak .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#chzwqgmpak .gt_left {
  text-align: left;
}

#chzwqgmpak .gt_center {
  text-align: center;
}

#chzwqgmpak .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#chzwqgmpak .gt_font_normal {
  font-weight: normal;
}

#chzwqgmpak .gt_font_bold {
  font-weight: bold;
}

#chzwqgmpak .gt_font_italic {
  font-style: italic;
}

#chzwqgmpak .gt_super {
  font-size: 65%;
}

#chzwqgmpak .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#chzwqgmpak .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#chzwqgmpak .gt_indent_1 {
  text-indent: 5px;
}

#chzwqgmpak .gt_indent_2 {
  text-indent: 10px;
}

#chzwqgmpak .gt_indent_3 {
  text-indent: 15px;
}

#chzwqgmpak .gt_indent_4 {
  text-indent: 20px;
}

#chzwqgmpak .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">age</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">hrs_wk</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col">method</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">R_AGE</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">10.115</td>
<td class="gt_row gt_right">4.971</td>
<td class="gt_row gt_center">phonics</td>
<td class="gt_row gt_right">14.272</td></tr>
    <tr><td class="gt_row gt_right">9.940</td>
<td class="gt_row gt_right">4.677</td>
<td class="gt_row gt_center">phonics</td>
<td class="gt_row gt_right">13.692</td></tr>
    <tr><td class="gt_row gt_right">6.060</td>
<td class="gt_row gt_right">4.619</td>
<td class="gt_row gt_center">phonics</td>
<td class="gt_row gt_right">10.353</td></tr>
    <tr><td class="gt_row gt_right">9.269</td>
<td class="gt_row gt_right">4.894</td>
<td class="gt_row gt_center">phonics</td>
<td class="gt_row gt_right">12.744</td></tr>
    <tr><td class="gt_row gt_right">10.991</td>
<td class="gt_row gt_right">5.035</td>
<td class="gt_row gt_center">phonics</td>
<td class="gt_row gt_right">15.353</td></tr>
    <tr><td class="gt_row gt_right">6.535</td>
<td class="gt_row gt_right">5.272</td>
<td class="gt_row gt_center">word</td>
<td class="gt_row gt_right">5.798</td></tr>
    <tr><td class="gt_row gt_right">8.150</td>
<td class="gt_row gt_right">6.871</td>
<td class="gt_row gt_center">word</td>
<td class="gt_row gt_right">8.691</td></tr>
    <tr><td class="gt_row gt_right">7.941</td>
<td class="gt_row gt_right">4.053</td>
<td class="gt_row gt_center">word</td>
<td class="gt_row gt_right">6.988</td></tr>
    <tr><td class="gt_row gt_right">8.233</td>
<td class="gt_row gt_right">5.474</td>
<td class="gt_row gt_center">word</td>
<td class="gt_row gt_right">8.713</td></tr>
    <tr><td class="gt_row gt_right">6.219</td>
<td class="gt_row gt_right">4.038</td>
<td class="gt_row gt_center">word</td>
<td class="gt_row gt_right">5.908</td></tr>
  </tbody>
  
  
</table>
</div>
]]
???
- this is just some of the data in the dataframe

- on the right you can see the outcome variable, `R_AGE` for reading age.

- note that I tend to put my dependent variables in all caps, just so that I can recognise at a glance that they're what we measured.

---
count: false
# Learning to Read

.pull-left[
![](lecture_8_files/img/playmo_teach.jpg)
]
.pull-right[
.center[
<div id="jluvseuccd" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#jluvseuccd .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jluvseuccd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jluvseuccd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jluvseuccd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jluvseuccd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jluvseuccd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jluvseuccd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jluvseuccd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jluvseuccd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jluvseuccd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jluvseuccd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jluvseuccd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#jluvseuccd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jluvseuccd .gt_from_md > :first-child {
  margin-top: 0;
}

#jluvseuccd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jluvseuccd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jluvseuccd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jluvseuccd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jluvseuccd .gt_row_group_first td {
  border-top-width: 2px;
}

#jluvseuccd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jluvseuccd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jluvseuccd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jluvseuccd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jluvseuccd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jluvseuccd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jluvseuccd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jluvseuccd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jluvseuccd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jluvseuccd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jluvseuccd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jluvseuccd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jluvseuccd .gt_left {
  text-align: left;
}

#jluvseuccd .gt_center {
  text-align: center;
}

#jluvseuccd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jluvseuccd .gt_font_normal {
  font-weight: normal;
}

#jluvseuccd .gt_font_bold {
  font-weight: bold;
}

#jluvseuccd .gt_font_italic {
  font-style: italic;
}

#jluvseuccd .gt_super {
  font-size: 65%;
}

#jluvseuccd .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#jluvseuccd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jluvseuccd .gt_indent_1 {
  text-indent: 5px;
}

#jluvseuccd .gt_indent_2 {
  text-indent: 10px;
}

#jluvseuccd .gt_indent_3 {
  text-indent: 15px;
}

#jluvseuccd .gt_indent_4 {
  text-indent: 20px;
}

#jluvseuccd .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">age</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">hrs_wk</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col">method</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">R_AGE</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">10.115</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">4.971</td>
<td class="gt_row gt_center">phonics</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">14.272</td></tr>
    <tr><td class="gt_row gt_right">9.940</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">4.677</td>
<td class="gt_row gt_center">phonics</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">13.692</td></tr>
    <tr><td class="gt_row gt_right">6.060</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">4.619</td>
<td class="gt_row gt_center">phonics</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">10.353</td></tr>
    <tr><td class="gt_row gt_right">9.269</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">4.894</td>
<td class="gt_row gt_center">phonics</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">12.744</td></tr>
    <tr><td class="gt_row gt_right">10.991</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">5.035</td>
<td class="gt_row gt_center">phonics</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">15.353</td></tr>
    <tr><td class="gt_row gt_right">6.535</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">5.272</td>
<td class="gt_row gt_center">word</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">5.798</td></tr>
    <tr><td class="gt_row gt_right">8.150</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">6.871</td>
<td class="gt_row gt_center">word</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">8.691</td></tr>
    <tr><td class="gt_row gt_right">7.941</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">4.053</td>
<td class="gt_row gt_center">word</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">6.988</td></tr>
    <tr><td class="gt_row gt_right">8.233</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">5.474</td>
<td class="gt_row gt_center">word</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">8.713</td></tr>
    <tr><td class="gt_row gt_right">6.219</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">4.038</td>
<td class="gt_row gt_center">word</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">5.908</td></tr>
  </tbody>
  
  
</table>
</div>
]]

---
# Does Practice Affect Reading Age?

.pull-left[


```r
p &lt;- reading %&gt;% 
  ggplot(aes(x=hrs_wk,y=R_AGE)) +
  geom_point(size=3) +
  ylab("reading age") +
  xlab("hours reading/week")
p
```

]
.pull-right[
![](lecture_8_files/figure-html/plot1-1.svg)
]

--

- hours per week is correlated with reading age: `\(r=0.3483\)`,
`\(p=0.0132\)`

- we can use a linear model to say something about the effect size

---
# Does Practice Affect Reading Age?

.pull-left[

```r
p + geom_smooth(method="lm")
```
]
.pull-right[
![](lecture_8_files/figure-html/plot2-1.svg)
]



--

- each extra hour spent reading a week adds 1.26 years to reading age


---
# A Linear Model


```r
mod &lt;- lm(R_AGE ~ hrs_wk, data=reading)
summary(mod)
```

```
## 
## Call:
## lm(formula = R_AGE ~ hrs_wk, data = reading)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
*## -5.567 -2.991  0.378  2.385  5.351 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
*## (Intercept)     3.65       2.47    1.48    0.146  
*## hrs_wk          1.26       0.49    2.57    0.013 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 3.08 on 48 degrees of freedom
*## Multiple R-squared:  0.121,	Adjusted R-squared:  0.103 
*## F-statistic: 6.63 on 1 and 48 DF,  p-value: 0.0132
```

---
class: center, middle, inverse
.f1[but...]

---
.center[
![](lecture_8_files/figure-html/diagp2-1.svg)&lt;!-- --&gt;
]

---
# Assumptions Not Met!
.pull-left[
- it seems that the assumptions aren't met for this model

- (another demonstration on the right)

- one reason for this can be because there's still systematic structure in the residuals

- i.e., _more than one thing_ which can explain the variance
]
.pull-right[
![](lecture_8_files/figure-html/re-1.svg)&lt;!-- --&gt;

]

---
class: inverse, center, middle, animated, flip

# End of Part 3

---
class: inverse, center, middle

# Part 4
## Multiple Regression 

---
# Adding Age into the Equation

.pull-left[
- so far, have focused on effects of practice

- but presumably older children read better?

<div id="ygnkjrteau" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ygnkjrteau .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ygnkjrteau .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ygnkjrteau .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ygnkjrteau .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ygnkjrteau .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ygnkjrteau .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ygnkjrteau .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ygnkjrteau .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ygnkjrteau .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ygnkjrteau .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ygnkjrteau .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ygnkjrteau .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ygnkjrteau .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ygnkjrteau .gt_from_md > :first-child {
  margin-top: 0;
}

#ygnkjrteau .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ygnkjrteau .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ygnkjrteau .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ygnkjrteau .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ygnkjrteau .gt_row_group_first td {
  border-top-width: 2px;
}

#ygnkjrteau .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ygnkjrteau .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ygnkjrteau .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ygnkjrteau .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ygnkjrteau .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ygnkjrteau .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ygnkjrteau .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ygnkjrteau .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ygnkjrteau .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ygnkjrteau .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ygnkjrteau .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ygnkjrteau .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ygnkjrteau .gt_left {
  text-align: left;
}

#ygnkjrteau .gt_center {
  text-align: center;
}

#ygnkjrteau .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ygnkjrteau .gt_font_normal {
  font-weight: normal;
}

#ygnkjrteau .gt_font_bold {
  font-weight: bold;
}

#ygnkjrteau .gt_font_italic {
  font-style: italic;
}

#ygnkjrteau .gt_super {
  font-size: 65%;
}

#ygnkjrteau .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#ygnkjrteau .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ygnkjrteau .gt_indent_1 {
  text-indent: 5px;
}

#ygnkjrteau .gt_indent_2 {
  text-indent: 10px;
}

#ygnkjrteau .gt_indent_3 {
  text-indent: 15px;
}

#ygnkjrteau .gt_indent_4 {
  text-indent: 20px;
}

#ygnkjrteau .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">age</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">hrs_wk</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col">method</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">R_AGE</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">10.115</td>
<td class="gt_row gt_right">4.971</td>
<td class="gt_row gt_center">phonics</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">14.272</td></tr>
    <tr><td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">9.940</td>
<td class="gt_row gt_right">4.677</td>
<td class="gt_row gt_center">phonics</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">13.692</td></tr>
    <tr><td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">6.060</td>
<td class="gt_row gt_right">4.619</td>
<td class="gt_row gt_center">phonics</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">10.353</td></tr>
    <tr><td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">7.941</td>
<td class="gt_row gt_right">4.053</td>
<td class="gt_row gt_center">word</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">6.988</td></tr>
    <tr><td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">8.233</td>
<td class="gt_row gt_right">5.474</td>
<td class="gt_row gt_center">word</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">8.713</td></tr>
    <tr><td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">6.219</td>
<td class="gt_row gt_right">4.038</td>
<td class="gt_row gt_center">word</td>
<td class="gt_row gt_right" style="background-color: rgba(208,217,255,0.8); color: #000000;">5.908</td></tr>
  </tbody>
  
  
</table>
</div>
]
.pull-right[
<div id="rgl24199" style="width:504px;height:504px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl24199">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":"","blend":["src_alpha","one_minus_src_alpha"]},"rootSubscene":7,"objects":{"13":{"id":13,"type":"spheres","material":{},"vertices":"0","colors":"1","radii":[[0.100000001490116]],"centers":"2","ignoreExtent":false,"fastTransparency":true,"flags":32771},"15":{"id":15,"type":"text","material":{"lit":false,"margin":0,"floating":true,"edge":[0,1,1]},"vertices":"3","colors":"4","texts":[["practise"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"5","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"16":{"id":16,"type":"text","material":{"lit":false,"margin":1,"floating":true,"edge":[1,1,1]},"vertices":"6","colors":"7","texts":[["age"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"8","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"17":{"id":17,"type":"text","material":{"lit":false,"margin":2,"floating":true,"edge":[1,1,1]},"vertices":"9","colors":"10","texts":[["READING AGE"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"11","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"11":{"id":11,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"10":{"id":10,"type":"background","material":{},"colors":"12","centers":"13","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"12":{"id":12,"type":"background","material":{"lit":false,"back":"lines"},"colors":"14","centers":"15","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"14":{"id":14,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":"16","colors":"17","axes":{"mode":["pretty","pretty","pretty"],"step":[1,1,2],"nticks":[5,5,5],"marklen":[15,15,15],"expand":[1.02999997138977,1.02999997138977,1.02999997138977]},"draw_front":true,"flags":32769},"7":{"id":7,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":7,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,34.9825973510742],"modelMatrix":[[2.18983316421509,0,0,-11.3699197769165],[0,0.469138711690903,0.625078618526459,-9.98047542572021],[0,-1.28894793987274,0.227510005235672,-26.8569793701172],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370396614075,-126.108238220215],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[2.18983316421509,1.37166976928711,0.665194749832153],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[3.30756092071533,7.0767183303833,5.04654455184937,11.0639009475708,3.71701788902283,16.1251525878906],"windowRect":[242,265,498,521],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"TT Arial","maxClipPlanes":8,"glVersion":4.6,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[12,14,13,15,16,17,11],"subscenes":[],"flags":34067}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":504,"height":504,"buffer":{"accessors":[{"bufferView":0,"componentType":5126,"count":50,"type":"VEC3"},{"bufferView":1,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":2,"componentType":5126,"count":50,"type":"VEC3"},{"bufferView":3,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":4,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":5,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":6,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":7,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":8,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":9,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":10,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":11,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":12,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":13,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":14,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":15,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":16,"componentType":5126,"count":17,"type":"VEC3"},{"bufferView":17,"componentType":5121,"count":1,"type":"VEC4"}],"bufferViews":[{"buffer":0,"byteLength":600,"byteOffset":0},{"buffer":0,"byteLength":4,"byteOffset":600},{"buffer":0,"byteLength":600,"byteOffset":604},{"buffer":0,"byteLength":12,"byteOffset":1204},{"buffer":0,"byteLength":4,"byteOffset":1216},{"buffer":0,"byteLength":12,"byteOffset":1220},{"buffer":0,"byteLength":12,"byteOffset":1232},{"buffer":0,"byteLength":4,"byteOffset":1244},{"buffer":0,"byteLength":12,"byteOffset":1248},{"buffer":0,"byteLength":12,"byteOffset":1260},{"buffer":0,"byteLength":4,"byteOffset":1272},{"buffer":0,"byteLength":12,"byteOffset":1276},{"buffer":0,"byteLength":16,"byteOffset":1288},{"buffer":0,"byteLength":3,"byteOffset":1304},{"buffer":0,"byteLength":4,"byteOffset":1307},{"buffer":0,"byteLength":3,"byteOffset":1311},{"buffer":0,"byteLength":204,"byteOffset":1316},{"buffer":0,"byteLength":4,"byteOffset":1520}],"buffers":[{"byteLength":1524,"bytes":"3Q6fQLXWIUHAWmRBMaiVQGwJH0FFEVtBlsuTQJDuwUDkpiVBwJecQPtNFEHK5UtBzRqhQCDb\nL0F1pHVBY0OdQODpDkGyU1NB6qmoQCeGIEErUGNBK4q4QM6rpECzMiRBzqCNQGyMFkGWJFFB\n3+DYQPM0+EBLRVtB9OKEQP+NC0EkI09B+j2kQKWHvkBi7TRB5WrHQBxJLkEwyXtBZWetQNId\nAUH3FUdB2yyLQIFCw0BVjBtB79/OQOfoHkHdmH9B8HSsQGutCEEUAFNB1tiUQD7s3UD3jzFB\nLJpjQCte0ECRghxBYv7gQFYoAUGJO2VBJ96kQPSICUFQ3UpBQ5tWQCslpEA2BwlBenvAQHA1\nFUHbJ2ZB7MlqQMcUrEDjVQhBABChQMGCykBkMSlBvOV+QHKgFUFawgpBoM24QNKU6UBRW79A\nGE2eQPuh6ECALttAXsWKQArnH0G3WCBB/bCSQMqhqUCpgndAoWiMQIOvDEHOhgRBOIyWQKGP\nIUGWnSFBeTbQQA+9FUFN0wNBXc+PQAYuHEG1HxBBlkulQOwDKkEOXxxBlSqRQHWJJUEB+QtB\nVF/WQDbV10CBdt9AMAmEQLuYIUFDrA9BGwKcQDvVAUEcQdVAZyCQQNcbx0ACXr1A6lloQLNC\nLEHfWwFB7NiXQKm0pECwIp1ASzCTQIXSo0BRuoxAFOuAQIsku0C0UqlACOuhQAp350Cwb9tA\nVbeoQNwd0UD8hrlAFN3bQPxnAkHDDwtBrrKBQIIZ/kBNod9AKyivQEa6A0FSaAtBaTaBQDH+\nxkBeDL1AAAAAAd0On0C11iFBwFpkQTGolUBsCR9BRRFbQZbLk0CQ7sFA5KYlQcCXnED7TRRB\nyuVLQc0aoUAg2y9BdaR1QWNDnUDg6Q5BslNTQeqpqEAnhiBBK1BjQSuKuEDOq6RAszIkQc6g\njUBsjBZBliRRQd/g2EDzNPhAS0VbQfTihED/jQtBJCNPQfo9pEClh75AYu00QeVqx0AcSS5B\nMMl7QWVnrUDSHQFB9xVHQdssi0CBQsNAVYwbQe/fzkDn6B5B3Zh/QfB0rEBrrQhBFABTQdbY\nlEA+7N1A948xQSyaY0ArXtBAkYIcQWL+4EBWKAFBiTtlQSfepED0iAlBUN1KQUObVkArJaRA\nNgcJQXp7wEBwNRVB2ydmQezJakDHFKxA41UIQQAQoUDBgspAZDEpQbzlfkByoBVBWsIKQaDN\nuEDSlOlAUVu/QBhNnkD7oehAgC7bQF7FikAK5x9Bt1ggQf2wkkDKoalAqYJ3QKFojECDrwxB\nzoYEQTiMlkChjyFBlp0hQXk20EAPvRVBTdMDQV3Pj0AGLhxBtR8QQZZLpUDsAypBDl8cQZUq\nkUB1iSVBAfkLQVRf1kA21ddAgXbfQDAJhEC7mCFBQ6wPQRsCnEA71QFBHEHVQGcgkEDXG8dA\nAl69QOpZaECzQixB31sBQezYl0CptKRAsCKdQEswk0CF0qNAUbqMQBTrgECLJLtAtFKpQAjr\noUAKd+dAsG/bQFW3qEDcHdFA/Ia5QBTd20D8ZwJBww8LQa6ygUCCGf5ATaHfQCsor0BGugNB\nUmgLQWk2gUAx/sZAXgy9QAAAwH8AAIBAAACAPwAAAAEAAMB/AACAQAAAgD8AAMB/AACAQAAA\ngD8AAAABAADAfwAAgEAAAIA/AADAfwAAgEAAAIA/AAAAAQAAwH8AAIBAAACAP5mYmD6ZmJg+\nmZiYPgAAgD8AAAABAQEBAAAAAAAAAIBAAADAfwAAwH8AAKBAAADAfwAAwH8AAMBAAADAfwAA\nwH8AAOBAAADAfwAAwH8AAMB/AADAQAAAwH8AAMB/AADgQAAAwH8AAMB/AAAAQQAAwH8AAMB/\nAAAQQQAAwH8AAMB/AAAgQQAAwH8AAMB/AAAwQQAAwH8AAMB/AADAfwAAgEAAAMB/AADAfwAA\nwEAAAMB/AADAfwAAAEEAAMB/AADAfwAAIEEAAMB/AADAfwAAQEEAAMB/AADAfwAAYEEAAMB/\nAADAfwAAgEEAAAAB"}]},"context":{"shiny":false,"rmarkdown":"xaringan::moon_reader"},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz/vNormal.w), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n    \n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i])\n        lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n#ifdef TEXTURE_rgb\n    vec4 textureColor = lighteffect*vec4(texture2D(uSampler, vTexcoord).rgb, 1.);\n#endif\n    \n#ifdef TEXTURE_rgba\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef TEXTURE_alpha\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n    float luminance = dot(vec3(1.,1.,1.), textureColor.rgb)/3.;\n    textureColor =  vec4(lighteffect.rgb, lighteffect.a*luminance);\n#endif\n    \n#ifdef TEXTURE_luminance\n    vec4 textureColor = vec4(lighteffect.rgb*dot(texture2D(uSampler, vTexcoord).rgb, vec3(1.,1.,1.))/3., lighteffect.a);\n#endif\n    \n#ifdef TEXTURE_luminance_alpha\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n    textureColor = vec4(lighteffect.rgb*luminance, lighteffect.a*textureColor.a);\n#endif\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
]

???
- **rotate cube leftward to show R_AGE~age**

---
# Another Model

.center[
![](lecture_8_files/figure-html/anmod-1.svg)&lt;!-- --&gt;

]

---
# Another Model


```r
mod2 &lt;- lm(R_AGE ~ age, data=reading)
summary(mod2)
```

```
## 
## Call:
## lm(formula = R_AGE ~ age, data = reading)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
*## -4.577 -2.509 -0.005  2.390  4.392 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
*## (Intercept)    1.764      1.753    1.01     0.32    
*## age            1.012      0.212    4.76 0.000018 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.7 on 48 degrees of freedom
*## Multiple R-squared:  0.321,	Adjusted R-squared:  0.307 
*## F-statistic: 22.7 on 1 and 48 DF,  p-value: 0.0000179
```

???
- point out that intercept is quite meaningless (reading age for age zero)

---
.center[
![](lecture_8_files/figure-html/diag2-1.svg)&lt;!-- --&gt;
]

---
# Two Models, No Answers

.pull-left[
- we now have two models that don't map well to assumptions

- each suggests an effect

  + one of `age`
  
  + one of `hrs_wk`
]
.pull-right[
- if we run them independently, the chances of a type 1 error are

  + `\(\frac{1}{20}\)` (`mod`, including `hrs_wk`)
  
  + `\(\frac{1}{20}\)` (`mod2`, including `age`)
  
- or ** `\(\frac{1}{10}\)` ** overall
]

--
.pt1[
&amp;nbsp;
]

.br3.pa2.bg-gray.white.tc[
we need to test multiple predictors in _one_ linear model
]

---
# Model Equations Again

`$$\color{red}{\textrm{outcome}_i}=\color{blue}{(\textrm{model})_i}+\textrm{error}_i$$`

`$$\color{red}{y_i}=\color{blue}{b_0\cdot{}1+b_1\cdot{}x_i}+\epsilon_i$$`
--

### linear model with two predictors

`$$\color{red}{y_i}=\color{blue}{b_0\cdot{}1+b_1\cdot{}x_{1i}+b_2\cdot{}x_{2i}}+\epsilon_i$$`
`$$\color{red}{\hat{y}_i}=\color{blue}{b_0\cdot{}1+b_1\cdot{}x_{1i}+b_2\cdot{}x_{2i}}$$`

--
.center[
`y ~ 1 + x1 + x2`

`R_AGE ~ 1 + hrs_wk + age` &amp;nbsp;&amp;nbsp; or &amp;nbsp;&amp;nbsp; `R_AGE ~ hrs_wk + age`&lt;sup&gt;1&lt;/sup&gt;
]


.footnote[
&lt;sup&gt;1&lt;/sup&gt; we'll come back to why order can matter in a bit
]

---
# Running a Multiple Regression


```r
mod.m &lt;- lm(R_AGE ~ age + hrs_wk, data=reading)
summary(mod.m)
```

```
## 
## Call:
## lm(formula = R_AGE ~ age + hrs_wk, data = reading)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -4.385 -2.251  0.326  2.395  3.201 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
*## (Intercept)   -2.423      2.472   -0.98    0.332    
*## age            0.938      0.206    4.55 0.000038 ***
*## hrs_wk         0.964      0.418    2.31    0.025 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.59 on 47 degrees of freedom
## Multiple R-squared:  0.39,	Adjusted R-squared:  0.364 
## F-statistic:   15 on 2 and 47 DF,  p-value: 0.00000896
```

---
# Running a Multiple Regression


```
## ...
## (Intercept)   -2.423      2.472   -0.98    0.332    
## age            0.938      0.206    4.55 0.000038 ***
## hrs_wk         0.964      0.418    2.31    0.025 *  
## ...
```

- there are _independent_ effects of age and practice

  + reading age improves by 0.9378 for each year of age

  + reading age improves by 0.9636 for each weekly hour of practice

- note that the _intercept_ (0 years old, 0 hours/week) is meaningless here

--

- important question:  is this model _better_ than a model based just on age?

---
# Model Fit: `\(R^2\)`


```
## ...
## Residual standard error: 2.59 on 47 degrees of freedom
*## Multiple R-squared:  0.39,	Adjusted R-squared:  0.364 
## F-statistic:   15 on 2 and 47 DF,  p-value: 0.00000896
```

- in multiple regression, `\(R^2\)` measures the fit of the entire model
  + sum of individual `\(R^2\)`s _if predictors not correlated_

- `\(R^2=0.3902\)` looks better than the `\(R^2\)` for `mod2` (`age` as a predictor) of `\(0.3211\)`

- but _any_ predictor will improve `\(R^2\)` (chance associations guarantee this)


```r
mod2 &lt;- lm(R_AGE ~ age, data=reading)
mod.2r &lt;- update(mod2, ~ . + runif(50))
summary(mod.2r)
```

```
## ...
## Multiple R-squared:  0.361,	Adjusted R-squared:  0.334 
## ...
```
???

- Adjusted `\(R^2\)` accounts for multiple predictors

- for `mod2`, it's 0.3069

- for `mod.2r`, it's 0.3339

---
# Model Fit: F


```
## ...
## Residual standard error: 2.59 on 47 degrees of freedom
## Multiple R-squared:  0.39,	Adjusted R-squared:  0.364 
*## F-statistic:   15 on 2 and 47 DF,  p-value: 0.00000896
```

- in multiple regression, `\(F\)` tests the whether the model overall explains more variance than we would expect by chance.  
- can be phrased as a model comparison: 


```r
null_mod &lt;- lm(R_AGE ~ 1, data = reading)
mod.m &lt;- lm(R_AGE ~ age + hrs_wk, data=reading)
anova(null_mod, mod.m)
```

```
## Analysis of Variance Table
## 
## Model 1: R_AGE ~ 1
## Model 2: R_AGE ~ age + hrs_wk
##   Res.Df RSS Df Sum of Sq  F Pr(&gt;F)    
## 1     49 517                           
*## 2     47 315  2       202 15  9e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

???

---
# Comparing Models

- We can also use `\(F\)` ratios to compare models in terms of variance explained by each model:  

  - Models must be "nested" - predictors of one model are a subset of predictors in the other.  
  
  - Models must be fitted to the same data.  


```r
mod.r &lt;- lm(R_AGE ~ age, data=reading)
mod.f &lt;- lm(R_AGE ~ age + hrs_wk, data=reading)
anova(mod.r, mod.f)
```

```
## Analysis of Variance Table
## 
## Model 1: R_AGE ~ age
## Model 2: R_AGE ~ age + hrs_wk
##   Res.Df RSS Df Sum of Sq    F Pr(&gt;F)  
## 1     48 351                           
## 2     47 315  1      35.7 5.33  0.025 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---
# Partitioning Variance

- Take one model, and examine variance explained by each predictor:  


```r
mod.f &lt;- lm(R_AGE ~ age + hrs_wk, data=reading)
anova(mod.m)
```

```
## Analysis of Variance Table
## 
## Response: R_AGE
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## age        1  166.0   166.0   24.75 0.0000092 ***
## hrs_wk     1   35.7    35.7    5.33     0.025 *  
## Residuals 47  315.3     6.7                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---
# Order Matters!

- `age` then `hrs_wk`

```
## Analysis of Variance Table
## ...
## Response: R_AGE
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## age        1  166.0   166.0   24.75 0.0000092 ***
## hrs_wk     1   35.7    35.7    5.33     0.025 *  
## Residuals 47  315.3     6.7                      
## ---
```
- `hrs_wk` then `age`

```
## Analysis of Variance Table
## ...
## Response: R_AGE
##           Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## hrs_wk     1   62.7    62.7    9.35   0.0037 ** 
## age        1  139.0   139.0   20.72 0.000038 ***
## Residuals 47  315.3     6.7                     
## ---
```

???
map to series of model comparisons

---
# Type 1 vs. Type 3 SS

- order matters because R, by default, uses **Type 1** sums of squares for `anova()`
  + calculate each predictor's improvement to the model _in turn_
  
- compare to **Type 3** sums of squares
  + calculate each predictor's improvement to the model _taking all other predictors into account_
  
- huge debate about which is "better" (nobody likes Type 2)

- if using Type 1, _predictors should be entered into the model in a theoretically-motivated order_

---
# Type 1 vs. Type 3 SS
.pull-left[
### type 1
.center[
![:scale 70%](lecture_8_files/t13/jk/type0-0.svg)
]]
.pull-right[
### type 3
.center[
![:scale 70%](lecture_8_files/t13/jk/type0-0.svg)
]]

---

count: false
# Type 1 vs. Type 3 SS
.pull-left[
### type 1
.center[
![:scale 70%](lecture_8_files/t13/jk/type1-1.svg)
]]
.pull-right[
### type 3
.center[
![:scale 70%](lecture_8_files/t13/jk/type0-0.svg)
]]

---
count: false
# Type 1 vs. Type 3 SS
.pull-left[
### type 1
.center[
![:scale 70%](lecture_8_files/t13/jk/type1-2.svg)
]]
.pull-right[
### type 3
.center[
![:scale 70%](lecture_8_files/t13/jk/type0-0.svg)
]]

---
count: false
# Type 1 vs. Type 3 SS
.pull-left[
### type 1
.center[
![:scale 70%](lecture_8_files/t13/jk/type1-3.svg)
]]
.pull-right[
### type 3
.center[
![:scale 70%](lecture_8_files/t13/jk/type0-0.svg)
]]

---

count: false
# Type 1 vs. Type 3 SS
.pull-left[
### type 1
.center[
![:scale 70%](lecture_8_files/t13/jk/type1-3.svg)
]]
.pull-right[
### type 3
.center[
![:scale 70%](lecture_8_files/t13/jk/type3-1.svg)
]]

---
count: false
# Type 1 vs. Type 3 SS
.pull-left[
### type 1
.center[
![:scale 70%](lecture_8_files/t13/jk/type1-3.svg)
]]
.pull-right[
### type 3
.center[
![:scale 70%](lecture_8_files/t13/jk/type3-2.svg)
]]

---
count: false
# Type 1 vs. Type 3 SS
.pull-left[
### type 1
.center[
![:scale 70%](lecture_8_files/t13/jk/type1-3.svg)
]]
.pull-right[
### type 3
.center[
![:scale 70%](lecture_8_files/t13/jk/type3-3.svg)
]]

---

# Type 1 vs. Type 3 SS

.pull-left[
__Type 1 - "Incremental" (Order Matters)__  

```r
# age then hrs_wk:   `
anova(lm(R_AGE~age+hrs_wk,data=reading))
```

```
## Analysis of Variance Table
## 
## Response: R_AGE
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## age        1  166.0   166.0   24.75 0.0000092 ***
## hrs_wk     1   35.7    35.7    5.33     0.025 *  
## Residuals 47  315.3     6.7                      
## ---
```

```r
# hrs_wk then age: 
anova(lm(R_AGE~hrs_wk+age,data=reading))
```

```
## Analysis of Variance Table
## 
## Response: R_AGE
##           Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## hrs_wk     1   62.7    62.7    9.35   0.0037 ** 
## age        1  139.0   139.0   20.72 0.000038 ***
## Residuals 47  315.3     6.7                     
## ---
```
]
.pull-right[
__Type 3 - "Last one in"__  

```r
mod.m &lt;- lm(R_AGE~hrs_wk+age,data=reading)
drop1(mod.m, test="F")
```


```
## Single term deletions
## 
## Model:
## R_AGE ~ hrs_wk + age
##        Df Sum of Sq RSS   AIC F value   Pr(&gt;F)    
## &lt;none&gt;              315  98.1                     
## hrs_wk  1      35.7 351 101.4    5.33    0.025 *  
## age     1     139.0 454 114.3   20.72 0.000038 ***
## ---
```
]

---
# So far.. 

What can we do with multiple regressions?

- Examine proportion of variance explained - `\(R^2\)`  

- Test whether the model improves over chance - `\(F\)` test at the bottom of `summary(model)`  

- Conduct comparisons between _nested_ models
    - e.g. `lm(y ~ x1)` vs `lm(y ~ x1 + x2 + x3 + x4)`  
    - using `anova(model1, model2)` 

- Test the variance explained by each predictor in the model, either... 
    - incrementally (in the order inputted into the model)  
      `anova(model)`
    - after accounting for all other predictors  
      `drop1(model, test = "F")`

---
# Two Subtly Different Questions

.pull-left[

&gt; After accounting for `age`, *does* `hrs_wk` influence `R_AGE`? 


```r
mod.m &lt;- lm(R_AGE~ age + hrs_wk, data=reading)
anova(mod.m)
```

```
## Analysis of Variance Table
## 
## Response: R_AGE
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## age        1  166.0   166.0   24.75 0.0000092 ***
## hrs_wk     1   35.7    35.7    5.33     0.025 *  
## Residuals 47  315.3     6.7                      
## ---
```

]
.pull-right[

&gt; After accounting for `age`, *__how__ does* `hrs_wk` influence `R_AGE`? 


```r
mod.m &lt;- lm(R_AGE~ age + hrs_wk, data=reading)
summary(mod.m)
```

```
## ...
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -2.423      2.472   -0.98    0.332    
## age            0.938      0.206    4.55 0.000038 ***
## hrs_wk         0.964      0.418    2.31    0.025 *  
## ---
## ...
```

]

---
# The Two-Predictor Model


```r
mod.m &lt;- lm(R_AGE ~ age + hrs_wk, data=reading)
summary(mod.m)
```

```
## 
## Call:
## lm(formula = R_AGE ~ age + hrs_wk, data = reading)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -4.385 -2.251  0.326  2.395  3.201 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
*## (Intercept)   -2.423      2.472   -0.98    0.332    
*## age            0.938      0.206    4.55 0.000038 ***
*## hrs_wk         0.964      0.418    2.31    0.025 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.59 on 47 degrees of freedom
## Multiple R-squared:  0.39,	Adjusted R-squared:  0.364 
## F-statistic:   15 on 2 and 47 DF,  p-value: 0.00000896
```

---

# The Two-Predictor Model

.flex.items-center[
.w-25[
&amp;nbsp;
]
.w-50[
<div id="rgl93840" style="width:504px;height:504px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl93840">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":"","blend":["src_alpha","one_minus_src_alpha"]},"rootSubscene":7,"objects":{"24":{"id":24,"type":"spheres","material":{},"vertices":"0","colors":"1","radii":[[0.100000001490116]],"centers":"2","ignoreExtent":false,"fastTransparency":true,"flags":32771},"26":{"id":26,"type":"text","material":{"lit":false,"margin":0,"floating":true,"edge":[0,1,1]},"vertices":"3","colors":"4","texts":[["practise"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"5","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"27":{"id":27,"type":"text","material":{"lit":false,"margin":1,"floating":true,"edge":[1,1,1]},"vertices":"6","colors":"7","texts":[["age"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"8","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"28":{"id":28,"type":"text","material":{"lit":false,"margin":2,"floating":true,"edge":[1,1,1]},"vertices":"9","colors":"10","texts":[["READING AGE"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"11","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"29":{"id":29,"type":"planes","material":{"alpha":0.498039215803146,"isTransparent":true},"vertices":"12","colors":"14","offsets":[[-2.42299914360046]],"centers":"15","normals":"13","ignoreExtent":true,"flags":32803},"11":{"id":11,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"12":{"id":12,"type":"background","material":{"lit":false,"back":"lines"},"colors":"16","centers":"17","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"25":{"id":25,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":"18","colors":"19","axes":{"mode":["pretty","pretty","pretty"],"step":[1,1,2],"nticks":[5,5,5],"marklen":[15,15,15],"expand":[1.02999997138977,1.02999997138977,1.02999997138977]},"draw_front":true,"flags":32769},"7":{"id":7,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":7,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,34.9825973510742],"modelMatrix":[[2.18983316421509,0,0,-11.3699197769165],[0,0.469138711690903,0.625078618526459,-9.98047542572021],[0,-1.28894793987274,0.227510005235672,-26.8569793701172],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370396614075,-126.108238220215],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[2.18983316421509,1.37166976928711,0.665194749832153],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[3.30756092071533,7.0767183303833,5.04654455184937,11.0639009475708,3.71701788902283,16.1251525878906],"windowRect":[242,265,498,521],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"TT Arial","maxClipPlanes":8,"glVersion":4.6,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[12,25,24,26,27,28,29,11],"subscenes":[],"flags":34099}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":504,"height":504,"buffer":{"accessors":[{"bufferView":0,"componentType":5126,"count":50,"type":"VEC3"},{"bufferView":1,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":2,"componentType":5126,"count":50,"type":"VEC3"},{"bufferView":3,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":4,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":5,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":6,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":7,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":8,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":9,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":10,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":11,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":12,"componentType":5126,"count":3,"type":"VEC3"},{"bufferView":13,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":14,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":15,"componentType":5126,"count":4,"type":"VEC3"},{"bufferView":16,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":17,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":18,"componentType":5126,"count":17,"type":"VEC3"},{"bufferView":19,"componentType":5121,"count":1,"type":"VEC4"}],"bufferViews":[{"buffer":0,"byteLength":600,"byteOffset":0},{"buffer":0,"byteLength":4,"byteOffset":600},{"buffer":0,"byteLength":600,"byteOffset":604},{"buffer":0,"byteLength":12,"byteOffset":1204},{"buffer":0,"byteLength":4,"byteOffset":1216},{"buffer":0,"byteLength":12,"byteOffset":1220},{"buffer":0,"byteLength":12,"byteOffset":1232},{"buffer":0,"byteLength":4,"byteOffset":1244},{"buffer":0,"byteLength":12,"byteOffset":1248},{"buffer":0,"byteLength":12,"byteOffset":1260},{"buffer":0,"byteLength":4,"byteOffset":1272},{"buffer":0,"byteLength":12,"byteOffset":1276},{"buffer":0,"byteLength":36,"byteOffset":1288},{"buffer":0,"byteLength":12,"byteOffset":1324},{"buffer":0,"byteLength":16,"byteOffset":1336},{"buffer":0,"byteLength":48,"byteOffset":1352},{"buffer":0,"byteLength":4,"byteOffset":1400},{"buffer":0,"byteLength":3,"byteOffset":1404},{"buffer":0,"byteLength":204,"byteOffset":1408},{"buffer":0,"byteLength":4,"byteOffset":1612}],"buffers":[{"byteLength":1616,"bytes":"3Q6fQLXWIUHAWmRBMaiVQGwJH0FFEVtBlsuTQJDuwUDkpiVBwJecQPtNFEHK5UtBzRqhQCDb\nL0F1pHVBY0OdQODpDkGyU1NB6qmoQCeGIEErUGNBK4q4QM6rpECzMiRBzqCNQGyMFkGWJFFB\n3+DYQPM0+EBLRVtB9OKEQP+NC0EkI09B+j2kQKWHvkBi7TRB5WrHQBxJLkEwyXtBZWetQNId\nAUH3FUdB2yyLQIFCw0BVjBtB79/OQOfoHkHdmH9B8HSsQGutCEEUAFNB1tiUQD7s3UD3jzFB\nLJpjQCte0ECRghxBYv7gQFYoAUGJO2VBJ96kQPSICUFQ3UpBQ5tWQCslpEA2BwlBenvAQHA1\nFUHbJ2ZB7MlqQMcUrEDjVQhBABChQMGCykBkMSlBvOV+QHKgFUFawgpBoM24QNKU6UBRW79A\nGE2eQPuh6ECALttAXsWKQArnH0G3WCBB/bCSQMqhqUCpgndAoWiMQIOvDEHOhgRBOIyWQKGP\nIUGWnSFBeTbQQA+9FUFN0wNBXc+PQAYuHEG1HxBBlkulQOwDKkEOXxxBlSqRQHWJJUEB+QtB\nVF/WQDbV10CBdt9AMAmEQLuYIUFDrA9BGwKcQDvVAUEcQdVAZyCQQNcbx0ACXr1A6lloQLNC\nLEHfWwFB7NiXQKm0pECwIp1ASzCTQIXSo0BRuoxAFOuAQIsku0C0UqlACOuhQAp350Cwb9tA\nVbeoQNwd0UD8hrlAFN3bQPxnAkHDDwtBrrKBQIIZ/kBNod9AKyivQEa6A0FSaAtBaTaBQDH+\nxkBeDL1AAAAAAd0On0C11iFBwFpkQTGolUBsCR9BRRFbQZbLk0CQ7sFA5KYlQcCXnED7TRRB\nyuVLQc0aoUAg2y9BdaR1QWNDnUDg6Q5BslNTQeqpqEAnhiBBK1BjQSuKuEDOq6RAszIkQc6g\njUBsjBZBliRRQd/g2EDzNPhAS0VbQfTihED/jQtBJCNPQfo9pEClh75AYu00QeVqx0AcSS5B\nMMl7QWVnrUDSHQFB9xVHQdssi0CBQsNAVYwbQe/fzkDn6B5B3Zh/QfB0rEBrrQhBFABTQdbY\nlEA+7N1A948xQSyaY0ArXtBAkYIcQWL+4EBWKAFBiTtlQSfepED0iAlBUN1KQUObVkArJaRA\nNgcJQXp7wEBwNRVB2ydmQezJakDHFKxA41UIQQAQoUDBgspAZDEpQbzlfkByoBVBWsIKQaDN\nuEDSlOlAUVu/QBhNnkD7oehAgC7bQF7FikAK5x9Bt1ggQf2wkkDKoalAqYJ3QKFojECDrwxB\nzoYEQTiMlkChjyFBlp0hQXk20EAPvRVBTdMDQV3Pj0AGLhxBtR8QQZZLpUDsAypBDl8cQZUq\nkUB1iSVBAfkLQVRf1kA21ddAgXbfQDAJhEC7mCFBQ6wPQRsCnEA71QFBHEHVQGcgkEDXG8dA\nAl69QOpZaECzQixB31sBQezYl0CptKRAsCKdQEswk0CF0qNAUbqMQBTrgECLJLtAtFKpQAjr\noUAKd+dAsG/bQFW3qEDcHdFA/Ia5QBTd20D8ZwJBww8LQa6ygUCCGf5ATaHfQCsor0BGugNB\nUmgLQWk2gUAx/sZAXgy9QAAAwH8AAIBAAACAPwAAAAEAAMB/AACAQAAAgD8AAMB/AACAQAAA\ngD8AAAABAADAfwAAgEAAAIA/AADAfwAAgEAAAIA/AAAAAQAAwH8AAIBAAACAPxSvU0BLfaFA\nHOivQBSvU0C9BTFBtz4yQXp04kC9BTFB4ltsQUuxdj9NFXA/AACAvwAAAAAAAAAAAAAAAP/+\n/j7aC5JAC+4QQeKEJ0ErQLpAsKzhQA7LHEEAAMB/AADAfwAAwH8AAMB/AADAfwAAwH8BAQEB\nAAAAAAAAgEAAAMB/AADAfwAAoEAAAMB/AADAfwAAwEAAAMB/AADAfwAA4EAAAMB/AADAfwAA\nwH8AAMBAAADAfwAAwH8AAOBAAADAfwAAwH8AAABBAADAfwAAwH8AABBBAADAfwAAwH8AACBB\nAADAfwAAwH8AADBBAADAfwAAwH8AAMB/AACAQAAAwH8AAMB/AADAQAAAwH8AAMB/AAAAQQAA\nwH8AAMB/AAAgQQAAwH8AAMB/AABAQQAAwH8AAMB/AABgQQAAwH8AAMB/AACAQQAAAAE="}]},"context":{"shiny":false,"rmarkdown":"xaringan::moon_reader"},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz/vNormal.w), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n    \n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i])\n        lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n#ifdef TEXTURE_rgb\n    vec4 textureColor = lighteffect*vec4(texture2D(uSampler, vTexcoord).rgb, 1.);\n#endif\n    \n#ifdef TEXTURE_rgba\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef TEXTURE_alpha\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n    float luminance = dot(vec3(1.,1.,1.), textureColor.rgb)/3.;\n    textureColor =  vec4(lighteffect.rgb, lighteffect.a*luminance);\n#endif\n    \n#ifdef TEXTURE_luminance\n    vec4 textureColor = vec4(lighteffect.rgb*dot(texture2D(uSampler, vTexcoord).rgb, vec3(1.,1.,1.))/3., lighteffect.a);\n#endif\n    \n#ifdef TEXTURE_luminance_alpha\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n    textureColor = vec4(lighteffect.rgb*luminance, lighteffect.a*textureColor.a);\n#endif\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
]
.w-25[
&amp;nbsp;
]]

---
class: inverse, center, middle, animated, flip

# End

---
# Acknowledgements


- icons by Diego Lavecchia from the [Noun Project](https://thenounproject.com/)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="mc_libs/macros.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
