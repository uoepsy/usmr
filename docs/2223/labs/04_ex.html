<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>USMR - Week 4 Exercises: Chi-Square Tests</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-hand-o-right')) {
    f.classList.add('fa-hand-o-down')
    f.classList.remove('fa-hand-o-right')
} else {
    f.classList.add('fa-hand-o-right')
    f.classList.remove('fa-hand-o-down')
}
}
</script>

<script src="https://kit.fontawesome.com/120b08a6f5.js" crossorigin="anonymous"></script>

<link href="site_libs/panelset-0.2.6/panelset.css" rel="stylesheet">
<script src="site_libs/panelset-0.2.6/panelset.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">USMR</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-1" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 1</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-1">    
        <li>
    <a class="dropdown-item" href="./01a_R.html">
 <span class="dropdown-text">1A: First look at R/RStudio</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./01b_data.html">
 <span class="dropdown-text">1B: More R: Basic Data Skills</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./01_ex.html">
 <span class="dropdown-text">Exercises: Intro R</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-2" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 2</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-2">    
        <li class="dropdown-header">2A: Measurements &amp; Distributions</li>
        <li class="dropdown-header">2B: Sampling &amp; Curves</li>
        <li class="dropdown-header">Exercises: More R; Estimates &amp; Intervals</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-3" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 3</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-3">    
        <li class="dropdown-header">3A: Foundations of Inference</li>
        <li class="dropdown-header">3B: Practical Inference</li>
        <li class="dropdown-header">Exercises: T-tests</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-4" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 4</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-4">    
        <li class="dropdown-header">4A: Chi-Square Tests</li>
        <li class="dropdown-header">4B: Revisiting NHST</li>
        <li class="dropdown-header">Exercises: Chi-Square Tests</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-5" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 5</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-5">    
        <li class="dropdown-header">5A: Covariance &amp; Correlation</li>
        <li class="dropdown-header">Exercises: Cov, Cor, Models</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-6" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 6</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-6">    
        <li class="dropdown-header">Walkthrough: Advanced Data Wrangling</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-7" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 7</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-7">    
        <li class="dropdown-header">7A: Simple Linear Regression</li>
        <li class="dropdown-header">Exercises: Simple Linear Regression</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-8" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 8</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-8">    
        <li class="dropdown-header">8A: Multiple Linear Regression</li>
        <li class="dropdown-header">8B: Assumptions, Diagnostics, and Troubleshooting</li>
        <li class="dropdown-header">Exercises: Multiple Linear Regression</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-9" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 9</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-9">    
        <li class="dropdown-header">9A: Interactions</li>
        <li class="dropdown-header">9B: Categorical Predictors</li>
        <li class="dropdown-header">Exercises: Interactions</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-10" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 10</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-10">    
        <li class="dropdown-header">10A: GLM!</li>
        <li class="dropdown-header">Exercises: Logistic Regression</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-11" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 11</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-11">    
        <li class="dropdown-header">11A: Common Tests as Linear Models</li>
        <li class="dropdown-header">11B: Writing Up</li>
    </ul>
  </li>
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#birth-months" id="toc-birth-months" class="nav-link active" data-scroll-target="#birth-months">Birth-Months</a></li>
  <li><a href="#eye-colours" id="toc-eye-colours" class="nav-link" data-scroll-target="#eye-colours">Eye-Colours</a></li>
  <li><a href="#jokes-and-tips" id="toc-jokes-and-tips" class="nav-link" data-scroll-target="#jokes-and-tips">Jokes and Tips</a></li>
  <li><a href="#some-rmarkdown" id="toc-some-rmarkdown" class="nav-link" data-scroll-target="#some-rmarkdown">Some RMarkdown</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 4 Exercises: Chi-Square Tests</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="birth-months" class="level1">
<h1>Birth-Months</h1>
<div class="frame">
<blockquote class="blockquote">
<p><strong>Research Question:</strong> Are people more likely to be born in certain months than others?</p>
</blockquote>
<p>As you may remember, in the survey we asked students to complete in welcome week, one of the questions concerned the month in which you were born. You can download the data from <a href="https://uoepsy.github.io/data/surveydata_allcourse22.csv">https://uoepsy.github.io/data/surveydata_allcourse22.csv</a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>survey_data <span class="ot">&lt;-</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/surveydata_allcourse22.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="question-begin">
Question 1
</div>
<div class="question-body">
<p>What is your intuition about the distribution of all students’ birth-months?<br>
Do you think they will be spread uniformly across all months of the year (like a fair 12-sided dice), or do you think people are more likely to be born in certain months more than others?</p>
<p>Plot the distribution and get an initial idea of how things are looking.</p>
<div class="hints">
<p><strong>Hint:</strong><br>
You can do this quickly with <code>barplot()</code> and <code>table()</code>, or you could create try using <code>ggplot()</code> and looking into <code>geom_bar()</code>.</p>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-1" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-1', 'sol-start-1')"> Solution </span>
</div>
<div id="sol-body-1" class="solution-body" style="display: none;">
<p>The quick and dirty way to plot:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(survey_data<span class="sc">$</span>birthmonth))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_ex_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>A ggplot option:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> survey_data, <span class="fu">aes</span>(<span class="at">x =</span> birthmonth)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"- Birth Month -"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_ex_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 2
</div>
<div class="question-body">
<p>We’re going to perform a statistical test to assess the extent to which our data conforms to the hypothesis that people are no more likely to be born on one month than another.</p>
<p>Under this hypothesis, what would be the proportional breakdown of observed births in each of the months?</p>
</div>
<p class="question-end">
</p>
<div style="display:none;">
<p>If people are no more likely to be born in one month than another, then we would expect the same proportion of observed births in each month.<br>
There are 12 months, so we would expect <span class="math inline">\(\frac{1}{12}\)</span> observations in each month.</p>
<p>We can write these as:</p>
<p><span class="math display">\[
\begin{align}
&amp; p_{jan} = 1/12 \\
&amp; p_{feb} = 1/12 \\
&amp; ... \\
&amp; p_{dec} = 1/12 \\
\end{align}
\]</span></p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 3
</div>
<div class="question-body">
<p>We can find out how many people have valid entries (i.e.&nbsp;not <code>NA</code>) in the birth-month variable:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(survey_data<span class="sc">$</span>birthmonth))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 405</code></pre>
</div>
</div>
<p>Given this information, how many observations would we <em>expect</em> to find with a birthday in January? And in February? … and so on?</p>
</div>
<p class="question-end">
</p>
<div style="display:none;">
<p>We would expect <span class="math inline">\(\frac{1}{12} \times\)</span> 405 = 33.75 observations in each month.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 4
</div>
<div class="question-body">
<p>The code below creates counts for each month. Before doing that, it removes the rows which have an NA in them for birthmonth:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>survey_data <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(birthmonth)) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(birthmonth) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">observed =</span> <span class="fu">n</span>()</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(A shortcut for this would be <code>survey_data %&gt;% filter(!is.na(birthmonth)) %&gt;% count(birthmonth)</code>)</p>
<p>Add to the code above to create columns showing:</p>
<ul>
<li>the expected counts <span class="math inline">\(E_i\)</span></li>
<li>observed-expected (<span class="math inline">\(O_i - E_i\)</span>)</li>
<li>the squared differences <span class="math inline">\((O_i - E_i)^2\)</span></li>
<li>the standardised square differences <span class="math inline">\(\frac{(O_i - E_i)^2}{E_i}\)</span></li>
</ul>
<p>Then calculate the <span class="math inline">\(\chi^2\)</span> statistic (the sum of the standardised squared differences).<br>
If your observed counts matched the expected counts <em>perfectly</em>, what would the <span class="math inline">\(\chi^2\)</span> statistic be?</p>
<div class="hints">
<p><strong>Hint:</strong> This was all done in the manual example of a <span class="math inline">\(\chi^2\)</span> test in <a href="04a_chisq.html#chi2-goodness-of-fit-test" target="_blank">4A #chi2-goodness-of-fit-test</a></p>
</div>
</div>
<p class="question-end">
</p>
<div style="display:none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>chi_table <span class="ot">&lt;-</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    survey_data <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(birthmonth)) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(birthmonth) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">observed =</span> <span class="fu">n</span>(),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">expected =</span> <span class="dv">391</span><span class="sc">/</span><span class="dv">12</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">diff =</span> observed<span class="sc">-</span>expected,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">sq_diff =</span> diff<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">std_sq_diff =</span> sq_diff <span class="sc">/</span> expected</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>chi_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 6
   birthmonth observed expected   diff sq_diff std_sq_diff
   &lt;chr&gt;         &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;
 1 apr              24     32.6 -8.58   73.7        2.26  
 2 aug              34     32.6  1.42    2.01       0.0616
 3 dec              32     32.6 -0.583   0.340      0.0104
 4 feb              30     32.6 -2.58    6.67       0.205 
 5 jan              36     32.6  3.42   11.7        0.358 
 6 jul              40     32.6  7.42   55.0        1.69  
 7 jun              32     32.6 -0.583   0.340      0.0104
 8 mar              31     32.6 -1.58    2.51       0.0769
 9 may              34     32.6  1.42    2.01       0.0616
10 nov              38     32.6  5.42   29.3        0.900 
11 oct              38     32.6  5.42   29.3        0.900 
12 sep              36     32.6  3.42   11.7        0.358 </code></pre>
</div>
</div>
<p>And we can calculate our <span class="math inline">\(\chi^2\)</span> test statistic by simply summing the values in the last column we created:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(chi_table<span class="sc">$</span>std_sq_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.892583</code></pre>
</div>
</div>
<p>If all our observed counts are equal to our expected counts, then the <code>diff</code> column above will be all <span class="math inline">\(0\)</span>, and <span class="math inline">\(0^2=0\)</span>, and <span class="math inline">\(\frac{0}{E_i}\)</span> will be <span class="math inline">\(0\)</span>. So <span class="math inline">\(\chi^2\)</span> will be <span class="math inline">\(0\)</span>.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 5
</div>
<div class="question-body">
<p>You can see the distribution of <span class="math inline">\(\chi^2\)</span> statistics with different degrees of freedom below.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-chidist" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Chi-square_pdf.svg/1200px-Chi-square_pdf.svg.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure 1: Chi-Square Distributions</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We can find out the proportion of the distribution which falls to either side of a given value of <span class="math inline">\(\chi^2\)</span> using <code>pchisq()</code>. We need to give it our calculated <span class="math inline">\(\chi^2\)</span> statistic, our degrees of freedom (<code>df</code>), which is equal to the number of categories minus 1. We also need to specify whether we want the proportion to the left (<code>lower.tail=TRUE</code>) or to the right (<code>lower.tail=FALSE</code>).</p>
<ol type="1">
<li>Using <code>pchisq()</code>, calculate the probability of observing a <span class="math inline">\(\chi^2\)</span> statistic as least as extreme as the one we have calculated.<br>
</li>
<li>Check that these results match with those provided by R’s built-in function: <code>chisq.test(table(survey_data$birthmonth))</code> (the <code>table</code> function will ignore NAs by default, so we don’t need to do anything extra for this).</li>
</ol>
</div>
<p class="question-end">
</p>
<div style="display:none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(chi_table<span class="sc">$</span>std_sq_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.892583</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="fu">sum</span>(chi_table<span class="sc">$</span>std_sq_diff), <span class="at">df =</span> <span class="dv">11</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8077144</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(survey_data<span class="sc">$</span>birthmonth))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  table(survey_data$birthmonth)
X-squared = 6.1704, df = 11, p-value = 0.8618</code></pre>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 6
</div>
<div class="question-body">
<p>Which months of year had the highest contributions to the chi-square test statistic?</p>
<div class="hints">
<p><strong>Hint:</strong> Think about your standardised squared deviations.</p>
</div>
</div>
<p class="question-end">
</p>
<div style="display:none;">
<p><strong>Standardized squared deviations</strong></p>
<p>One possible way to answer this question is to look at the individual contribution of each category to the <span class="math inline">\(\chi^2\)</span> statistic. We computed these values in an earlier question.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>chi_table <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(birthmonth, std_sq_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
   birthmonth std_sq_diff
   &lt;chr&gt;            &lt;dbl&gt;
 1 apr             2.26  
 2 aug             0.0616
 3 dec             0.0104
 4 feb             0.205 
 5 jan             0.358 
 6 jul             1.69  
 7 jun             0.0104
 8 mar             0.0769
 9 may             0.0616
10 nov             0.900 
11 oct             0.900 
12 sep             0.358 </code></pre>
</div>
</div>
<p>From the barplot we created earlier on, we can see which months make up higher/lower proportions than expected:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(chi_table, <span class="fu">aes</span>(<span class="at">x =</span> birthmonth, <span class="at">y =</span> observed<span class="sc">/</span><span class="fu">nrow</span>(survey_data))) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">'lightblue'</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">color =</span> <span class="st">'red'</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_ex_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Pearson residuals</strong></p>
<p>Equivalently, you could answer by looking at Pearson residuals:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(survey_data<span class="sc">$</span>birthmonth))<span class="sc">$</span>residuals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        apr         aug         dec         feb         jan         jul 
-1.67829278  0.04303315 -0.30123204 -0.64549722  0.38729833  1.07582871 
        jun         mar         may         nov         oct         sep 
-0.30123204 -0.47336463  0.04303315  0.73156352  0.73156352  0.38729833 </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">

</div>
<p>The greatest <em>absolute</em> values are for apr and jul, showing that for these months the deviations from expected to observed were the greatest.</p>
</div>
<p class="solution-end">
</p>
</section>
<section id="eye-colours" class="level1">
<h1>Eye-Colours</h1>
<div class="frame">
<blockquote class="blockquote">
<p><strong>Research Question:</strong> Do the proportions of people with different eye-colours correspond to those suggested by the internet?</p>
</blockquote>
<p>According one part of the internet (that reliable source of information!), 76% of people in the world have brown eyes, 10% have blue, 5% hazel, 5% amber, 2% green, 1% grey, and 1% have some other eye colouring (red/violet/heterochromia).</p>
<p>We’ll use the same data from the course survey’s here:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>survey_data <span class="ot">&lt;-</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/surveydata_allcourse22.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="question-begin">
Question 7
</div>
<div class="question-body">
<p>Perform a <span class="math inline">\(\chi^2\)</span> goodness of fit test to assess the extent to which our sample of students conform to this theorised distribution of eye-colours.</p>
<p>No need to do this manually - once is enough. Just go straight to using the <code>chisq.test()</code> function.</p>
<div class="hints">
<p><strong>Hint:</strong> Try using <code>chisq.test(..., p = c(?,?,?,...) )</code>.<br>
We saw this in the example goodness of fit test, <a href="04a_chisq.html#example" target="_blank">4A #example</a></p>
</div>
</div>
<p class="question-end">
</p>
<div style="display:none;">
<p>Let’s look at the observed counts:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(survey_data<span class="sc">$</span>eyecolour)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
amber  blue brown green  grey hazel other 
    3    94   188    53     8    43    15 </code></pre>
</div>
</div>
<p>Our theoretical probabilities of different eye colours must match the order in the table which we give <code>chisq.test()</code>. They must also always sum to 1.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(survey_data<span class="sc">$</span>eyecolour), <span class="at">p =</span> <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">1</span>,.<span class="dv">76</span>,.<span class="dv">02</span>,.<span class="dv">01</span>,.<span class="dv">05</span>,.<span class="dv">01</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  table(survey_data$eyecolour)
X-squared = 440.99, df = 6, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 8
</div>
<div class="question-body">
<p>What are the <em>observed</em> proportions of our sample with each eyecolour?<br>
Can you figure out how to use the <code>prop.table()</code> function?</p>
</div>
<p class="question-end">
</p>
<div style="display:none;">
<p>From the help documentation (<code>?prop.table()</code>), we see that we can pass <code>prop.table()</code> the argument <code>x</code>, which needs to be a table.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(survey_data<span class="sc">$</span>eyecolour))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     amber       blue      brown      green       grey      hazel      other 
 0.7425743 23.2673267 46.5346535 13.1188119  1.9801980 10.6435644  3.7128713 </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(survey_data<span class="sc">$</span>eyecolour))<span class="sc">*</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_ex_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="divider div-transparent div-dot">

</div>
</section>
<section id="jokes-and-tips" class="level1">
<h1>Jokes and Tips</h1>
<div class="frame">
<p><strong>Data: TipJokes</strong></p>
<blockquote class="blockquote">
<p><strong>Research Question:</strong> Can telling a joke affect whether or not a waiter in a coffee bar receives a tip from a customer?</p>
</blockquote>
<p>A <a href="https://doi.org/10.1111/j.1559-1816.2002.tb00266.x">study</a> published in the Journal of Applied Social Psychology<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> investigated this question at a coffee bar of a famous seaside resort on the west Atlantic coast of France. The waiter randomly assigned coffee-ordering customers to one of three groups. When receiving the bill, one group also received a card telling a joke, another group received a card containing an advertisement for a local restaurant, and a third group received no card at all.</p>
<p>The data are available at https://uoepsy.github.io/data/TipJoke.csv.<br>
The dataset contains the variables:</p>
<ul>
<li><code>Card</code>: None, Joke, Ad.</li>
<li><code>Tip</code>: 1 = The customer left a tip, 0 = The customer did not leave tip.</li>
</ul>
</div>
<div class="question-begin">
Question 9
</div>
<div class="question-body">
<p>Produce a plot and a table to display the relationship between whether or not the customer left a tip, and what (if any) card they received alongside the bill.</p>
<p>Don’t worry about making it all pretty. Mosaic plots in R are a bit difficult.</p>
<div class="hints">
<p><strong>Hint:</strong><br>
<code>plot(table(...))</code> will give you something. You can see one in the example <span class="math inline">\(\chi^2\)</span> test of independence,<a href="04a_chisq.html#example-1" target="_blank">4A #example-1</a>.</p>
</div>
</div>
<p class="question-end">
</p>
<div style="display:none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tipjoke <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'https://uoepsy.github.io/data/TipJoke.csv'</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tipjoke<span class="sc">$</span>Card, tipjoke<span class="sc">$</span>Tip)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      
        0  1
  Ad   60 14
  Joke 42 30
  None 49 16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(tipjoke<span class="sc">$</span>Card, tipjoke<span class="sc">$</span>Tip))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_ex_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 10
</div>
<div class="question-body">
<p>What would you <em>expect</em> the cell counts to look like if there were no relationship between what the waiter left and whether or not the customer tipped?</p>
</div>
<p class="question-end">
</p>
<div style="display:none;">
<p>In total, 60 customers tipped (14+30+16), and 151 did not. So <em>overall</em>, 0.28 (<span class="math inline">\(\frac{60}{(60+151)}\)</span>) of customers tip.</p>
<p>74 customers got an Ad card, 72 customers got a Joke, and 65 got None. If this were independent of whether or not they left a tip, we would expect equal proportions of tippers in each group.<br>
So we would expect 0.28 of each group to leave a tip.</p>
<p>You can think about observed vs expected by looking at the two-way table along with the marginal row and column totals given:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> 0 </th>
   <th style="text-align:left;"> 1 </th>
   <th style="text-align:left;">  </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Ad </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;"> 74 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Joke </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;"> 72 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> None </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;"> 65 </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;"> 151 </td>
   <td style="text-align:left;"> 60 </td>
   <td style="text-align:left;"> 211 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>For a given cell of the table we can calculate the expected count as <span class="math inline">\(\text{row total} \times \frac{\text{column total}}{\text{samplesize}}\)</span>:</p>
<p><strong>Expected:</strong></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> 0 </th>
   <th style="text-align:right;"> 1 </th>
   <th style="text-align:right;">  </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Ad </td>
   <td style="text-align:right;"> 52.96 </td>
   <td style="text-align:right;"> 21.04 </td>
   <td style="text-align:right;"> 74 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Joke </td>
   <td style="text-align:right;"> 51.53 </td>
   <td style="text-align:right;"> 20.47 </td>
   <td style="text-align:right;"> 72 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> None </td>
   <td style="text-align:right;"> 46.52 </td>
   <td style="text-align:right;"> 18.48 </td>
   <td style="text-align:right;"> 65 </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 151.00 </td>
   <td style="text-align:right;"> 60.00 </td>
   <td style="text-align:right;"> 211 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>(If you’re wondering how we do this in R, there’s a complicated bit of code using <code>%o%</code> which could do this for us. You don’t need to remember %o%, it’s very rarely used):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> tipjoke <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Card, Tip) <span class="sc">%&gt;%</span> <span class="fu">table</span>()</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(t) <span class="sc">%o%</span> <span class="fu">colSums</span>(t) <span class="sc">/</span> <span class="fu">sum</span>(t)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>e</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            0        1
Ad   52.95735 21.04265
Joke 51.52607 20.47393
None 46.51659 18.48341</code></pre>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 11
</div>
<div class="question-body">
<p>Just like we gave the <code>chisq.test()</code> function a table of observed frequencies when we conducted a goodness of fit test in earlier exercises, we can give it a two-way table of observed frequencies to conduct a test of independence.</p>
<p>Try it now.</p>
</div>
<p class="question-end">
</p>
<div style="display:none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(tipjoke<span class="sc">$</span>Card, tipjoke<span class="sc">$</span>Tip))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  table(tipjoke$Card, tipjoke$Tip)
X-squared = 9.9533, df = 2, p-value = 0.006897</code></pre>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="divider div-transparent div-dot">

</div>
</section>
<section id="some-rmarkdown" class="level1">
<h1>Some RMarkdown</h1>
<p>For one of the <span class="math inline">\(t\)</span>-tests we saw in the previous week’s exercises, we can use an RMarkdown document in which we write our results so that they get compiled to look nice and pretty:</p>
<div class="panelset">
<section id="writing-this" class="level4 panel">
<h4 class="anchored" data-anchor-id="writing-this">Writing this</h4>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/hypothesis/rmarkdownbacktick.png" class="img-fluid figure-img" width="1000"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="compiles-to-this" class="level4 panel">
<h4 class="anchored" data-anchor-id="compiles-to-this">Compiles to this</h4>
<div class="frame">
<p>A one-sided one-sample t-test was conducted in order to determine if the average score on the Procrastination Assessment Scale for Students (PASS) for a sample of 20 students at Edinburgh University was significantly lower (<span class="math inline">\(\alpha = .05\)</span>) than the average score obtained during development of the PASS.</p>
<p>Edinburgh University students scored lower (Mean = 30.7, SD = 3.31) than the score reported by the authors of the PASS (Mean = 33). This difference was statistically significant (t(19)=-3.11, p &lt; .05, one-tailed).</p>
</div>
</section>
</div>
<p>This is one of the huge benefits of RMarkdown. Imagine we collected more data - we wouldn’t have to edit all the results, we could simply recompile and they would update for us!<br>
Note how it works:</p>
<ul>
<li>the code chunk saves the results of the <code>t.test()</code> function as a named object <code>res2</code>.</li>
<li>in text, the backticks <code>`r … … … `</code> are used to execute small bits of R code, and include the output within the text. For instance, the line <code>`r res2$statistic %&gt;% round(2)`</code> gets the t-statistic from the results, and rounds it to 2 decimal places, which get’s printed out as -3.11.</li>
<li>the bits between the dollar signs, e.g.&nbsp;$\alpha$ will get printed as mathematical symbols such as <span class="math inline">\(\alpha\)</span>.</li>
</ul>
<div class="imp">
<p>RMarkdown documents are <strong>self-contained.</strong></p>
<p>You need to to put <em>everything</em> that is needed to reproduce your analysis <em>in the correct order</em>.</p>
<p>For instance, if you have used the console (bottom left window) to define an object <code>peppapig &lt;- 30</code>, you will have an object in your environment (top right window) called “peppapig” which has the value 30.</p>
<p>If you were to refer to that object in your RMarkdown document, you will be able to run a line of code such as <code>peppapig/10</code> because it will find the “peppapig” object in <strong>your</strong> environment. <strong>BUT</strong> you won’t be able to compile the document because it “starts fresh” (i.e., compiles within its own environment). In order for it to compile, you would need to <em>define</em> what “peppapig” is <strong>inside</strong> your document, and <strong>before</strong> the document then refers to it.</p>
<p>The same applies with using functions in from packages. The RMarkdown document needs to know what packages to load before it uses functions from them. Just because <em>you</em> yourself have loaded a package in your session, it does not mean the compilation process for your RMarkdown has access to it.</p>
</div>
<p>If you want some extra explanations on these aspects of RMarkdown, then please see Lessons 0-3 of our <a href="https://uoepsy.github.io/scs/rmd-bootcamp/" target="_blank">Rmd-bootcamp</a>.</p>
<div class="question-begin">
Question 12
</div>
<div class="question-body">
<p>Can you create an RMarkdown document which:</p>
<ol type="1">
<li>Reads in the <a href="https://uoepsy.github.io/data/TipJoke.csv">https://uoepsy.github.io/data/TipJoke.csv</a> data.</li>
<li>Conducts and reports a <span class="math inline">\(\chi^2\)</span> test of independence examining whether telling a joke affect whether or not a waiter in a coffee bar receives a tip from a customer.</li>
<li>Successfully compiles (“knits”) into an <strong>.html</strong> file.</li>
</ol>
</div>
<p class="question-end">
</p>
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;">

</div>


</section>


<div id="quarto-appendix" class="default"><section class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1" role="doc-endnote"><p>Gueaguen, N. (2002). The Effects of a Joke on Tipping When It Is Delivered at the Same Time as the Bill. <em>Journal of Applied Social Psychology, 32</em>(9), 1955-1963.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>