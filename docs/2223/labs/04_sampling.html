<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.587">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>USMR - Curves &amp; Sampling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-hand-o-right')) {
    f.classList.add('fa-hand-o-left')
    f.classList.remove('fa-hand-o-right')
} else {
    f.classList.add('fa-hand-o-right')
    f.classList.remove('fa-hand-o-left')
}
}
</script>

<script src="https://kit.fontawesome.com/120b08a6f5.js" crossorigin="anonymous"></script>
<link href="site_libs/panelset-0.2.6/panelset.css" rel="stylesheet">
<script src="site_libs/panelset-0.2.6/panelset.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">USMR</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-1" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 1</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-1">    
        <li>
    <a class="dropdown-item" href="./01_R.html">
 <span class="dropdown-text">Chapter 1: First look at R/RStudio</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02_data.html">
 <span class="dropdown-text">Chapter 2: More R: Basic Data Skills</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./ex01.html">
 <span class="dropdown-text">Exercises</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-2" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 2</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-2">    
        <li>
    <a class="dropdown-item" href="./03_measurement.html">
 <span class="dropdown-text">Chapter 3: Measurements &amp; Distributions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./04_sampling.html">
 <span class="dropdown-text">Chapter 4: Sampling &amp; Curves</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./ex02_.html">
 <span class="dropdown-text">Exercises</span></a>
  </li>  
    </ul>
  </li>
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#probability-distributions" id="toc-probability-distributions" class="nav-link active" data-scroll-target="#probability-distributions">Probability distributions</a></li>
  <li><a href="#normal-distributions" id="toc-normal-distributions" class="nav-link" data-scroll-target="#normal-distributions">Normal distributions</a></li>
  <li><a href="#sampling-distributions" id="toc-sampling-distributions" class="nav-link" data-scroll-target="#sampling-distributions">Sampling Distributions</a></li>
  <li><a href="#standard-error-in-practice" id="toc-standard-error-in-practice" class="nav-link" data-scroll-target="#standard-error-in-practice">Standard Error in practice</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals">Confidence Intervals</a></li>
  <li><a href="#clt" id="toc-clt" class="nav-link" data-scroll-target="#clt">CLT</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Curves &amp; Sampling</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="probability-distributions" class="level1">
<h1>Probability distributions</h1>
<p>We’ve seen some ways of describing and visualising the distributions of variables that we might observe when we collect data. Such a collection of observations on a single variable is often termed a “sample distribution”.</p>
<p>Another type of distribution that will prove to be very useful is a “probability distribution”.</p>
<div class="sticky">
<p>A probability distribution is the (mathematical) description of the probabilities of occurrences of observing the different possible outcomes.</p>
</div>
<p>Note an important jump we are making is that we are moving from talking about distributions that we <em>observe</em>, to something more conceptual. Typically, this is because we want to talk more generally about the underlying process which generates the data.</p>
<p>For example, the function that governs the behaviour of rolling a single die is <strong>uniform</strong> in that each possible response has an equal probability (<span class="math inline">\(\frac{1}{6}\)</span>) of being observed (below left). When we <em>collect</em> data by actually rolling a die 100 times, we will observe a sample distribution (below right).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_sampling_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<div class="statbox">
<p><strong>Uniformity</strong></p>
<p>When an equal probability is assigned to each possible response, we have what is known as the <strong>uniform distribution</strong>.<br>
For a fair 6-sided die, the probability of the die landing on each side is 1/6, and the probabilities of all the possible responses sum to 1 (because it has to land on <em>one of</em> the sides).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_sampling_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
<p>The dice-rolling example is one involving a categorical distribution - i.e.&nbsp;data which has a discrete set of response options. We don’t have to use a 6-sided die - if it follows a uniform probability distribution, and there are <span class="math inline">\(n\)</span> possible responses, then the probability of each response ocurring is <span class="math inline">\(1/n\)</span>.</p>
<p>However, the uniform probability distribution can be relevant for a continuous numeric variable as well (e.g.&nbsp;something which as well as taking the values 4 and 5 can also take 4.1, 4.11, 4.1111111111, 4.764968473 etc.. - they can take <em>any</em> real value). We can preserve the idea that probability sums to 1 for this sort of variable by having the probability as <span class="math inline">\(\frac{1}{b-a}\)</span>, where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are the lower and upper bounds of the response domain. Why? Because this makes the <strong>area</strong> of the distribution equal to 1 (area of a rectangle = width <span class="math inline">\(\times\)</span> height. <span class="math inline">\((b-a) \times \frac{1}{(b-a)} = \frac{b-a}{b-a} = 1)\)</span>. This means we can compute areas of parts of the distribution in order to calculate probabilities!</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_sampling_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="normal-distributions" class="level1">
<h1>Normal distributions</h1>
<p>why normal?<br>
sampling is random<br>
deviations around a mean</p>
<p>rnorm() pnorm()</p>
<div class="sticky">
<p>There are certain properties of normal distributions which we can exploit, in order to determine how plausible an observed value is relative to a distribution. When a distribution is normal (symmetric and bell-shaped):</p>
<ul>
<li>68% of values will lie within 1 standard deviation of the mean.</li>
<li>95% of values will lie within 1.96 standard deviations of the mean.</li>
<li>99.7% of values will lie within 3 standard deviations of the mean.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/hypothesis/normal.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="sampling-distributions" class="level1">
<h1>Sampling Distributions</h1>
<p>Often, what we’re really interested does not concern a specific individual but the wider population in general. For example, TODO</p>
<p>In practice, when we do research we tend to collect data from a <em>sample</em>, because it is not feasible to collect data from the entire population. By using a random sample to represent a population of interest, we introduce uncertainty (due to sampling variability) in how accurate our <strong>sample statistic</strong> is as an <em>estimate</em> of the population parameter.</p>
<p>For example, TODO -MATCH ABOVE TODO <!-- suppose we The different samples that we _might_ take will result in different statistics. For example, we could sample 10 students and calculate their average height as 157cm. But if we were to do the same thing again, we would get a different set of 10 students in our sample, and a different average height (e.g. they could have an average height of 160cm, or 140, or 180). But what we're interested in is the average height of the population (i.e. the average height of of _all_ students). The sample averages that we could measure will vary around this number. Some will be higher, some will be lower.  --></p>
<p>Let’s look at this with a little example.</p>
<p>Let’s pretend that the average height of the entire global adult population is <em>exactly</em> 178cm, and that the standard deviation of heights is 10cm. However, let’s also pretend that we <em>do not know</em> that the average height is 178cm, and that we are interested in trying to estimate the average height. Unfortunately, all we have is the measurements of 20 people who we randomly sampled. We want to use the mean height of our sample as an estimate of the mean height of the population.</p>
<p>In R, we can simulate the act of randomly sampling 20 people’s heights from the population with <span class="math inline">\(\mu = 178\)</span> and <span class="math inline">\(\sigma = 10\)</span> using <code>rnorm()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>our_sample <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(our_sample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 176.7317</code></pre>
</div>
</div>
<p>Note that the mean of our sample (176.73) is not quite the same as the mean of the population (178 exactly). As we know, <em>samples vary</em>. If we do the same thing again, R will take a different sample of 20, and so the mean of this new sample will also be different:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 181.0967</code></pre>
</div>
</div>
<p>Each time we get a new sample, we get a different mean:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd =</span> <span class="dv">10</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd =</span> <span class="dv">10</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 179.3159</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 178.1062</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 175.7159</code></pre>
</div>
</div>
<p>What we’re wanting to do here is think about <em>all</em> possible samples of 20 people we could take, and <em>all</em> the possible resulting mean heights. Let’s suppose we took 1000 samples of 20 people, and for each one we calculated the mean height. Where would all these different means fall? Some would be above our population parameter (i.e.&nbsp;we just might happened to have sampled some slightly taller people) and some would be below.</p>
<p>We can use R to enact this repeated sampling: the <code>replicate()</code> function allows us to repeatedly execute a bit of code, which means we can take lots of samples and calculate their means. These means we can then visualise using <code>hist()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>manysamplemeans <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd =</span> <span class="dv">10</span>)))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(manysamplemeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_sampling_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Note what happens to the distribution when we take 1000 means of samples of size <span class="math inline">\(n=200\)</span>, rather than <span class="math inline">\(n=20\)</span>. Many more of the of the values are in a much narrower bracket (pay careful attention to the x-axis) than when we took lots of samples of <span class="math inline">\(n=20\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>manysamplemeans200 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd =</span> <span class="dv">10</span>)))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(manysamplemeans200)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_sampling_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Why is this important?</strong></p>
<p>What we’re doing here is showing the process of taking many samples of the same size from a population and calculating a statistic on each sample. The distribution of these sample statistics shows how the statistic will vary from sample to sample due to chance. Provided that our sampling is <em>truly</em> random, the sample statistics will be centered around the population parameter.</p>
<p>In the above example, for samples of <span class="math inline">\(n=20\)</span> drawn from a population with mean <span class="math inline">\(\mu=178\)</span> and standard deviation <span class="math inline">\(\sigma=10\)</span>, the sample means are centered around 178, and we’re quite likely to get sample means between 174 and 182, but less likely to see sample means <span class="math inline">\(&lt;174\)</span> and <span class="math inline">\(&gt;182\)</span>. Importantly, we can quantify this. The distribution of means from samples of size <span class="math inline">\(n=20\)</span> has a standard deviation of:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(manysamplemeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.30394</code></pre>
</div>
</div>
<p>This metric, the standard deviation of the sampling distribution of a statistic, is known as the <strong>standard error.</strong></p>
<div class="statbox">
<p><strong>Sampling Distribution and Standard Error</strong></p>
<ul>
<li>The theoretical distribution of how sample statistics will vary on repeated sampling is known as the <strong>sampling distribution</strong>.<br>
</li>
<li>The standard deviation of the sampling distribution is known as the <strong>standard error</strong>.<br>
</li>
<li>Note that the bigger our sample size, the smaller our standard error - i.e., the more precise our sample means are going to be as estimates of the population mean:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_sampling_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="standard-error-in-practice" class="level1">
<h1>Standard Error in practice</h1>
<p>In practice, we cannot actually take lots and lots of samples in order to construct a sampling distribution, and nor do we know the population parameters which are required to generate samples like we did above (we do not know the population mean <span class="math inline">\(\mu\)</span> or standard deviation <span class="math inline">\(\sigma\)</span>)</p>
<p>Instead, we start with just one observed sample, e.g.:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>observed_sample <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">176.86</span>, <span class="fl">169.45</span>, <span class="fl">177.93</span>, <span class="fl">175.89</span>, <span class="fl">169.05</span>, <span class="fl">162.56</span>, <span class="fl">189.29</span>, <span class="fl">196.15</span>, <span class="fl">159.45</span>, <span class="fl">165.69</span>, <span class="fl">186.88</span>, <span class="fl">176.9</span>, <span class="fl">188.52</span>, <span class="fl">164.05</span>, <span class="fl">175.62</span>, <span class="fl">180.89</span>, <span class="fl">193.63</span>, <span class="fl">161.59</span>, <span class="fl">182.74</span>, <span class="fl">184.23</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What we <em>can</em> do is either:</p>
<ul>
<li><p><strong>A:</strong> Simulate lots of sampling via <strong>bootstrapping</strong>.<br>
This uses <em>resampling with replacement</em><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> from our original sample as a means of imitating repeated sampling. Note the <code>replace = FALSE</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap means of resamples with replacement of the same size (20) as observed sample</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>bootstrap_means <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(observed_sample, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># SE = sd of bootstrap resample means </span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(bootstrap_means)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.437693</code></pre>
</div>
</div></li>
<li><p>or <strong>B:</strong> Estimate the standard error using a formula:<br>
<span class="math display">\[
SE = \frac{\sigma}{\sqrt{n}}  \\
\quad \\
\begin{align}
&amp; \text{Where} \\
&amp; \sigma = \text{standard deviation} \\
&amp; n = \text{sample size} \\
\end{align}
\]</span> Note that <span class="math inline">\(\sigma\)</span> is the standard deviation of the population, which is unknown to us. However, we can use the standard deviation of our sample (<span class="math inline">\(\hat \sigma\)</span> or <span class="math inline">\(s\)</span>) as our estimate of this:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SE = standard deviation / square root of n</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(observed_sample)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(observed_sample))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.459404</code></pre>
</div>
</div></li>
</ul>
</section>
<section id="confidence-intervals" class="level1">
<h1>Confidence Intervals</h1>
<p>TODO</p>
</section>
<section id="clt" class="level1">
<h1>CLT</h1>
<p>Notice that the sampling distributions we have generated above all have similar properties - they are <em>symmetric and bell-shaped</em>. They are <strong>normally distributed</strong>.</p>
<p>In fact, the <strong>central limit theorem (CLT)</strong> states that when we take sufficiently large random samples from a population, the distribution of the sample means will be approximately normally distributed. This holds regardless of whether the population is normal (or skewed).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-clt" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04_sampling_files/figure-html/fig-clt-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 1: Population distributions (top) and sampling distributions (bottom)</figcaption><p></p>
</figure>
</div>
</div>
</div>


</section>


<div id="quarto-appendix" class="default"><section class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1" role="doc-endnote"><p>Imagine a bag full of coloured marbles. If we sample <em>with replacement</em>, then we take a marble out, record its colour, and put it back. Then we take a marble out, record its colour, and put it back. And so on. This means we might get the same marble more than once.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>