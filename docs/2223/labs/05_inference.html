<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.587">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>USMR - Foundations of Inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-hand-o-right')) {
    f.classList.add('fa-hand-o-left')
    f.classList.remove('fa-hand-o-right')
} else {
    f.classList.add('fa-hand-o-right')
    f.classList.remove('fa-hand-o-left')
}
}
</script>

<script src="https://kit.fontawesome.com/120b08a6f5.js" crossorigin="anonymous"></script>
<link href="site_libs/panelset-0.2.6/panelset.css" rel="stylesheet">
<script src="site_libs/panelset-0.2.6/panelset.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">USMR</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-1" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 1</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-1">    
        <li>
    <a class="dropdown-item" href="./01_R.html">
 <span class="dropdown-text">Chapter 1: First look at R/RStudio</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02_data.html">
 <span class="dropdown-text">Chapter 2: More R: Basic Data Skills</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./ex01.html">
 <span class="dropdown-text">Exercises</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-2" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 2</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-2">    
        <li>
    <a class="dropdown-item" href="./03_measurement.html">
 <span class="dropdown-text">Chapter 3: Measurements &amp; Distributions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./04_sampling.html">
 <span class="dropdown-text">Chapter 4: Sampling &amp; Curves</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./ex02.html">
 <span class="dropdown-text">Exercises</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-3" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 3</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-3">    
        <li>
    <a class="dropdown-item" href="./05_inference.html">
 <span class="dropdown-text">Chapter 5: Foundations of Inference</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./06_inference2.html">
 <span class="dropdown-text">Chapter 6: Practical Inference</span></a>
  </li>  
    </ul>
  </li>
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#null-hypothesis-significance-testing-nhst" id="toc-null-hypothesis-significance-testing-nhst" class="nav-link active" data-scroll-target="#null-hypothesis-significance-testing-nhst">Null Hypothesis Significance Testing (NHST)</a>
  <ul class="collapse">
  <li><a href="#p-values" id="toc-p-values" class="nav-link" data-scroll-target="#p-values">p-values</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Foundations of Inference</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>We use statistics primarily to estimate parameters in a population. Whether we are polling people to make predictions about the proportion of people who will vote for a certain party in the next election, or conducting a medical trial and assessing the change in blood pressure for patients given drug X vs those given a placebo in order tp decide whether to put the drug into circulation in health service.</p>
<p>We have seen this already last week: We <em>observed</em> a sample of peoples’ life satisfaction ratings (scale 0-100), and we wanted to use these to make some statement about the wider population.</p>
<p>A sample estimates is not going to be spot-on. By taking only a subset of people, we introduced sampling variability - we have uncertainty in the accuracy of our estimate. We saw in the <a href="04_sampling.html">previous chapter</a> how to make a <strong>confidence interval</strong> as a means of capturing this uncertainty, providing a range of plausible values.</p>
<p>Let’s look at this with a different example.</p>
<div class="frame">
<p><strong>Stroop Data</strong></p>
<p>The data we are going to use here come from an experiment using one of the best known tasks in psychology, the “Stroop task”.</p>
<p>In our dataset, we have information from 130 participants who completed an online task in which they saw two sets of coloured words. Participants spoke out loud the colour of each word, and timed how long it took to complete each set. In the one set of words, the words <em>matched</em> the colours they were presented in (e.g., word “blue” was coloured blue). In the other set of words, the words <em>mismatched</em> the colours (e.g., the word “blue” was coloured red (see <a href="#fig-stroop1">Figure&nbsp;1</a>). The order of matching/mismatching sets was randomly allocated for each participant. Participants’ recorded their times for each set (<em>matching</em> and <em>mismatching</em>).<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>The data are available at <a href="https://uoepsy.github.io/data/stroop.csv">https://uoepsy.github.io/data/stroop.csv</a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-stroop1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/numeric/stroop1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 1: Stroop Task - Color word interference. Images from https://faculty.washington.edu/chudler/java/ready.html</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p>First, we read in the data and take a look at it. How many rows, how many columns, and so on.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>stroopdata <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../../../data/stroop.csv"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(stroopdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 131   4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(stroopdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "id"          "age"         "matching"    "mismatching"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(stroopdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
     id   age matching mismatching
  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;
1     1    41     22.3        16.9
2     2    24     22.3        19.1
3     3    40     15.4        13.6
4     4    46      9.9        15.0
5     5    36     14.2        16.4
6     6    29     19.9        18.0</code></pre>
</div>
</div>
<p>What we are interested in is the differences between the matching and mismatching times. For someone who took 10 seconds for the matching set, and 30 seconds for the mismatching set, we want to record their score as a difference of 20 seconds.</p>
<p>We can do that easily, storing the new values in a new variable:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>stroopdata <span class="ot">&lt;-</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  stroopdata <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff =</span> mismatching <span class="sc">-</span> matching</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And to quickly prove to ourselves that is has worked:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(stroopdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
     id   age matching mismatching  diff
  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;
1     1    41     22.3        16.9 -5.4 
2     2    24     22.3        19.1 -3.2 
3     3    40     15.4        13.6 -1.81
4     4    46      9.9        15.0  5.14
5     5    36     14.2        16.4  2.18
6     6    29     19.9        18.0 -1.90</code></pre>
</div>
</div>
<p>And let’s get some summary statistics and a visualisation of that distribution too.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mean(stroopdata$diff) and sd(stroopdata$diff) work just as well</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>stroopdata <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">meandiff =</span> <span class="fu">mean</span>(diff),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sddiff =</span> <span class="fu">sd</span>(diff)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  meandiff sddiff
     &lt;dbl&gt;  &lt;dbl&gt;
1     2.40   5.02</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stroopdata, <span class="fu">aes</span>(<span class="at">x =</span> diff)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05_inference_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>What we’re really interested in talking about is the average ‘mismatching - matching’ score for <strong>everybody</strong>, not just our sample of 131. But we only have those 131 people, so we’ll have to make do and use their data to provide us with an <strong>estimate</strong>.</p>
<p>Remember that there are many many different samples of <span class="math inline">\(n=131\)</span> that we <em>might have</em> taken. And if we had taken a different sample, then our mean ‘mismatching - matching’ score (the <code>mean(stroopdata$diff)</code> value) would be different.</p>
<p>In the previous chapter we learned about how the distribution of all possible sample means we <em>might</em> take is known as a <strong>sampling distribution</strong>. We also learned that these tend to be normally distributed (regardless of the underlying population distribution) and so we can use the standard deviation of the sampling distribution (known as the <strong>standard error</strong>) to quantify the variation due to sampling.</p>
<p>To actually get at the standard error, one of our options is to simulate the act of ‘taking many samples of size <span class="math inline">\(n\)</span>’ by taking lots of samples <em>with replacement</em> from our original sample.</p>
<p>As our analyses become more advanced, then this will become more complex. In this example, because we are just interested in estimating a single mean value, we can use <code>replicate</code> to do calculate the means from 1000 resamples from our original sample. We can then simply calculate the standard deviation of all these means:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>stroop_bootstrapdist <span class="ot">&lt;-</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(stroopdata<span class="sc">$</span>diff, <span class="at">size =</span> <span class="dv">131</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(stroop_bootstrapdist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4275064</code></pre>
</div>
</div>
<p>Alternatively (and more conventionally), we use a formula of <span class="math inline">\(\frac{\sigma}{\sqrt{n}}\)</span>, which we can calculate in R.<br>
<span class="math inline">\(\sigma\)</span> is the standard deviation of the population (which we are going to approximate by using <span class="math inline">\(s\)</span>, the standard deviation of our sample), and <span class="math inline">\(n\)</span> is the size of our sample.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>stroopdata <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">s =</span> <span class="fu">sd</span>(diff),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE =</span> s<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
      s     n    SE
  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1  5.02   131 0.438</code></pre>
</div>
</div>
<p>Finally, we can use our standard error to construct a range of plausible values for our estimated ‘mismatching - matching’ score. The range is centered around our <strong>point estimate</strong> (the mean score in our sample), and we widen it to include X% of the possible means we might also see from a sample of the same size. This is achieved by multiplying the standard error by a value to corresponds our confidence level.</p>
<p>For a 95% interval<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>se <span class="ot">=</span> <span class="fu">sd</span>(stroopdata<span class="sc">$</span>diff) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">nrow</span>(stroopdata))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(stroopdata<span class="sc">$</span>diff) <span class="sc">-</span> (<span class="fl">1.96</span> <span class="sc">*</span> se), <span class="fu">mean</span>(stroopdata<span class="sc">$</span>diff) <span class="sc">+</span> (<span class="fl">1.96</span> <span class="sc">*</span> se))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.544046 3.261908</code></pre>
</div>
</div>
<section id="null-hypothesis-significance-testing-nhst" class="level1">
<h1>Null Hypothesis Significance Testing (NHST)</h1>
<p>Let’s suppose we are interested in whether there <strong>is</strong> an effect of the mismatching/matching colour-words. Our objective here has changed slightly: rather than being concerned with parameter estimation, our question is now about making a statement about two competing hypotheses:</p>
<ul>
<li><span class="math inline">\(H_0 \,\, (\text{The Null Hypothesis}):\)</span> There is no difference between matching and mismatching conditions.</li>
<li><span class="math inline">\(H_1 \,\, (\text{The Alternative Hypothesis}):\)</span> There is no difference between matching and mismatching conditions.</li>
</ul>
<p>If we use <span class="math inline">\(\mu\)</span> to denote the average ‘mismatching - matching’ score <em>in the population</em>, then we can state these as:</p>
<ul>
<li><span class="math inline">\(H_0: \mu = 0\)</span>.<br>
</li>
<li><span class="math inline">\(H_1: \mu \neq 0\)</span>.</li>
</ul>
<p>With the confidence interval that we have created above, we can already make a statement about these. Our 95% CI does not contain zero, meaning that we can, with that same level of confidence, reject <span class="math inline">\(H_0\)</span> in favour of <span class="math inline">\(H_1\)</span>.</p>
<p>However, there are instances where it is not feasible for us to create a confidence interval.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> This is where the other primary tool for null hypothesis significance testing comes in, the p-value.</p>
<section id="p-values" class="level2">
<h2 class="anchored" data-anchor-id="p-values">p-values</h2>
<p>The p-value is a formal way of testing a sample statistic against a null hypothesis.</p>
<p>To introduce the p-value, instead of thinking first about what we <em>have</em> observed in our sample, we need to think about what we would expect to observe <em>if our null hypothesis is true.</em></p>
<p>With our Stroop Task example, our null hypothesis is that there is no difference between matching and mismatching conditions (<span class="math inline">\(H_0: \mu = 0\)</span>).</p>
<p>Under <span class="math inline">\(H_0\)</span>, the average ‘mismatching-matching’ score in the population is zero, and we would expect most of the samples we <em>might</em> take to have a mean ‘mismatching-matching’ score of close to this (not <em>exactly</em> 0, but centered around 0).</p>
<p>We saw earlier that we could express the sampling distribution of means taken from samples of size <span class="math inline">\(n=131\)</span> using the <strong>standard error</strong>. Under <span class="math inline">\(H_0\)</span> we would expect the samples of <span class="math inline">\(n=131\)</span> we <em>might</em> take to have means that follow something like the distribution in <a href="#fig-hyp">Figure&nbsp;2</a>.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>stroopdata <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">s =</span> <span class="fu">sd</span>(diff),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE =</span> s<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
      s     n    SE
  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1  5.02   131 0.438</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-hyp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="05_inference_files/figure-html/fig-hyp-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 2: Sampling distribution for mean of sample size 131, assuming population mean = 0. Observed sample mean shown in red</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We can think of this as the sampling distribution of <span class="math inline">\(\bar{x}\)</span>, but centered on our null hypothesis (in this case, <span class="math inline">\(\mu = 0\)</span>). We call this the ‘null distribution’.</p>
<p>The p-value tells us how likely it is to see values <em>at least as extreme</em> as our observed sample statistic, <em>if the null is true</em>.<br>
We have seen how we can calculate this already: the <code>pnorm()</code> function gives us the area of a distribution to the one side of a given value:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(??, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.44</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pnormstroop" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="05_inference_files/figure-html/fig-pnormstroop-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 3: the p-value is the area of the null distribution, as found with pnorm()</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>For our Stroop Task example, we observed a sample mean of</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(stroopdata<span class="sc">$</span>diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.402977</code></pre>
</div>
</div>
<p>If the null hypothesis were true, and there was no ‘mismatching-matching’ difference, then the probability that we would see a sample (<span class="math inline">\(n=131\)</span>) with a mean <em>at least</em> that large is:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (we calculated that SE = 0.44 above)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">2.40</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.44</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.454914e-08</code></pre>
</div>
</div>
<p>which is R’s way of printing 0.00000002454914.</p>
<p>There is one last thing, and that the <em>direction</em> of our hypotheses. Recall from earlier that we stated <span class="math inline">\(H_0: \mu = 0\)</span> and <span class="math inline">\(H_1: \mu \neq 0\)</span>. This means that we are interested in the probability of getting results this far away from 0 <em>in either direction.</em><br>
We are interested in both tails:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="fl">2.40</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.44</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.909828e-08</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pnormstroop2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="05_inference_files/figure-html/fig-pnormstroop2-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4: 2*pnorm gives the two tails</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="sticky">
<p><strong>p-value</strong></p>
<p>The p-value is the probability<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> that we observe a test statistic at least as extreme as the one we observed, <em>assuming the null hypothesis <span class="math inline">\(H_0\)</span> to be true</em>.</p>
</div>
<p>Now that we have our p-value of 0.00000004909828, we need to use it to make a decision about our hypotheses.</p>
<p>Typically, we pre-specify the probability level at which we will consider results to be so unlikely to have arisen from the null distribution that we will take them as evidence to reject the null hypothesis. This pre-specified level is commonly referred to as <span class="math inline">\(\alpha\)</span> (“alpha”). Setting <span class="math inline">\(\alpha = 0.05\)</span> means that we will reject <span class="math inline">\(H_0\)</span> when we get a result which is extreme enough to only occur 0.05 (5%) of the time or less if the <span class="math inline">\(H_0\)</span> is true.</p>
<p>In our case, 0.00000004909828 <span class="math inline">\(&lt; 0.05\)</span>, so we reject the null hypothesis that there is no difference in the mismatching/matching conditions of the Stroop Task.</p>
<div class="statbox">
<p><strong>The language of NHST</strong></p>
<p>There’s a lot of convention to how we talk about NHST, but the typical process is as follows:</p>
<ol type="1">
<li><em>Clearly</em> specify the null and alternative hypotheses.<br>
</li>
<li>Specify <span class="math inline">\(\alpha\)</span></li>
<li>Calculate statistic</li>
<li>Compute p-value
<ul>
<li>If <span class="math inline">\(p&lt;\alpha\)</span>, then reject the null hypothesis.</li>
<li>If <span class="math inline">\(p\geq\alpha\)</span>, then fail to reject* the null hypothesis.</li>
</ul></li>
</ol>
<p>*Note, we don’t “accept” the null, we just “fail to reject” it. Think of it like a criminal court - the null hypothesis is “innocent until proven guilty”</p>
</div>


</section>
</section>


<div id="quarto-appendix" class="default"><section class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1" role="doc-endnote"><p>You can try out the experiment at https://faculty.washington.edu/chudler/java/ready.html<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p> For other intervals, such as a 90% interval, we need to know the point at which 5% is either side of a normal distribution (i.e., giving us the middle 90%). We can do this with <code>qnorm()</code> (we introduced this in <a href="04_sampling.html#normal-distributions" target="_blank">Chapter 4</a>).<br>
<code>qnorm(c(0.05,0.95))</code> will give us 1.64, which we then put into our construction of the interval: <span class="math inline">\(90\%\, CI = \bar{x} \pm 1.64 \times SE\)</span><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>Think about an example where our question is about whether there is a difference in variable <span class="math inline">\(Y\)</span> between groups A, B, C and D. Around what should we construct our interval? Around the difference <span class="math inline">\(\bar{Y}_A - \bar{Y}_B\)</span> (difference between A and B’s average scores on <span class="math inline">\(Y\)</span>), or <span class="math inline">\(\bar{Y}_A - \bar{Y}_C\)</span>, or <span class="math inline">\(\bar{Y}_B - \bar{Y}_D\)</span>?<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>What we have been seeing is that probabilities in NHST are defined as the relative frequency of an event <em>over many trials</em> (as “many” <span class="math inline">\(\to \infty\)</span>). This requires assuming some features of the data generating process which guides what the “many trials” would look like (e.g., that there is no effect). The <span class="math inline">\(p\)</span>-value is the probability of observing results as or more extreme than the data, <em>if the data were really generated by a hypothesised chance process</em>.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>