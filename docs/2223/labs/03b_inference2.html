<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>USMR - 3B: Practical Inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-hand-o-right')) {
    f.classList.add('fa-hand-o-down')
    f.classList.remove('fa-hand-o-right')
} else {
    f.classList.add('fa-hand-o-right')
    f.classList.remove('fa-hand-o-down')
}
}
</script>

<script src="https://kit.fontawesome.com/120b08a6f5.js" crossorigin="anonymous"></script>
<link href="site_libs/panelset-0.2.6/panelset.css" rel="stylesheet">
<script src="site_libs/panelset-0.2.6/panelset.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">USMR</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-1" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 1</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-1">    
        <li>
    <a class="dropdown-item" href="./01a_R.html">
 <span class="dropdown-text">1A: First look at R/RStudio</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./01b_data.html">
 <span class="dropdown-text">1B: More R: Basic Data Skills</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./01_ex.html">
 <span class="dropdown-text">Exercises: Intro R</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-2" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 2</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-2">    
        <li>
    <a class="dropdown-item" href="./02a_measurement.html">
 <span class="dropdown-text">2A: Measurements &amp; Distributions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02b_sampling.html">
 <span class="dropdown-text">2B: Sampling &amp; Curves</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02_ex.html">
 <span class="dropdown-text">Exercises: More R; Estimates &amp; Intervals</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-3" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 3</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-3">    
        <li>
    <a class="dropdown-item" href="./03a_inference.html">
 <span class="dropdown-text">3A: Foundations of Inference</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./03b_inference2.html">
 <span class="dropdown-text">3B: Practical Inference</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./03_ex.html">
 <span class="dropdown-text">Exercises: T-tests</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-4" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 4</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-4">    
        <li>
    <a class="dropdown-item" href="./04a_chisq.html">
 <span class="dropdown-text">4A: Chi-Square Tests</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./04b_revisitnhst.html">
 <span class="dropdown-text">4B: Revisiting NHST</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./04_ex.html">
 <span class="dropdown-text">Exercises: Chi-Square Tests</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-5" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 5</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-5">    
        <li>
    <a class="dropdown-item" href="./05a_covcor.html">
 <span class="dropdown-text">5A: Covariance &amp; Correlation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./05_ex.html">
 <span class="dropdown-text">Exercises: Cov, Cor, Models</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-6" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 6</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-6">    
        <li>
    <a class="dropdown-item" href="./06_wt.html">
 <span class="dropdown-text">Walkthrough: Advanced Data Wrangling</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-7" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 7</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-7">    
        <li>
    <a class="dropdown-item" href="./07a_slr.html">
 <span class="dropdown-text">7A: Simple Linear Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./07_ex.html">
 <span class="dropdown-text">Exercises: Simple Linear Regression</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-8" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 8</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-8">    
        <li>
    <a class="dropdown-item" href="./08a_mlr.html">
 <span class="dropdown-text">8A: Multiple Linear Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./08b_assumptdiag.html">
 <span class="dropdown-text">8B: Assumptions, Diagnostics, and Troubleshooting</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./08_ex.html">
 <span class="dropdown-text">Exercises: Multiple Linear Regression</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-9" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 9</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-9">    
        <li>
    <a class="dropdown-item" href="./09a_interactions.html">
 <span class="dropdown-text">9A: Interactions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./09b_contrasts.html">
 <span class="dropdown-text">9B: Categorical Predictors</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./09_ex.html">
 <span class="dropdown-text">Exercises: Interactions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-10" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 10</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-10">    
        <li>
    <a class="dropdown-item" href="./10a_glm.html">
 <span class="dropdown-text">10A: GLM!</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./10_ex.html">
 <span class="dropdown-text">Exercises: Logistic Regression</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-11" role="button" data-bs-toggle="dropdown" aria-expanded="false">Week 11</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-11">    
        <li class="dropdown-header">Exercises</li>
    </ul>
  </li>
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#t-distributions" id="toc-t-distributions" class="nav-link active" data-scroll-target="#t-distributions"><span class="math inline">\(t\)</span>-distributions</a></li>
  <li><a href="#r-making-things-easier" id="toc-r-making-things-easier" class="nav-link" data-scroll-target="#r-making-things-easier">R: Making things easier</a>
  <ul class="collapse">
  <li><a href="#checkingtesting-assumptions" id="toc-checkingtesting-assumptions" class="nav-link" data-scroll-target="#checkingtesting-assumptions">Checking/Testing Assumptions</a></li>
  </ul></li>
  <li><a href="#basic-tests" id="toc-basic-tests" class="nav-link" data-scroll-target="#basic-tests">Basic Tests</a>
  <ul class="collapse">
  <li><a href="#one-sample-t-test" id="toc-one-sample-t-test" class="nav-link" data-scroll-target="#one-sample-t-test">One sample t-test</a></li>
  <li><a href="#two-sample-t-test" id="toc-two-sample-t-test" class="nav-link" data-scroll-target="#two-sample-t-test">Two sample t-test</a></li>
  <li><a href="#paired-sample-t-test" id="toc-paired-sample-t-test" class="nav-link" data-scroll-target="#paired-sample-t-test">Paired sample t-test</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">3B: Practical Inference</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="lo">
<p>This reading:</p>
<ul>
<li>How does hypothesis testing work in practice?<br>
</li>
<li>How do we do all this in R?
<ul>
<li><em>spoiler: it’s easier than you think</em></li>
</ul></li>
<li>What are some basic hypothesis tests that we can conduct?</li>
</ul>
</div>
<p>In the previous section we saw how we can apply the logic of <em>Null Hypothesis Significance Testing</em> (NHST), allowing us to draw inferences about parameters in the <strong>population</strong>, based on statistics computed on the <strong>sample</strong> we have collected.</p>
<div class="statbox">
<p><strong>NHST</strong></p>
<p>We have a sample (<span class="math inline">\(n=10\)</span>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And a sample mean:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mysample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.9</code></pre>
</div>
</div>
<p>We want to test this against the null hypothesis that the mean in the population is actually 0.</p>
<p>Remember, there are lots of samples of size <span class="math inline">\(n=10\)</span> that we <em>could</em> take, and they all have different means. To quantify the spread of these different means we can use the <strong>standard error</strong>, calculated using <span class="math inline">\(SE = \frac{\sigma}{\sqrt{n}}\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(mysample) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(mysample))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.394035</code></pre>
</div>
</div>
<p>We can use this information to express how far away from the null hypothesis (mean = 0) our observed sample is, in terms of standard errors:</p>
<p><span class="math display">\[
Z \ = \ \frac{\text{estimate}-\text{null}}{SE} \ = \ \frac{1.9 - 0}{1.39} \ = \ 1.36
\]</span></p>
<p>We then ask, <strong>if</strong> the mean in the population <em>is</em> 0, what is the probability of obtaining a <span class="math inline">\(Z\)</span>-statistic from a sample of this size at least as extreme as the one we <em>have</em> observed?</p>
<p>The resulting probability is our <strong>p-value:</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="fl">1.36</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1738299</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pnorm23" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03b_inference2_files/figure-html/fig-pnorm23-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure 1: 2*pnorm gives the two tails</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>As our <span class="math inline">\(p\)</span>-value is above our threshold of <span class="math inline">\(\alpha=.05\)</span>, we fail to reject the null hypothesis that the mean in the population is zero.</p>
<p>We can get to the same conclusion by constructing a 95% confidence interval:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">=</span> <span class="fu">mean</span>(mysample)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>se <span class="ot">=</span> <span class="fu">sd</span>(mysample) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(mysample))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(xbar <span class="sc">-</span> (<span class="fl">1.96</span> <span class="sc">*</span> se), xbar <span class="sc">+</span> (<span class="fl">1.96</span> <span class="sc">*</span> se))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8323084  4.6323084</code></pre>
</div>
</div>
<p>As this interval includes zero, then at the 5% level we fail to reject the null hypothesis that the population mean is zero.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</div>
<p>While in practice NHST follows the logic described above, there is something important that we have been sweeping under the carpet.</p>
<p>In our estimation of the <strong>standard error</strong> we have used the formula that includes <span class="math inline">\(\sigma\)</span>, which refers to the <strong>population</strong> standard deviation. However, we never know this value (because we don’t have data for the population), so we have been using the <strong>sample</strong> standard deviation <span class="math inline">\(s\)</span> instead. This is an <em>approximation</em>, and might be okay when we have a very large <span class="math inline">\(n\)</span> (meaning <span class="math inline">\(s\)</span> provides accurate estimate of <span class="math inline">\(\sigma\)</span>), but in practice is not always feasible.</p>
<p><span class="math display">\[
SE = \frac{\sigma}{\sqrt{n}} \approx \frac{s}{\sqrt{n}}
\]</span></p>
<section id="t-distributions" class="level1">
<h1><span class="math inline">\(t\)</span>-distributions</h1>
<p>To resolve the issues with this approximation (using <span class="math inline">\(s\)</span> in place of <span class="math inline">\(\sigma\)</span>), instead of using the normal distribution, we tend to instead use the <span class="math inline">\(t\)</span>-distribution.<br>
The <span class="math inline">\(t\)</span> distribution is very similar to the normal distribution, but it has slightly <em>heavier</em> tails:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-tnorm" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03b_inference2_files/figure-html/fig-tnorm-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure 2: Normal distribution (black) vs t-distribution with 3 degrees of freedom (red)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><span class="math inline">\(t\)</span>-distributions are always centered on zero, and the precise shape (how heavy the tails are) depends upon a parameter known as the <strong>degrees of freedom.</strong></p>
<div class="sticky">
<p><strong>Degrees of Freedom - <span class="math inline">\(df\)</span></strong></p>
<p>‘Degrees of freedom’ is a tricky concept. One of the most intuitive ways to understand it is to think of it as the number of independent bits of information that go into calculating an estimate. Put another way, it is the number of datapoints that are <em>free to vary</em>.</p>
<div class="optional-begin">
<span id="opt-start-1" class="fa fa-hand-o-right optional-icon clickable" onclick="toggle_visibility('opt-body-1', 'opt-start-1')"> <span class="olab">Degrees of freedom (df)</span></span>
</div>
<div id="opt-body-1" class="optional-body" style="display: none;">
<p>Suppose we have four unknown numbers (<span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span>) which <em>must</em> have a mean of 5.</p>
<p>Do the following, <em>in order:</em></p>
<ol type="1">
<li>Choose a value for <span class="math inline">\(a\)</span>.</li>
<li>Choose a value for <span class="math inline">\(b\)</span>.</li>
<li>Choose a value for <span class="math inline">\(c\)</span>.</li>
<li>Can you choose a value for <span class="math inline">\(d\)</span> while ensuring the mean of the four numbers you have chosen is 5?</li>
</ol>
<p>You are free to choose anything you like for <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span>.<br>
But once those are fixed, you have no freedom to choose <span class="math inline">\(d\)</span>.</p>
<p>Example:</p>
<ul>
<li><span class="math inline">\(a\)</span> = 1<br>
</li>
<li><span class="math inline">\(b\)</span> = 2<br>
</li>
<li><span class="math inline">\(c\)</span> = 3</li>
</ul>
<p>We know that <span class="math inline">\(\frac{1+2+3+d}{4} = 5\)</span> So there is only one possible value for <span class="math inline">\(d\)</span>:<br>
<span class="math inline">\(\frac{1+2+3+d}{4} = 5\)</span><br>
<span class="math inline">\(1+2+3+d = 5*4\)</span><br>
<span class="math inline">\(1+2+3+d = 20\)</span><br>
<span class="math inline">\(d = 20-3-2-1\)</span><br>
<span class="math inline">\(d = 14\)</span></p>
</div>
<p class="optional-end">
</p>
</div>
<p>When we estimate the mean from a sample, we use up one of our degrees of freedom, and so our test of a single mean will require us to use a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-1\)</span> degrees of freedom. For <span class="math inline">\(t\)</span>-distributions, as the <span class="math inline">\(df\)</span> increases the distribution becomes closer and closer to a normal distribution (see <a href="#fig-tdf">Figure&nbsp;3</a>) - the use of these <span class="math inline">\(t\)</span>-distributions is exactly what we need to account for using <span class="math inline">\(s\)</span> in our calculation of the standard error.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-tdf" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03b_inference2_files/figure-html/fig-tdf-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure 3: t distributions with various degrees of freedom.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In order to utilise the <span class="math inline">\(t\)</span>-distribution in hypothesis testing, we need to move to performing <span class="math inline">\(t\)</span>-tests!</p>
<p>The logic remains the same as before, but where we previously were relying on the normal distribution:</p>
<ul>
<li><code>pnorm()</code> for our <span class="math inline">\(p\)</span>-values</li>
<li><code>qnorm()</code> in order to calculate our confidence intervals (<code>qnorm(0.975)</code> gives the 1.96 we have been using)</li>
</ul>
<p>We can use <code>pt()</code> and <code>qt()</code> to conduct the same process but in reference to the appropriate <span class="math inline">\(t\)</span>-distribution.</p>
<div class="statbox">
<p><strong>Demonstration: t-test for a single mean</strong></p>
<p>Recalling our sample, we’ll now perform the appropriate test against the null hypothesis that the mean in the population is zero.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we move to using <span class="math inline">\(t\)</span>-distributions, our test-statistic is going to be a <span class="math inline">\(t\)</span>-statistic:</p>
<p><span class="math display">\[
\begin{align}
&amp; t =  \frac{\bar x - \mu_0}{\frac{s}{\sqrt{n}}}\\
\ \\
&amp; \text{where:} \\
&amp; \bar x : \text{sample mean} \\
&amp; \mu_0 : \text{hypothesised population mean} \\
&amp; s : \text{sample standard deviation} \\
&amp; n : \text{sample size} \\
\end{align}
\]</span></p>
<p>Which can be calculated as:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">=</span> <span class="fu">mean</span>(mysample)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>se <span class="ot">=</span> <span class="fu">sd</span>(mysample) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(mysample))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>tstat <span class="ot">=</span> (xbar <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">/</span> se</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>tstat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.36295</code></pre>
</div>
</div>
<p>Because we have <span class="math inline">\(n=10\)</span>, and we are estimating a sample mean, we are going to be referring to a <span class="math inline">\(t\)</span>-distribution with 9 (<span class="math inline">\(10-1\)</span>) degrees of freedom (we lose one by calculating the mean).</p>
<p>Our p-value can be found with the <code>pt()</code> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(tstat, <span class="at">df =</span> <span class="dv">9</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2060213</code></pre>
</div>
</div>
<p>And our confidence interval can be constructed using:</p>
<p><span class="math display">\[
\text{95% CI} = \bar{x} \pm t^* \times SE \\
\]</span></p>
<p>Note that <span class="math inline">\(t^*\)</span> has replaced the 1.96 we saw in previous chapters, because we obtained that using the normal distribution. The code <code>qnorm(c(0.025, 0.975))</code> shows us that 95% of <strong>normal</strong> distribution is beyond 1.96 from the mean. But what we actually want to know is where 95% of the <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(df=9\)</span> lies:<br>
So instead we can use:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">df =</span> <span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.262157  2.262157</code></pre>
</div>
</div>
<p>And our confidence interval is:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">=</span> <span class="fu">mean</span>(mysample)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>se <span class="ot">=</span> <span class="fu">sd</span>(mysample) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(mysample))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(xbar <span class="sc">-</span> (<span class="fl">2.262</span> <span class="sc">*</span> se), xbar <span class="sc">+</span> (<span class="fl">2.262</span> <span class="sc">*</span> se))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.253307  5.053307</code></pre>
</div>
</div>
</div>
</section>
<section id="r-making-things-easier" class="level1">
<h1>R: Making things easier</h1>
<p>All of the above is crucial for understanding how this all works, but in practice we can avoid all of the rigmarole of ever calculating the standard error or using functions like <code>pt()</code>, <code>qt()</code>. This is where R starts to become far more powerful - there are functions that do all this sort of stuff for us - in just <em>one single line of code!</em></p>
<p>Take a look at the output of the function below. I have given it the sample, and specified that we want it to test against the null hypothesis that <span class="math inline">\(\mu=0\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(mysample, <span class="at">mu =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  mysample
t = 1.363, df = 9, p-value = 0.206
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -1.253526  5.053526
sample estimates:
mean of x 
      1.9 </code></pre>
</div>
</div>
<p>The <code>t.test()</code> function here gives us the <span class="math inline">\(t\)</span>-statistic, the <span class="math inline">\(df\)</span>, the <span class="math inline">\(p\)</span>-value, the 95% CI, the mean <span class="math inline">\(\bar x\)</span>, and it even tells us the alternative hypothesis (that the true mean is <span class="math inline">\(\neq 0\)</span>).</p>
<p>All of these numbers will match those that we calculated above (there may be a small bit of rounding error).</p>
<p>It’s <strong>that</strong> easy!</p>
<section id="checkingtesting-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="checkingtesting-assumptions">Checking/Testing Assumptions</h2>
<p>These sort of tests often require us to meet a set of conditions in order for our inferences to be valid. When we perform tests like these that involve estimating a mean, a common requirement is that the deviations from that mean are close to normally distributed.</p>
<div class="frame">
<p><strong>Assumption Plots</strong></p>
<p>We can evaluate how close to normal a distribution is by visualising it via histograms and density plots and making a judgment call, but this can sometimes be hard:</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">mysample =</span> mysample)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data,<span class="fu">aes</span>(<span class="at">x=</span>mysample))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data,<span class="fu">aes</span>(<span class="at">x=</span>mysample))<span class="sc">+</span><span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-normalquestion" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03b_inference2_files/figure-html/fig-normalquestion-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure 4: Am I normal?</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Another useful visualisation tool is the <strong>QQplot</strong>. The closer to the diagonal line, the closer our data is to being normally distributed:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data<span class="sc">$</span>mysample) <span class="co"># make the plot</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data<span class="sc">$</span>mysample) <span class="co"># add the line</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-normalqq" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03b_inference2_files/figure-html/fig-normalqq-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure 5: A QQplot</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="optional-begin">
<span id="opt-start-2" class="fa fa-hand-o-right optional-icon clickable" onclick="toggle_visibility('opt-body-2', 'opt-start-2')"> <span class="olab">Optional: What are the ‘theoretical quantiles’?</span></span>
</div>
<div id="opt-body-2" class="optional-body" style="display: none;">
<p>The theoretical quantiles are the equivalent quantiles of the <em>standard normal distribution</em> (see <a href="02b_sampling.html#the-standard-normal-distribution" target="_blank">#2B standard-normal-distribution</a>).<br>
In the <code>data$mysample</code> example above, we have 10 datapoints. If we cut the standard normal distribution into 10 sections of equal area (see <a href="#fig-qqnormcurve">Figure&nbsp;6</a>), it is the points on the x-axis at the center of each area that we are plotting our data against.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-qqnormcurve" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03b_inference2_files/figure-html/fig-qqnormcurve-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure 6: 10 quantiles of the normal distribution</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
</div>
<div class="frame">
<p><strong>Assumption Tests</strong></p>
<p>There are also, if we wish to make use of them, specific hypothesis tests that assess normality, such as the ‘Shapiro-Wilks’ Test. The null hypothesis for this test is that the data we give it are drawn from a normal distribution. This means that <strong>we want a p-value <em>greater</em> than .05</strong>. So in the example below, we have no reason to reject the hypothesis that our data are drawn from a normal distribution. This means we can continue to conduct a t-test.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(mysample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  mysample
W = 0.94722, p-value = 0.6358</code></pre>
</div>
</div>
</div>
<div class="divider div-transparent div-dot">

</div>
</section>
</section>
<section id="basic-tests" class="level1">
<h1>Basic Tests</h1>
<p>Now that we’ve gone through all the nitty-gritty bits of how hypothesis testing works, the heavy lifting is done.<br>
we’re going to start to look at some of the different basic hypothesis tests that we can perform.</p>
<p>For each test below we show an example conducted the quick way (e.g.&nbsp;<code>t.test()</code> function), and also the manually computations (for those of you who are interested!). We’ve already seen the one sample <span class="math inline">\(t\)</span>-test in the example above, so you might want to skim over that section.</p>
<div class="imp">
<p><strong>something to bear in mind</strong></p>
<p>These tests are the simple hypothesis tests that were developed in the 19th and 20th centuries, and provide a good basis of understanding the <em>null hypothesis significance testing</em> framework.</p>
<p>In the latter half of this course, we move to focus on a modelling based approach for analysing data. We will start to see how many of these simple tests that we are learning now are actually special cases of a more general statistical model.</p>
</div>
<!-- For each test, we'll detail:   -->
<!-- - Purpose -->
<!-- - Hypotheses -->
<!-- - Test statistic -->
<!-- - P-value -->
<!-- - Assumptions -->
<!-- And then we will show an example conducted the quick way (e.g. `t.test()` function), and also the manually computations (for those of you who are interested!).   -->
<!-- We've already seen the one sample $t$-test in the example above, so you might want to skim over that section.   -->
<section id="one-sample-t-test" class="level2">
<h2 class="anchored" data-anchor-id="one-sample-t-test">One sample t-test</h2>
<div class="statbox">
<p><strong>Purpose</strong></p>
<p>The one sample t-test is what we have already seen above. We use it to test whether the mean is different from/greater than/less than some hypothesised value.</p>
<ul>
<li><strong>Examples:</strong>
<ul>
<li>Is the mean age of USMR students different from 20?</li>
<li>Is the mean IQ different from 100?<br>
</li>
<li>Do people read more than 250 words per minute?</li>
</ul></li>
</ul>
<p><strong>Assumptions:</strong></p>
<ul>
<li>The data are continuous (not discrete)</li>
<li>The data are independent (i.e.&nbsp;the value of a datapoint does not depend on the value of another datapoint in any way)</li>
<li>The data are normally distributed <em>OR</em> the sample size is large enough (rule-of-thumb n = 30) and the data are not strongly skewed</li>
</ul>
</div>
<!-- :::statbox -->
<!-- __Hypotheses__  -->
<!-- Our hypotheses will take one of the combinations below, depending on if we want to perform the test of whether the mean $\mu$ is less than/different from/greater than some hypothesised value $\mu_0$.   -->
<!-- | Null Hypothesis   | Alternative Hypothesis | -->
<!-- | ----------- | ----------- | -->
<!-- | $H_0: \mu = \ \mu_0$  | $H_1: \mu \neq \ \mu_0$ | -->
<!-- | $H_0: \mu \leq \ \mu_0$  | $H_1: \mu > \ \mu_0$ | -->
<!-- | $H_0: \mu \geq \ \mu_0$  | $H_1: \mu < \ \mu_0$ | -->
<!-- ::: -->
<!-- :::statbox -->
<!-- __Test-statistic__  -->
<!-- $$ -->
<!-- \begin{align} -->
<!-- & t =  \frac{\bar x - \mu_0}{\frac{s}{\sqrt{n}}}\\ -->
<!-- \ \\ -->
<!-- & \text{where:} \\  -->
<!-- & \bar x : \text{sample mean} \\ -->
<!-- & \mu_0 : \text{hypothesised population mean} \\ -->
<!-- & s : \text{sample standard deviation} \\ -->
<!-- & n : \text{sample size} \\ -->
<!-- \end{align} -->
<!-- $$ -->
<!-- ::: -->
<!-- :::statbox -->
<!-- __P-value:__  -->
<!-- Our $p$-value will be computed from the $t$-distribution with $n-1$ degrees of freedom.   -->
<!-- If the alternative hypothesis is $H_1: \mu \neq \mu_0$, then we are asking about the probability of a test statistic at least as extreme _in either direction._   -->
<!-- So we would use:   -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- # abs() takes the absolute value, ensuring we get the smaller tail -->
<!-- 2 * pt(abs(tstatistic), df = n-1, lower.tail = FALSE) -->
<!-- ``` -->
<!-- If $H_1: \mu > \mu_0$, then this would be  -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- pt(tstatistic, df = n-1, lower.tail = FALSE) -->
<!-- ``` -->
<!-- And if $H_1: \mu < \mu_0$:   -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- pt(tstatistic, df = n-1, lower.tail = TRUE) -->
<!-- ``` -->
<!-- ::: -->
<!-- :::statbox -->
<!-- __Assumptions:__  -->
<!-- - The data are continuous (not discrete) -->
<!-- - The data are independent (i.e. the value of a datapoint does not depend on the value of another datapoint in any way) -->
<!-- - The data are normally distributed _OR_ the sample size is large enough (rule-of-thumb n = 30) and the data are not strongly skewed -->
<!-- ::: -->
<div class="cell" data-layout-align="center">

</div>
<div class="frame">
<blockquote class="blockquote">
<p><strong>Research Question:</strong> Do people read more than 250 words per minute?</p>
</blockquote>
<p>Fifty participants were recruited and tasked with reading a passage of text that was 2000 words long. Their reading times (in words per minute) was recorded, and these are accessible at <a href="https://uoepsy.github.io/data/usmr_tread.csv">https://uoepsy.github.io/data/usmr_tread.csv</a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>wpmtime <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/usmr_tread.csv"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wpmtime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  id      wpm
  &lt;chr&gt; &lt;dbl&gt;
1 ppt_1   307
2 ppt_2   265
3 ppt_3   205
4 ppt_4   300
5 ppt_5   207
6 ppt_6   300</code></pre>
</div>
</div>
</div>
<div class="optional-begin">
<span id="opt-start-3" class="fa fa-hand-o-right optional-icon clickable" onclick="toggle_visibility('opt-body-3', 'opt-start-3')"> <span class="olab">The quick and easy way</span></span>
</div>
<div id="opt-body-3" class="optional-body" style="display: none;">
<p>Below are some quick descriptives, and we should also make sure that our distribution is roughly normally distributed:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(wpmtime<span class="sc">$</span>wpm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 258.36</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(wpmtime<span class="sc">$</span>wpm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32.08646</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(wpmtime<span class="sc">$</span>wpm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03b_inference2_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(wpmtime<span class="sc">$</span>wpm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  wpmtime$wpm
W = 0.9636, p-value = 0.1258</code></pre>
</div>
</div>
<p>Paying careful attention to the research question (“Do people read more than 250 words per minute?”), our null hypothesis here is that reading time is <span class="math inline">\(\leq 250\)</span> words per minute (wpm), and our alternative hypothesis is that it is <span class="math inline">\(&gt;250\)</span> wpm.</p>
<p>We specify the alternative in the <code>t.test()</code> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(wpmtime<span class="sc">$</span>wpm, <span class="at">mu =</span> <span class="dv">250</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  wpmtime$wpm
t = 1.8423, df = 49, p-value = 0.03574
alternative hypothesis: true mean is greater than 250
95 percent confidence interval:
 250.7523      Inf
sample estimates:
mean of x 
   258.36 </code></pre>
</div>
</div>
<div class="int">
<p>A one-sample t-test was conducted in order to determine if the average reading time was significantly (<span class="math inline">\(\alpha=.05\)</span>) higher than 250 words per minute (wpm).<br>
The sample of 50 participants read on average at 258 words per minute (Mean=258, SD=32). This was significantly above 250 (<span class="math inline">\(t(49)=1.84, p = .036\)</span>, one-tailed).</p>
</div>
</div>
<p class="optional-end">
</p>
<div class="optional-begin">
<span id="opt-start-4" class="fa fa-hand-o-right optional-icon clickable" onclick="toggle_visibility('opt-body-4', 'opt-start-4')"> <span class="olab">Manually</span></span>
</div>
<div id="opt-body-4" class="optional-body" style="display: none;">
<p>Our test-statistic is calculated as</p>
<p><span class="math display">\[
t =  \frac{\bar x - \mu_0}{\frac{s}{\sqrt{n}}}
\]</span></p>
<p>There’s a lot of brackets here, so go through it piece by piece if you are unsure of how it matches to the formula above</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mean</span>(wpmtime<span class="sc">$</span>wpm) <span class="sc">-</span> <span class="dv">250</span> ) <span class="sc">/</span> (<span class="fu">sd</span>(wpmtime<span class="sc">$</span>wpm) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">nrow</span>(wpmtime)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.842338</code></pre>
</div>
</div>
<p>The test we are performing is against the null hypothesis that <span class="math inline">\(\mu_0 \leq 250\)</span>. So we will only reject the null hypothesis if we get a test statistic indicating the mean is <span class="math inline">\(&gt;250\)</span>. This means that our p-value will be just the one tail of the <span class="math inline">\(t\)</span>-distribution:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(<span class="fl">1.842338</span>, <span class="at">df =</span> <span class="dv">49</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0357404</code></pre>
</div>
</div>
</div>
<p class="optional-end">
</p>
</section>
<section id="two-sample-t-test" class="level2">
<h2 class="anchored" data-anchor-id="two-sample-t-test">Two sample t-test</h2>
<div class="statbox">
<p><strong>Purpose</strong><br>
The two sample t-test is used to test whether the mean of one group is different from/greater than/less than the mean of another.</p>
<ul>
<li><strong>Examples:</strong>
<ul>
<li>Is the mean age of cat people different from the mean age of dog people?</li>
<li>Do people who identify as “morning people” have a higher average rating of sleep quality than those who identify as “evening people”?</li>
<li>Is the average reaction time different between people who do and don’t drink caffeinated drinks?</li>
</ul></li>
</ul>
<p><strong>Assumptions:</strong></p>
<ul>
<li>The data are continuous (not discrete)</li>
<li>The data are independent (i.e.&nbsp;the value of a datapoint does not depend on the value of another datapoint in any way)</li>
<li>The data are normally distributed <em>for each group</em>, OR the sample size is large enough (rule-of-thumb n = 30) and the data are not strongly skewed</li>
<li>The variance is equal across groups*.</li>
</ul>
<p>*We can relax this assumption by using an adjusted test called the “Welch <span class="math inline">\(t\)</span>-test”, which calculates the standard error slightly differently, and estimates the degrees of freedom differently too. This is actually the default in R, and we change this easily in R using <code>t.test(...., var.equal = FALSE/TRUE)</code></p>
</div>
<!-- :::statbox -->
<!-- __Hypotheses:__    -->
<!-- Our hypotheses can be stated in terms of 2 population means, $\mu_1$ and $\mu_2$, representing the mean of each group.  -->
<!-- The null hypothesis is typically that the difference between the two means is zero:   -->
<!-- $H_0: \mu_1 - \mu_2 = 0$  -->
<!-- And our alternative hypothesis again can take on the following forms:     -->
<!-- $H_1: \mu_1 - \mu_2 \neq 0$   -->
<!-- $H_1: \mu_1 - \mu_2 > 0$   -->
<!-- $H_1: \mu_1 - \mu_2 < 0$   -->
<!-- ::: -->
<div class="cell" data-layout-align="center">

</div>
<div class="frame">
<blockquote class="blockquote">
<p><strong>Research Question:</strong> Is the average reaction time different between people who do and don’t drink caffeinated drinks?</p>
</blockquote>
<p>One hundred participants were recruited and completed a simple reaction time task. They were also surveyed on whether they regularly drank caffeine in any form. The data are accessible at <a href="https://uoepsy.github.io/data/usmr_tcaff.csv">https://uoepsy.github.io/data/usmr_tcaff.csv</a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>tcaff <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/usmr_tcaff.csv"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tcaff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
     rt caff 
  &lt;dbl&gt; &lt;chr&gt;
1  482. yes  
2  389. yes  
3  484. no   
4  601. no   
5  409. yes  
6  368. no   </code></pre>
</div>
</div>
</div>
<div class="optional-begin">
<span id="opt-start-5" class="fa fa-hand-o-right optional-icon clickable" onclick="toggle_visibility('opt-body-5', 'opt-start-5')"> <span class="olab">The quick and easy way</span></span>
</div>
<div id="opt-body-5" class="optional-body" style="display: none;">
<p>First some quick descriptives, and a plot:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>tcaff <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(caff) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">m =</span> <span class="fu">mean</span>(rt),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">s =</span> <span class="fu">sd</span>(rt)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  caff      m     s
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
1 no     408.  88.9
2 yes    465. 109. </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tcaff, <span class="fu">aes</span>(<span class="at">x =</span> rt)) <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>caff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03b_inference2_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>The data look fairly close to normally distributed for each group here. One thing to note is that the variances look like they may be different between the two groups. The caffeine drinkers’ reaction time’s have a standard deviation of 109ms, and the non-caffeine drinkers have an sd of only 89ms.</p>
<p>However, we’ll perform the Welch t-test here, which doesn’t require us to assume equal variances.</p>
<p>We can give R the two sets of data in two ways. Either by extracting the relevant entries:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> tcaff<span class="sc">$</span>rt[tcaff<span class="sc">$</span>caff<span class="sc">==</span><span class="st">"no"</span>], </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> tcaff<span class="sc">$</span>rt[tcaff<span class="sc">$</span>caff<span class="sc">==</span><span class="st">"yes"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Or using the <strong>formula</strong> notation, with the <code>~</code> (“tilde”) symbol. In R, you can interpret <code>y ~ x</code> as “y is modeled as a function of x”. By splitting the numeric values (<code>rt</code> variable) by the categories of the <code>caff</code> variable, we can conduct a <span class="math inline">\(t\)</span>-test using:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(rt <span class="sc">~</span> caff, <span class="at">data =</span> tcaff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  rt by caff
t = -2.8497, df = 93.971, p-value = 0.005377
alternative hypothesis: true difference in means between group no and group yes is not equal to 0
95 percent confidence interval:
 -96.20205 -17.19423
sample estimates:
 mean in group no mean in group yes 
         408.0505          464.7486 </code></pre>
</div>
</div>
<div class="int">
<p>An Welch two sample t-test was used to assess whether the mean reaction time of people who regularly drink caffeine (<span class="math inline">\(n = 60\)</span>) was different to that of people who do not (<span class="math inline">\(n=40\)</span>). There was a significant difference in average reaction time between the caffeine (Mean=465; SD=109) and non-caffeine (Mean=408; SD=89) groups (<span class="math inline">\(t(94)=-2.85, p = .005\)</span>, two-tailed). Therefore, we reject the null hypothesis that there is no difference in reaction times between caffeine drinkers and non-caffeine drinkers.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tcaff, <span class="fu">aes</span>(<span class="at">x =</span> caff, <span class="at">y =</span> rt)) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"drinks caffeine"</span>,<span class="at">y=</span><span class="st">"reaction time (ms)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03b_inference2_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<div class="optional-begin">
<span id="opt-start-6" class="fa fa-hand-o-right optional-icon clickable" onclick="toggle_visibility('opt-body-6', 'opt-start-6')"> <span class="olab">Manually</span></span>
</div>
<div id="opt-body-6" class="optional-body" style="display: none;">
<p>Our test statistic here is:</p>
<p><span class="math display">\[
\begin{align}
&amp; t =  \frac{\bar x_1 - \bar x_2}{SE}\\
\ \\
&amp; \text{where:} \\
&amp; \bar x_1 : \text{sample mean group 1} \\
&amp; \bar x_2 : \text{sample mean group 2} \\
&amp; SE : \sqrt{\frac{s^2_1}{n_1} + \frac{s^2_2}{n_2}} \\
&amp; s_1 : \text{sample standard deviation of group 1} \\
&amp; s_2 : \text{sample standard deviation of group 2} \\
&amp; n_1 : \text{sample size group 1} \\
&amp; n_2 : \text{sample size group 2} \\
\end{align}
\]</span></p>
<p>We can calculate each part:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>tcaff <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(caff) <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xbar =</span> <span class="fu">mean</span>(rt),</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">s =</span> <span class="fu">sd</span>(rt),</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">s2 =</span> <span class="fu">var</span>(rt),</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  caff   xbar     s     s2     n
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;
1 no     408.  88.9  7906.    40
2 yes    465. 109.  11892.    60</code></pre>
</div>
</div>
<p>plugging these bits in gives us:</p>
<p><span class="math display">\[
\begin{align}
SE &amp; = \sqrt{\frac{s^2_1}{n_1} + \frac{s^2_2}{n_2}} \\
&amp; = \sqrt{\frac{7906}{40} + \frac{11892}{60}} \\
&amp; = \sqrt{395.85} \\
&amp; = 19.9
\end{align}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\begin{align}
&amp; t =  \frac{\bar x_1 - \bar x_2}{SE} \\
\qquad \\
&amp; =  \frac{408 - 465}{19.9} \\
\qquad \\
&amp; = -2.86 \\
\end{align}
\]</span></p>
<p>Our <span class="math inline">\(p\)</span>-value is determined against a <span class="math inline">\(t\)</span>-distribution with a specific number of degrees of freedom. We are estimating two means here, the standard two-sample t-test uses <span class="math inline">\(df = n-2\)</span>. However, the Welch t-test, which we performed quickly with <code>t.test()</code>, where we didn’t assume equal variances, makes the calculation of the degrees of freedom much more complicated.</p>
<p>Using the same degrees of freedom as was used in the quick use of <code>t.test()</code> above, we get out our same p-value (or thereabouts - we have some rounding error):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="fu">abs</span>(<span class="sc">-</span><span class="fl">2.86</span>), <span class="at">df =</span> <span class="fl">93.971</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.005219781</code></pre>
</div>
</div>
</div>
<p class="optional-end">
</p>
</section>
<section id="paired-sample-t-test" class="level2">
<h2 class="anchored" data-anchor-id="paired-sample-t-test">Paired sample t-test</h2>
<div class="statbox">
<p><strong>Purpose</strong></p>
<p>The paired sample t-test is used to test whether the mean difference between two sets of <em>paired</em> observations is different from 0.</p>
<ul>
<li><strong>Examples:</strong>
<ul>
<li>Is the mean cognitive score of participants at age 60 different from when they are re-tested at age 70?<br>
</li>
<li>Are scores on test 1 different on average from scores on test 2 (with participants completing both tests).</li>
</ul></li>
</ul>
<p><strong>Assumptions:</strong></p>
<ul>
<li>The data are continuous (not discrete)</li>
<li>The <em>differences</em> are independent (i.e.&nbsp;the value of a the difference for one pair does not depend on the values of another pair in any way)</li>
<li>The <em>differences</em> are normally distributed <em>OR</em> the sample size is large enough (rule-of-thumb n = 30) and the data are not strongly skewed</li>
</ul>
</div>
<div class="frame">
<blockquote class="blockquote">
<p><strong>Research Question:</strong> Is the mean cognitive score of participants at age 60 different from when they are re-tested at age 70?</p>
</blockquote>
<p>Addenbrooke’s Cognitive Examination-III (ACE-III) is a brief cognitive test that assesses five cognitive domains: attention, memory, verbal fluency, language and visuospatial abilities. The total score is 100 with higher scores indicating better cognitive functioning. A research project is examining changes in cognitive functioning with age, and administers the ACE-III to a set of participants at age 60, then again at age 70. The data is accessible at <a href="https://uoepsy.github.io/data/usmr_tcaff.csv">https://uoepsy.github.io/data/usmr_tcaff.csv</a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>acedata <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/acedata.csv"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(acedata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  participant ace_60 ace_70
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
1 sub1            93     85
2 sub2            95     92
3 sub3            93     90
4 sub4            93     95
5 sub5            96     88
6 sub6            91     85</code></pre>
</div>
</div>
</div>
<div class="optional-begin">
<span id="opt-start-7" class="fa fa-hand-o-right optional-icon clickable" onclick="toggle_visibility('opt-body-7', 'opt-start-7')"> <span class="olab">The paired t test is the one sample t test in disguise</span></span>
</div>
<div id="opt-body-7" class="optional-body" style="display: none;">
<p>We can either perform this with the data exactly as it is:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> acedata<span class="sc">$</span>ace_60, <span class="at">y =</span> acedata<span class="sc">$</span>ace_70, </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  acedata$ace_60 and acedata$ace_70
t = 2.2542, df = 24, p-value = 0.03359
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 0.2093364 4.7506636
sample estimates:
mean difference 
           2.48 </code></pre>
</div>
</div>
<p>Or we can compute the differences, and perform a one sample test on the mean of those differences being different from 0.<br>
It’s just the same result:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>acedata <span class="ot">&lt;-</span> acedata <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff_score =</span> ace_60 <span class="sc">-</span> ace_70)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(acedata<span class="sc">$</span>diff_score, <span class="at">mu =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  acedata$diff_score
t = 2.2542, df = 24, p-value = 0.03359
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 0.2093364 4.7506636
sample estimates:
mean of x 
     2.48 </code></pre>
</div>
</div>
</div>
<p class="optional-end">
</p>


</section>
</section>


<div id="quarto-appendix" class="default"><section class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1" role="doc-endnote"><p>Remember that confidence intervals provide a range of plausible values for the population mean. In this case, zero is a plausible value.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>