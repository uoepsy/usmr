---
title: "USMR 2021-2022 Coursework"
author: "`r params$examnumber`"
date: "`r Sys.Date()`"
output:
  html_document: default
  word_document: default
  pdf_document: default
params:
  examnumber: "B201797"
editor_options: 
  chunk_output_type: inline
---

<!-- We have provided a template below with headings/sub-headings for each question/sub-question. This is just a template. Feel free to add or delete code-chunks if desired.  -->
<!-- Beneath here is some code which will set everything up for you.  Anything that is needed to run your code should be explicitly set up below -->

```{r setup, include=FALSE}
# this line will mean that when you compile/knit your document, 
# the code will not show, but the output (e.g., plots) will!
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
# this line means all numeric output gets rounded to 3 dp
options(digits=3)
# load any other packages that you require here:
library(tidyverse)
library(pander)
library(broom)
library(gridExtra)
library(grid)
library(lattice)
library(ggpubr)
#reset environment
rm(list = ls())
# This will read in your own personal data:
source("https://uoepsy.github.io/data/usmr_2122_data.R")
```

# Question 0


```{r cleaning, include = FALSE}
# Neither output nor code from this chunk will be shown in the compiled document. 
summary(couchto5k)
head(couchto5k)


#identifying impossible data
couchto5k$missing <- NA
couchto5k$missing[couchto5k$selfmot < 5] <- "Impossible self motivation score"
couchto5k$missing[couchto5k$age >= 100] <- "Very high age"
couchto5k$missing[couchto5k$week_stopped > 9] <- "Impossible week"
miss <- table(couchto5k$missing) #Add col.names?


#Remove extreme values
couchto5k <- 
  couchto5k %>%
  filter(is.na(missing))
total <- count(couchto5k)


#Change Spelling mistakes
miscoded <- sum(couchto5k$season=='autunm')
couchto5k$season[couchto5k$season=="autunm"] <- "autumn"
couchto5k$season <- as.factor(couchto5k$season)
```

```{r table of removed values}

miss %>% pander(caption="Table 1: Summary of missing values")

```

Extreme and impossible values were removed from the data. Specifically, age values over 100 were removed as it is unlikely participants of this age would be attempting a couch to 5k. Self-motivation values below 0 were also removed, as it is impossible for participants to score below 0. Likewise, values over 9 for week stopped were removed, as the maximum number of weeks was 9, for the program. 
`r miscoded` Autumn entries were initially mis-entered as "Autunm".  These were recoded as "Autumn". Table 1 gives a summary of the removed data. `r total` observations remained.

```{r descriptives}
# Code will not be shown from this chunk (because we set echo = FALSE in the very first chunk)
# the output from this code will be shown. 

a <- ggplot(couchto5k, aes(x = age)) + 
  geom_histogram(aes(y=..density..), colour="black", fill="white", bins=20) + 
  geom_density(alpha=.2, fill="#FF6666") + 
  geom_vline(xintercept=mean(couchto5k$age), linetype="dashed", color="black", size=.5) + 
  labs(x = "Age (in years)", title = "Age") +theme_bw()

b <- ggplot(couchto5k, aes(x=accountability)) + 
  geom_histogram(aes(y=..density..), colour="black", fill="white") + geom_density(alpha=.2, fill="#FF6666") + 
  geom_vline(xintercept=mean(couchto5k$accountability), linetype="dashed", color="black", size=.5) +
  labs(x = "Accountability", title = "Accountability")

c <- ggplot(couchto5k, aes(x = selfmot)) + 
  geom_histogram(aes(y=..density..), colour="black", fill="white", bins=20) + 
  geom_density(alpha=.2, fill="#FF6666") + 
  geom_vline(xintercept=mean(couchto5k$selfmot), linetype="dashed", color="black", size=.5) + 
  labs(x = "Self-motivation rating", title = "Self-motivation") + 
  theme_bw()

 
d <- ggplot(couchto5k, aes(x = health)) + 
  geom_histogram(aes(y=..density..), colour="black", fill="white", bins=20) + 
  geom_density(alpha=.2, fill="#FF6666") +
  geom_vline(xintercept=mean(couchto5k$accountability), linetype="dashed", color="black", size=.5) + 
  labs(x = "Health", title = "Health") + 
  theme_bw()

e <- ggplot(couchto5k, aes(x = happiness)) + 
  geom_histogram(aes(y=..density..), colour="black", fill="white", bins=20) + 
  geom_density(alpha=.2, fill="#FF6666") + 
  geom_vline(xintercept=mean(couchto5k$happiness), linetype="dashed", color="black", size=.5) + 
  labs(x = "Happiness", title = "Happiness") + 
  theme_bw()

 
f <- ggplot(couchto5k, aes(x = season)) + 
  geom_bar(fill = "#2A90AA", alpha=.4, colour="black") + 
  labs(x = "Season", y = "Frequency", title = "Season") + 
  theme_bw()

 g <- ggplot(couchto5k, aes(x = city)) + 
  geom_bar(fill = "#2A90AA", alpha=.4, colour="black") +
  labs(x = "city", y = "Frequency", title = "city") + 
  theme_bw()

h <- ggplot(couchto5k, aes(x=week_stopped)) + geom_bar(fill="#FF6666", alpha=.6, color= "black") + 
  scale_x_continuous(breaks = c(1:9)) + 
  labs(x = "Week Stopped", y = "Frequency", title = "Week Stopped") + 
  theme_bw()

```

```{r figure 1, fig.asp = 1, fig.width=12, fig.cap= "Figure 1: Overview of the dataset. Variables visualized from top left to bottom right: Age of participants, Accountability ratings, Self-motivation ratings, Health ratings, Happiness ratings, Season that the participant attempted the program in, City in which the program was undertaken, The week the participants quit the program (week 9 indicates completion of the program)", message=FALSE}

#Put in 3 x 3 grid
graphs <- grid.arrange(a, b, c, d, e, f ,g , h, ncol = 3, nrow = 3)

```

Figure 1 visualizes each of the variables that will be investigated. It is important to note that there are far more participants from Edinburgh than Glasgow, and that far more people completed the challenge, than stopped at each individual week. Accountability, Self-Motivation and Health appear to be roughly normally distributed, and have central means from appearance. Happiness has high extreme values, but has a mean of roughly 50. There appear to have been more program attempts in the Spring and Summer compared to Autumn and Winter.


# Question 1 

## Question 1a

```{r q1a}
#New column
couchto5k <- 
  couchto5k %>%
  mutate(
    attrition_time = ifelse(week_stopped<5, "before halfway", NA),
    attrition_time = ifelse(week_stopped==9, "completed", attrition_time),
    attrition_time = ifelse(week_stopped>=5 & week_stopped<9, "between halfway and completion", attrition_time)
  ) 

#Perform chi-squared test
chisq_1 <- chisq.test(prop.table(table(couchto5k$attrition_time)), p=c(.1, .45,.45))
chisq_1_tidy <- tidy(chisq_1)

```

```{r figure 2, fig.asp=0.7, fig.cap="Figure 2: Frequency of attrition during the program. The majority of participants either quit before halfway or completed the whole program."}

#Visualize data
ggplot(couchto5k, aes(x=attrition_time)) + 
  geom_bar(fill = "#2A90AA", alpha=.4, colour="black") +
  labs(x = "Attrition Time", y = "Frequency", title = "Frequency of Attrition") + 
  theme_bw()
```

A new variable, Attrition Time, was created by splitting participants into three groups based on when they had stopped: Before week 5, between week 5 and week 9, and completing all 9 weeks. The frequency of participants in each group can be visualized in Figure 2.

A Chi squared test of independence shows no statistical difference between this data set and one from an earlier nationwide survey ($X^2$(`r chisq_1_tidy$parameter[1]`, N = `r total`) = `r chisq_1_tidy$statistic[1]`, p = `r chisq_1_tidy$p.value[1]`).

## Question 1b

```{r q1b, warning=FALSE}
attrition_table <- couchto5k %>%
  select(attrition_time, city) %>% table()

chisq_2 <- chisq.test(attrition_table)
chisq_2_tidy <- tidy(chisq_2)

#large p value due to small sample in Glasgow
```

```{r figure 3, fig.asp=0.7, fig.cap="Figure 3: Frequency of attrition time by city. No difference was found in attrition rates between participants from Edinburgh and Glasgow."}

ggplot(couchto5k, aes(x = attrition_time, fill = city)) +
  geom_bar(position = "dodge") + theme_bw() +
  labs(x = "Attrition Time", y = "Frequency", title = "Attrition Time by City")

```

Following the divide of attrition rates by city (as shown by Figure 3), a chi-squared test between Edinburgh and Glasgow was undertaken. There was no difference in attrition rates between the groups ($X^2$(`r chisq_2_tidy$parameter[1]`, N = `r total`) = `r chisq_2_tidy$statistic[1]`, p = `r chisq_2_tidy$p.value[1]`).


## Question 1c

```{r Figure 4, fig.asp=0.7, fig.cap="Figure 4: Boxplot showing the ages of the participants in Edinburgh and Glasgow. Comparing the median values of the boxplots, there is a difference in ages between Edinburgh and Glasgow."}
#Visualize plot
ggplot(couchto5k, aes(x=city, y=age)) +
geom_boxplot(fill= "turquoise3") + theme_bw() +
  labs(x = "City", y = "Age", title = "Age differences by City")
```

```{r q1c}
#Check for normality
Edinburgh_test <- with(couchto5k, shapiro.test(age[city == "Edinburgh"]))
Glasgow_test <- with(couchto5k, shapiro.test(age[city == "Glasgow"]))
glasgow_test_tidy <- tidy(Glasgow_test)
#Edinburgh not normally distributed. Must compute Mann-Whitney

#Visualize lack of normality
city_edinburgh <- 
  couchto5k %>%
  filter(city == "Edinburgh")

variance_test <- var.test(age ~ city, data = couchto5k)
#Variance is fine, but it doesn't matter because normality is violated

wilcox_1 <- wilcox.test(age ~ city, data = couchto5k)
wilcox_1_tidy <- tidy(wilcox_1)

```

```{r Figure 5, fig.asp=0.7, fig.cap="Figure 5:Graph showing the spread of ages of participants from Edinburgh. The density plot shows a violation in normality."}
ggplot(city_edinburgh, aes(x=age)) + geom_density() + theme_bw() +
  labs(x = "Age", y = "Density", title = "Age of Participants from Edinburgh")
```

Figure 4 indicates that there may be a potentiality of a difference between the medians of the ages of participants from Edinburgh and Glasgow. Normality tests were undertaken in the two groups, and there was a violation in normality in the sample from Edinburgh, which can be observed in Figure 5. Because of this, a two-sample Wilcoxon test was undertaken. There was a statistical difference in the ages between participants from Edinburgh and Glasgow (W = `r wilcox_1_tidy$statistic[1]`, p = `r wilcox_1_tidy$p.value[1]`).

# Question 2

## Question 2a
```{r Figure 6, fig.asp=0.7, fig.cap="Figure 6: Happiness ratings by season. Autumn shows the lowest median happiness, which explains why it was used as the intercept in the linear model."}
#Visualize data
ggplot(couchto5k, aes(x = season, y = happiness)) + 
  geom_boxplot(fill="turquoise3") + theme_bw() +
  labs(x = "Season", y = "Happiness", title = "Happiness Ratings by Season")
```

```{r q2a}
#Do residuals check
season_model <- lm(happiness ~ 1 + season, data = couchto5k)


season_model_anova <- anova(season_model)
season_model_aov <- tidy(anova(season_model))

```

```{r Figure 7, fig.asp=1, fig.cap="Figure 7: Diagnostic plots of the residuals of the linear model where happiness is predicted by season. Assumptions of the residuals appear to be met, although there may be a slight deviation from normality in the higher end of the Q-Q Plot, but nothing appears significant to warrant any further action."}
par(mfrow = c(2,2))
plot(season_model)
```

Before any analysis was undertaken, the data was first visualized. When examining the means of happiness within each season, one can observe that 'Autumn' has the lowest mean of happiness. The greatest difference of means appear to be between Autumn and Spring, which is why Autumn was selected as the intercept for comparison in the linear model. 

Before using a linear model, several assumptions are required to be met, specifically for the residuals. Residuals must be normally distributed, homogeneous, and independent from each other. The Residuals vs Fitted graph shows that the 'average residual' is zero, so the relationship is likely to be linear. The Q-Q plot compares the residuals against a normal distribution, which shows several data points which be deviated slightly, but it does not appear significant enough to warrant omitting from the data set. The Scale-Location graph shows homogeneity of variance across the plot. Equally the Residuals vs Leverage do not show any deviant points, and none close to Cook's distance.

A linear model was created, showing that happiness ratings were predicted by season (F(1,`r season_model_aov$df[2]`) = `r season_model_aov$statistic[1]`, `r season_model_aov$p.value[1]`). Having Autumn as the intercept for reasons aforementioned, there was a significant influence of Autumn and of Spring, suggesting that season may have some influence on happiness ratings.


## Question 2b

```{r q2b}
#Adding age as a factor
season_model2 <- lm(happiness ~ 1 + season + age, data = couchto5k)
#Don't show this in final report
#plot(season_model2)
season_model_2 <- anova(season_model2)
season_model_2_tidy <- tidy(season_model_2)
```

```{r Figure 8, fig.asp=0.7, fig.cap="Figure 8: Happiness ratings by age and season. These graphs show that age does not predict much of the happiness scores, as there appears to be no relationship between age and happiness, even when split across seasons."}
#Visualize
ggplot(data = couchto5k, aes(x = age, y = happiness, colour = season)) + geom_point() + facet_wrap(~season) + theme_bw() +
  labs(x = "Age", y = "Happiness", title = "Happiness Ratings by Age and Season")

```

Residuals were checked for the linear model with the addition of age, and there was no egregious data points. Age was found to not be a predictor of happiness ((F(2,`r season_model_2_tidy$df[3]`) = `r season_model_2_tidy$statistic[1]`, p = `r season_model_2_tidy$p.value[1]`)). Figure _ also shows no significant impact of Age on a linear model predicting happiness ratings.


## Question 2c

```{r q2c}
anova_comparison <- anova(season_model, season_model2)
anova_comparison_tidy <- tidy(anova_comparison)
```

```{r Table 2 anova comparison}
anova_comparison %>% pander(caption = "Table 2: Comparing the effect of adding the predictor of age on a model that explains happiness through the predictor of season")

```


Given that age was not a significant predictor of happiness, the model with just season will be used as a baseline model. Table 2 shows an anova which was undertaken to compare the impact of the addition of age to explain the unknown variance, and found no significance (F(1, `r anova_comparison_tidy$res.df[2]`) = `r anova_comparison_tidy$statistic[2]`, p = `r anova_comparison_tidy$p.value[2]`)).

# Question 3

## Question 3a

```{r q3a}
#Building on model, means adding season to the model
#New column to define when someone completed couch to 5k
couchto5k <-
  couchto5k %>%
  mutate(
    is_completed = ifelse(week_stopped==9, "yes", "no")
  )


#Number of Autumn values
autumn_values <- nrow(couchto5k[couchto5k$is_completed=="no" & couchto5k$season=="autumn",])

#Create linear model
completed_model <- lm(happiness ~ 1 + season + is_completed, data=couchto5k)
#Don't show residual plots in final report
#plot(completed_model)
completed_model_1 <- anova(completed_model)
completed_model_1_tidy <- tidy(completed_model_1)

```

```{r Figure 9, fig.asp=0.7, fig.cap="Figure 9: Happiness ratings of those who completed and did not complete the program. Note that there is only the median showing for participants who did not complete the program in Autumn because of the small sample. This should be accounted for when making conclusions using this dataset alone."}
#Plot happiness with completion against season
ggplot(couchto5k, aes(x = is_completed, y = happiness, fill = is_completed)) +
  geom_boxplot() + theme_bw() + facet_wrap(~season) +
    labs(x = "Completed Program", y = "Happiness Rating", title = "Completion and Happiness") + 
  scale_fill_discrete(name = "Completed Program")
```

Figure 9 shows that `r autumn_values` participants did not complete the program in Autumn, which suggests a strong impact of individual differences. Further research should be undertaken before firm conclusions can be asserted. Nevertheless, completion of the program appears to predict happiness ratings ((F(1, `r completed_model_1_tidy$df[3]`) = `r completed_model_1_tidy$statistic[2]`, p = `r completed_model_1_tidy$p.value[2]`)).


## Question 3b
```{r Figure 10, fig.asp=0.7, fig.cap="Figure 10: Scatterplots showing the impact of health on happiness. The graphs show that health does not explain much of the unknown variance of happiness ratings, even across seasons."}

#Plot health with happiness
ggplot(couchto5k, aes(x=health, y = happiness, colour = season)) +
  geom_point() + facet_wrap(~season) + theme_bw() +
  labs(x = "Health", y = "Happiness Rating", title = "Health and Happiness")
```

```{r q3b}
#Present new model
completed_model2 <- lm(happiness ~ 1 + season + is_completed + health, data=couchto5k)

#Don't show residuals plot in final report
#plot(completed_model2)

completed_model_2 <- anova(completed_model2)
completed_model_2_tidy <- tidy(completed_model_2)

```

Residuals were checked on the linear model with the addition of health as a predictor. Figure 10 shows that health explains little of the unknown variance. This suggests that health is not a significant predictor of happiness ratings ((F(1, `r completed_model_2_tidy$df[4]`) = `r completed_model_2_tidy$statistic[3]`, p = `r completed_model_2_tidy$p.value[3]`)).

## Question 3c
```{r Figure 11, fig.asp=0.7, fig.cap="Figure 11: Relationship between health and happiness, split by whether participants completed the program. The fact that the lines cross, indicate that there is some effect of whether or not participants successfully completed the program. If participants did complete the program, there appears to be a positive relationship between health and happiness. On the other hand, if participants did not complete the program, there appears to be a negative relationship between health and happiness."}
#Visualize to justify using is_completed
plot <- ggplot(couchto5k, aes(x = health, y = happiness, colour=is_completed)) + 
  geom_smooth(method = "lm") + theme_bw() + ylim(0,100) +
  labs(x = "Health", y = "Happiness", title = "Health and Happiness")
plot + labs(colour = "Completed Program")
```

```{r q3c}
feeling_model <- lm(happiness ~ 1 + season, data = couchto5k)
feeling_model2 <- lm(happiness ~ 1 + season + health*is_completed, data = couchto5k)
#Don't show in final report
#plot(feeling_model2)
feeling_models <- anova(feeling_model, feeling_model2)
feeling_models_tidy <- tidy(feeling_models)


#Do graph to justify using week_stopped over is_completed


```

Building on the previous model, the binary measure for completing the program was used, instead of grouping participants on which week they stopped. This is because there were a lot more participants who completed the program than those who stopped at each individual week (see Figure 1 for a visualization). The diagnostic plots of residuals show no outright violation of the assumptions. Figure __ shows an interaction between health and whether the participant has completed the study. This interaction was found to be a significant predictor of happiness ratings (F(`r feeling_models_tidy$df[2]`, `r feeling_models_tidy$res.df[2]`) = `r feeling_models_tidy$statistic[2]`, p < .001`).


## Question 3d
Given the previous models, one can suggest that completing the program appears to predict ratings of happiness. Health appears to only predict happiness when it is interacting with completion. In other words, higher ratings of health predict higher happiness ratings only when the participant completed the program. Alternatively, higher ratings of health predict lower happiness ratings only when the participant was unable to complete the program.


# Question 4

```{r q4}
#Creating subset of data
completed <- 
  couchto5k %>%
  filter(week_stopped==9)
  
Edinburgh <-
  completed %>%
  filter(city=="Edinburgh") %>%
  group_by(season) %>%
  summarise(mean_se(happiness))

Glasgow <- 
  completed %>%
  filter(city=="Glasgow") %>%
  group_by(season) %>%
  summarise(mean_se(happiness))

#Rename and mutate

Edinburgh <- 
  Edinburgh %>%
  rename("average_happiness" = "y") %>%
  mutate(
    city = "Edinburgh"
  )

Glasgow <- 
  Glasgow %>%
  rename("average_happiness" = "y") %>%
  mutate(
    city = "Glasgow"
  )

#Merge Edinburgh and Glasgow

cities <- Edinburgh %>%
  full_join(x=., y=Glasgow)
```

```{r Figure 12, fig.asp=0.7, fig.cap="Figure 12: Average happiness ratings by season and city. The most significant difference of happiness ratings between cities appear to be in Spring. Note that there is no error bar on the results of Glasgow in Spring, due to the sample being only one. This small sample will have an impact on the results, which companies should note before acting on these results. Conclusions made from these results should be supported from further research."}
#plot merged data
cities %>%
  ggplot(aes(x=season,y=average_happiness, fill=city, ymin=ymin,ymax=ymax)) + geom_bar(position = "dodge", stat = "identity") + 
  geom_errorbar(width=0.2, position=position_dodge(0.9)) + theme_bw() +
  labs(x = "Season", y = "Average Happiness Rating", title = "Happiness by City")

```

# Question 5

## Question 5a

```{r q5a}
#Adding predictors to a model that predicts dropout
mod1 <- lm(week_stopped ~ 1 + season, data = couchto5k)
aov1 <- anova(mod1)

mod2 <- update(mod1, .~. + health)
aov2 <- anova(mod2)
#health does not predict dropout rate

mod3 <- update(mod1, .~. + accountability)
aov3 <- anova(mod3)
#Accountability does not predict dropout rate

mod4 <- update(mod1, .~. + selfmot)
aov4 <- anova(mod4)
#plot(mod4)
#Selfmot does predict dropout rate

aov4_1 <- anova(mod1, mod4)
aov4_1_tidy <- tidy(aov4_1)
#Anova shows mod4 explains more of the variance than mod1 (the inclusion of motivation is important)

mod5 <- update(mod4, .~. + happiness)
aov5 <- anova(mod5)
#Happiness adds nothing

mod6 <- update(mod4, .~. + city)
aov6 <- anova(mod6)
#City non-significant

mod7 <- update(mod4, .~. + age)
aov7 <- anova(mod7)
#Age did not add anything

#Final model is mod4 which includes season and self motivation
#Visualize data
```

```{r Figure 13, fig.asp=0.7, fig.cap="Figure 13: Self motivation and season predicting when participants are likely to quit the program. Note that at instances where the week stopped is 9, participants have successfully completed the program. This visualization suggests that an interaction between self motivation and week stopped is unlikely, since the slopes have roughly similar angles, and only cross at values of week stopped which are impossible (i.e., after week 9 and before week 1)."}
ggplot(couchto5k, aes(x = selfmot, y = week_stopped, colour=season)) + geom_smooth(method = "lm") +
  theme_bw() + labs(x = "Self Motivation", y = "Week Stopped", title = "Self Motivation predicting Week Stopped") + scale_y_continuous(limits=c(1,9), breaks=seq(1, 9, 1)) + scale_x_continuous(breaks = seq(8, 22, 2))
#Graph suggests interaction unlikely, given the lines do not differ in slope that severely
```

Predictors were individually added to a model that explained dropout. Only season and self-motivation were found to explain significantly more of the variance than a null model. When comparing between a model with season on its own and a model with both season and self-motivation as predictors, the model with both predictors explained more of the variance and therefore was preferred (F(`r aov4_1_tidy$df[2]`, `r aov4_1_tidy$res.df[2]`) = `r aov4_1_tidy$statistic[2]`, p < .001). The diagnostic plots of the residuals appear to show potential violation of normality of residuals, but it does not appear significant enough to warrant an alternative method to be selected.

## Question 5b

```{r q5b Table}
explain <- summary(mod4)
mod4 %>% pander(caption="Table 3: Fitting linear model: week stopped ~ season + self motivation ('selfmot')
")
```

In the selected model, the season in which the participant completed the program and the level of self-reported self motivation are significant predictors of how far through the program one would go before. The linear model (based on Table 3), indicates that for someone attempting the program in Autumn with 0 self motivation, they would most likely get somewhere between week 2 and 3 of the program before giving up. If they then took part in Spring, the estimate for the week they would give up would drop by 4 weeks (which is impossible for self motivation levels of 0). Likewise, for summer and winter, the estimate on what week they would give up on is only marginally different and not statistically different, suggesting that there is little difference on the week they would give up on. However, for every 1 self-motivation score one gave on the questionnaire, there would be an increase of 0.35 weeks one would get through before they gave up. These details can be observed in Figure 14.

## Question 5c

```{r q5c}
#Subset completed group
grouped <-
  couchto5k %>%
  group_by(selfmot) %>%
  summarise(is_completed)

grouped <- 
  grouped %>%
  mutate(
    if_quit= ifelse(is_completed == "yes", 0, 1)
    ) 
#quit=1,completed=0

#running the model

completed_glm <- glm(if_quit ~ selfmot, data = grouped, family="binomial")

#selfmot values

selfmot_scale <- tibble(selfmot= 5:35)
#predict(completed_glm, newdata= selfmot_scale, type="response")

#predicting probability of quitting for selfmot values

selfmot_scale <-
  selfmot_scale %>%
  mutate(
    predprobs = predict(completed_glm, newdata= selfmot_scale, type="response")
    )
```


```{r Figure 14, fig.asp=0.7, fig.cap="Figure 14: Graph showing the predicted probability of quitting based on self-reported self motivation. The graph shows that having a self motivated rating of 15 or more indicates an increased likelihood of successfully completing the program."}
ggplot(data = selfmot_scale, aes(x = selfmot, y = predprobs)) + 
  geom_line() + labs(y="Predicted Probability of Quitting", x="Self Motivation Score", title = "Probability of Qutting through Self Motivation") + 
  xlim(5,35) + ylim(0,1)

```










