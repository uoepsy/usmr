---
title: "USMR 2021-2022 Coursework"
author: "`r params$examnumber`"
date: "`r Sys.Date()`"
output:
  html_document: default
  word_document: default
  pdf_document: default
params:
  examnumber: "B191425"
---

```{r setup, include=FALSE, message= FALSE}
# this line will mean that when you compile/knit your document, 
# the code will not show, but the output (e.g., plots) will!
knitr::opts_chunk$set(echo = FALSE)
# this line means all numeric output gets rounded to 3 dp
options(digits=3)
# load any other packages that you require here:
library(tidyverse)
library(sjPlot) 
library(car)
library(kableExtra)
library(psych)
# This will read in your own personal data:
source("https://uoepsy.github.io/data/usmr_2122_data.R")
```

<style type="text/css">
.main-container {
  max-width: 1800px;
  margin-left: auto;
  margin-right: auto;
}
</style>

<br>

# Question 0: Cleaning & Describing

*Have a look at the data. Check for impossible values and deal with these in an appropriate manner. Describe the data, either in words or using suitable graphs (or a combination). Remember to detail the decisions you have made.*

<br>

Before beginning with the data analysis, the data was summarised and visualised to identify any impossible values. 

<br>

**Table 1**

*Summary Statistics for the Couch to 5K Dataset*

```{r tab1, fig.align= "center", fig.height= 10, fig.width= 15}
#summary of the data as table
summaryC25K <- describe(couchto5k) %>%
  select(-trimmed, -mad, -skew, -kurtosis, -se) %>%
  kable(col.names = c("Variables", "N", "Mean", "SD", "Median", "Min", "Max", "Range"), align = "c") %>%
  kable_styling(full_width =T)

summaryC25K
```

<br>

**Figure 1**

*Plot of the Couch to 5K Dataset*

```{r fig1, fig.align= "center", fig.height= 10, fig.width= 15}
#summary of the data as plot
couchto5k %>% 
  select(age, accountability, selfmot, health, happiness, week_stopped) %>%
  plot()
```
*Note.* Only continuous variables are shown. 

<br>

Impossible values were found, but rather than simply removing these participants' data altogether, their impossible values were assumed to have been typing mistakes since their other values appeared to be plausible and, thus, were marked as not applicable (NA). Participant 39 and participant 59 reported their age as 143 and 153 years, respectively. Since this is highly unlikely to be the case, these participants' ages were excluded and marked as NA. Participants 36 and 74 provided self-motivation scores of -99, which is not within the possible response range (minimum: 5, maximum: 35). Therefore, these participants' self-motivation scores were excluded and marked as NA. Participant 53 stated they stopped the Couch to 5K programme at week 12, which is outside the response range, since the programme is 9 weeks long. Therefore, their value was excluded and marked as NA. Furthermore, participants 21, 99, and 123 misspelled "autumn" as "autunm", which was corrected.

```{r cleaning, include = FALSE}
#clean impossible values
couchto5k$age[couchto5k$age > 100] <- NA
couchto5k$selfmot[couchto5k$selfmot < 5] <- NA
couchto5k$season[couchto5k$season=="autunm"] <- "autumn"
couchto5k$week_stopped[couchto5k$week_stopped > 9] <- NA

#change season variable to factors
couchto5k <- couchto5k %>%
  mutate(season = factor(season, levels = c("spring", "summer", "autumn", "winter")))

#useful values
total_n <- nrow(couchto5k)
```

<br>

Below is a summary table as well as plots visualising the descriptives after the data was cleaned.

<br>

**Table 2**

*Summary Statistics for the Couch to 5K Dataset After Data Cleaning*

```{r tab2, fig.align= "center", fig.height= 10, fig.width= 15}
#summary of clean data as table
summaryC25Kclean <- describe(couchto5k) %>%
  select(-trimmed, -mad, -skew, -kurtosis, -se) %>%
  kable(col.names = c("Variables", "N", "Mean", "SD", "Median", "Min", "Max", "Range"), align = "c") %>%
  kable_styling(full_width =T)

summaryC25Kclean
```

<br>

**Figure 2**

*Plot of the Couch to 5K Dataset After Data Cleaning*

```{r fig2, fig.align= "center", fig.height= 10, fig.width= 15}
#summary of clean data as plot
couchto5k %>% 
  select(age, accountability, selfmot, health, happiness, week_stopped) %>%
  plot()
```
*Note.* Only continuous variables are shown. 

<br>

**Figure 3**

*Number of Participants per City*

```{r fig3, message= FALSE, warning= FALSE, fig.align= "center", fig.height= 10, fig.width= 15}
#plot
couchto5k %>%
  ggplot(aes(x = city, fill = city)) +
  geom_bar() +
  labs (x = "City", y= "Number of Participants") +
  theme_classic() + 
  scale_fill_brewer(palette = "Dark2")
```

<br>

**Figure 4**

*Participants per Interviewing Season*

```{r fig4, message= FALSE, warning= FALSE, fig.align= "center", fig.height= 10, fig.width= 15}
#plot
couchto5k %>%
  ggplot(aes(x = season, fill = season)) +
  geom_bar() +
  labs (x = "Interview Season", y= "Number of Participants") +
  theme_classic() + 
  scale_fill_brewer(palette = "Dark2")
```

<br>

-----------------------------------------------------------------------------------------------------------------------------

# Question 1 

## Question 1a: 

*In an earlier nationwide survey, researchers found that 45% of participants abandoned the programme before the halfway point in week 5, and a further 10% gave up before the end of the programme. Is the data in the sample you have been given in line with data from the earlier survey? Once you have created a suitable variable to map to the information in the question, you should be able to answer this using a simple statistical test.*

<br>

```{r q1a, include = FALSE}
#calculate week stopped < halfway & week stopped > half < 9 & week stopped = 9
stopped <- couchto5k %>%
  group_by(week_stopped) %>%
  summarise(number= n()) %>%
  mutate(percentage = (number/total_n)*100)

#percentages
before_halfway <- stopped$percentage[1:4]
after_halfway <- stopped$percentage[5:8]
finished <- stopped$percentage[9]

#t-tests
before_halfway_ttest <- t.test(before_halfway, mu = 45)
before_halfway_ttest
after_halfway_ttest <- t.test(after_halfway, mu = 10)
after_halfway_ttest
```

Overall, `r sum(before_halfway)`% of participants stopped participating in the Couch to 5K programme before the halfway point in week 5 in the present dataset. A further `r sum(after_halfway)`% dropped out of the programme after the halfway point and `r sum(finished)`% of participants completed the programme. These figures differ from the data of the previous nationwide survey and two one sample t-tests were conducted to examine to what extent these samples differ. 

It was found that the amount of participants who dropped out of the programme before the halfway point (*t* (`r before_halfway_ttest$parameter`) = `r before_halfway_ttest$statistic`, *p* = `r before_halfway_ttest$p.value`) as well as after the halfway point (*t* (`r after_halfway_ttest$parameter`) = `r after_halfway_ttest$statistic`, *p* = `r after_halfway_ttest$p.value`) was significantly lower compared to the earlier sample.

Thus, overall, the data in the present sample is not in line with the data from the earlier survey.

<br>

## Question 1b: 
*Using the same three categories (stopped before week 5, stopped after week 5, completed), examine whether the patterns of attrition rates differ by city.*

<br>

```{r q1b, include= FALSE, message= FALSE}
#group dropouts by city
stopped_city <- couchto5k %>%
  group_by(week_stopped, city) %>%
  summarise(number= n()) %>%
  mutate(percentage = (number/total_n)*100)

#Glasgow
stopped_glasgow <- stopped_city$number[stopped_city$city == "Glasgow"]
before_halfway_glasgow <- stopped_glasgow[1:4]
after_halfway_glasgow <- stopped_glasgow[5:8]
finished_glasgow <- stopped_glasgow[9] 

stopped_glasgow_percent <- stopped_city$percentage[stopped_city$city == "Glasgow"]
before_halfway_glasgow_percent <- stopped_glasgow_percent[1:4]
after_halfway_glasgow_percent <- stopped_glasgow_percent[5:8]
finished_glasgow_percent <- stopped_glasgow_percent[9] 

#Edinburgh
stopped_edinburgh <- stopped_city$number[stopped_city$city == "Edinburgh"]
before_halfway_edinburgh <- stopped_edinburgh[1:4]
after_halfway_edinburgh <- stopped_edinburgh[5:8]
finished_edinburgh <- stopped_edinburgh[9] 

stopped_edinburgh_percent <- stopped_city$percentage[stopped_city$city == "Edinburgh"]
before_halfway_edinburgh_percent <- stopped_edinburgh_percent[1:4]
after_halfway_edinburgh_percent <- stopped_edinburgh_percent[5:8]
finished_edinburgh_percent <- stopped_edinburgh_percent[9] 

#t-tests
city_before_halfway_ttest <- t.test(before_halfway_edinburgh, before_halfway_glasgow, paired = TRUE, alternative = "two.sided")
city_after_halfway_ttest <- t.test(after_halfway_edinburgh, after_halfway_glasgow, paired = TRUE, alternative = "two.sided")
```

In Glasgow, `r sum(before_halfway_glasgow_percent)`% of participants stopped participating in the Couch to 5K programme before the halfway point in week 5, compared to `r sum(before_halfway_edinburgh_percent)`% of participants in Edinburgh. Meanwhile, `r sum(after_halfway_glasgow_percent)`% of participants stopped participating in the Couch to 5K programme after the halfway point in Glasgow, compared to `r sum(after_halfway_edinburgh_percent)`% of participants in Edinburgh. 12.195% of participants in Glasgow and `r sum(finished_edinburgh_percent)`% of participants in Edinburgh completed the programme.

A paired samples t-test found that there was a significant difference in the amount of participants from Edinburgh and Glasgow who stopped the Couch to 5K programme before the halfway point (*t* (`r city_before_halfway_ttest$parameter`) = `r city_before_halfway_ttest$statistic`, *p* = `r city_before_halfway_ttest$p.value`), with participants in Edinburgh being significantly more likely to stop the programme before week 5. Meanwhile, no significant difference between the cities was found for stopping after the halfway point (*t* (`r city_after_halfway_ttest$parameter`) = `r city_after_halfway_ttest$statistic`, *p* = `r city_after_halfway_ttest$p.value`).

The patterns of attrition rates in terms of the week in which participants stopped the programme are further visualised in the bar chart below.

<br>

**Figure 5**

*Bar Chart Showing the Week in Which Participants Stopped the Couch to 5K Programme by City*

```{r fig5, message= FALSE, warning= FALSE, fig.align= "center", fig.height= 10, fig.width= 15}
#graph
stopped_city %>%
  ggplot(aes(x = week_stopped, y = percentage, fill = city)) +
  geom_col() +
  labs (x = "Week Stopped", y= "Participants (in %)") +
  scale_x_continuous(breaks= 1:9) +
  facet_wrap(~city) +
  theme_classic() +
  scale_fill_brewer(palette = "Dark2")
```

<br>

## Question 1c: 
*Do the average ages of participants who commenced the programme differ by city?*

<br>

```{r q1c, message= FALSE}
age_ttest <- t.test(x = couchto5k$age[couchto5k$city == "Edinburgh"], y = couchto5k$age[couchto5k$city == "Glasgow"])
```

To investigate whether the average ages of participants who commenced the Couch to 5K programme differed by city, a Welch two sample t-test was conducted. It was found that the average ages of participants who commenced the programme significantly differed by city, (*t* (`r age_ttest$parameter`) = `r age_ttest$statistic`, *p* = `r age_ttest$p.value`), with participants from Edinburgh being slightly older than those from Glasgow. This difference is visualised in the bar chart below.

<br>

**Figure 6**

*Bar chart Showing Average Age Differences by City*

```{r fig6, message= FALSE, warning= FALSE, fig.align= "center", fig.height= 10, fig.width= 15}
#graph
couchto5k %>%
  select(age, city) %>%
  na.omit() %>%
  group_by(city) %>%
  summarise(mean_age = mean(age)) %>%
  ggplot(aes(x = city, y = mean_age, fill = city)) +
  geom_col() +
  labs (x = "City", y= "Mean Age of Participants") +
  theme_classic() + 
  scale_fill_brewer(palette = "Dark2")
```

<br>

-----------------------------------------------------------------------------------------------------------------------------

# Question 2

## Question 2a: 
*Are participants’ happiness ratings affected by the season they were interviewed in? Describe the way in which season influences happiness outcomes.*

<br>

The effect of the season in which participants were interviewed on their happiness ratings is visualised in the bar chart below. Significant differences can be detected, with participants who were interviewed in spring reporting the highest mean happiness scores (57.99) and participants who were interviewed in winter reporting the lowest mean happiness scores (`r 57.99 - 23.99`).

<br>

**Figure 7**

*Bar Chart Showing Mean Differences of Participants' Happiness by Season*

```{r fig7, message= FALSE, warning= FALSE, fig.align= "center", fig.height= 10, fig.width= 15}
#calculate mean happiness
couchto5k %>%
  select(happiness, season) %>%
  na.omit() %>%
  group_by(season) %>%
  summarise(mean_happiness = mean(happiness)) %>%
  ggplot(aes(x = season, y = mean_happiness, fill = season)) +
  geom_col() +
  labs (x = "Interview Season", y= "Mean Happiness Scores of Participants") +
  theme_classic() + 
  scale_fill_brewer(palette = "Dark2")
```

```{r q2a, include = FALSE}
#linear model for season & happiness
lm1 <- lm(happiness ~ season, data = couchto5k)
summary(lm1)
```

<br>

A categorical linear regression was conducted to examine whether participants' happiness ratings were affected by the season in which they were interviewed. It was found that being interviewed in some seasons, namely spring and winter, did significantly affect participants' happiness scores, as can be seen in Table 3.

<br>

**Table 3**

*Results of a Categorical Linear Regression Examining the Effect of Interviewing Season on Participants' Happiness Score*

```{r tab3, message= FALSE, warning= FALSE, fig.align= "center", fig.height= 10, fig.width= 15}
#table
tab_model(lm1)
```

<br>

Participants who were interviewed in spring reported a mean happiness score of 57.99, which was significantly influenced by being interviewed in spring (*p* < .001). Being interviewed in the summer predicted a decrease in participants' happiness scores by 8.15 units compared to spring, however, this was not statistically significant (*p* = .213). Being interviewed in autumn predicted a decrease in participants' happiness scores by 4.27 units compared to spring, but again, this was not statistically significant (*p* = .723). Lastly, participants' happiness scores predictably decreased by 23.99 units when they were interviewed in winter compared to spring and this was statistically significant (*p* = .013). The season in which participants were interviewed explained 5.5% (R^2 = .055) of the variance in happiness scores. However, the F-statistic suggests that the model does not fit the data significantly better than the null mean model, F(3, 114) = 2.33, *p* = .139.

<br>

## Question 2b: 
*Accounting for any effects you discovered in (2a), is happiness affected by age?*

```{r q2b, include = FALSE}
lm2 <- lm(happiness ~ season + age, data = couchto5k)
summary(lm2)
```

<br>

To understand whether season, together with age, predicted participants' happiness scores, a multiple regression analysis was conducted. As can be seen in Table 4, it was found that, while season significantly predicted participants' happiness scores, this was not the case for age.

<br>

**Table 4**

*Results of a Multiple Linear Regression Examining the Effect of Interviewing Season and Age on Participants' Happiness Score*

```{r tab4, message= FALSE, warning= FALSE, fig.align= "center", fig.height= 10, fig.width= 15}
#table
tab_model(lm2)
```

<br>

A year of age predicted an increase of 0.35 units on the happiness scale but this prediction was insignificant (*p* = .123). Overall, this model explained 6.2% (R^2 = .062) of the variance in happiness scores, which is 0.7% more than the previous model. This means that adding age to the model helps explain more of the variance in the data, albeit very little. The F-statistic suggests that the model does not fit the data significantly better than the null mean model, F(4, 116) = 1.93, *p* = .11.

<br>

## Question 2c: 
*The models you have built above explore ‘baseline’ effects; that is, effects that are not of primary interest to the researchers but which might affect the outcome variable of happiness. For use in question 3, pick a specific baseline model and justify why you are using this.*

<br>

Since it was found in Question 2b that age was an insignificant predictor of participants' happiness scores (*p* = .123), it was decided to use the model including only season (*see Question 2a*) as a predictor of happiness as the baseline model:

`lm(happiness ~ season, data = couchto5k)`

```{r q2c, include = FALSE}
#assumptions tests
plot(lm1, which=1)
plot(lm1, which=2)
plot(lm1, which=3)
dwt(lm1)
plot(lm1, which=4)
```

<br>

Furthermore, the adherence of this model to the assumptions underlying linear models were checked, namely the linearity of the relationship, the normal distribution of residuals, the homogeneity of the variance, and the independence of the residuals, as well as the influence of outliers. No violations of the assumptions were found.

<br>

-----------------------------------------------------------------------------------------------------------------------------

# Question 3

## Question 3a: 
*Building on your baseline model, are participants’ happiness ratings affected by whether or not they completed the programme? Describe the way in which programme completion influences happiness outcomes.*

```{r q3a, include = FALSE}
couchto5k <- couchto5k %>%
  mutate(complete = ifelse(week_stopped == 9, 1, 0))

lm3 <- lm(happiness ~ season + complete, data = couchto5k)
summary(lm3)
```

<br>

A multiple linear regression using the baseline model (*see Question 2c*) was conducted to examine whether participants' happiness ratings were affected by whether or not they completed the Couch to 5K programme, the results of which can be seen in Table 5. This model did not significantly predict participants' happiness ratings.

<br>

**Table 5**

*Results of a Multiple Linear Regression Examining the Effect of Interviewing Season on Participants' Happiness Score*

```{r tab5, message= FALSE, warning= FALSE, fig.align= "center", fig.height= 10, fig.width= 15}
#table
tab_model(lm3)
```

<br>

Completing the programme predicts an increase of participants' happiness scores by 8.96 units compared to the intercept of the average happiness ratings of participants interviewed in spring (57.30). However, this was statistically insignificant (*p* = .250). The model explained 7.2% (R^2 = .072) of the variance in the data. This is 1.7% more than the baseline model, suggesting that adding whether or not participants completed the programme to the model explains slightly more of the variance. However, the F-statistic suggests that the model does not fit the data significantly better than the null mean model, F(4, 117) = 2.28, *p* = .065.

<br>

## Question 3b: 
*Building on the analysis in (3a), is happiness additionally affected by the “health metric”?*

```{r q3b, include = FALSE}
lm4 <- lm(happiness ~ season + complete + health, data = couchto5k)
summary(lm4)
```

<br>

A multiple linear regression using the baseline model was conducted to examine whether participants' happiness ratings were affected by whether or not they completed the Couch to 5K programme as well as their health metric scores, as can be seen in Table 6. This model was not a significant predictor of participants' happiness ratings.

<br>

**Table 6**

*Results of a Multiple Linear Regression Examining the Effect of Interviewing Season on Participants' Happiness Score*

```{r tab6, message= FALSE, warning= FALSE, fig.align= "center", fig.height= 10, fig.width= 15}
#table
tab_model(lm4)
```

<br>

Every increase of one unit on the health metric predicted a decrease in participants' happiness scores by 0.38 units compared to the intercept of the happiness ratings of participants interviewed in spring. However, this was not statistically significant (*p* = .170). The model explained 8.7% (R^2 = .087) of the variance in the data, which is 1.5% more than the previous model, indicating that adding the health metric helps to explain slightly more variance than the interview season alone. The F-statistic indicates that the model does not fit the data significantly better than the null mean model, F(5, 116) = 2.28, *p* = .057.

<br>

## Question 3c: 
*It’s been hypothesised that the effects of good health are amplified by the feeling of acting healthily, such that the happiness of participants who got further along the programme might be more affected by the health metric than that of those who stopped earlier. Building on the model in (3b), can you test this hypothesis?*

```{r q3c, include = FALSE}
lm5 <- lm(happiness ~ season + week_stopped * health, data = couchto5k)
summary(lm5)
```

<br>

A multiple linear regression building on the baseline model found that participants' happiness ratings were affected by the season they were interviewed in, as well as the interaction between how far along they got on the Couch to 5K programme and their health metric scores. The results will be discussed in detail in Question 3d.

<br>

## Question 3d: 
*What can we conclude about the various causes of happiness in our data? Write a brief description of the effects in the model, such as you might find in an academic paper.*

<br>

A multiple linear regression building on the baseline model was conducted to investigate whether participants' happiness ratings were affected by the season they were interviewed in, as well as by the interaction between how far along they got on the Couch to 5K programme and their health metric scores. The results are visualised in Figure 8 and can be seen in Table 7.

<br>

**Figure 8**

*The Effect of Interviewing Season, and the Interaction of the Week in Which They Stopped the Couch to 5K Programme and Health Scores, on Participants' Happiness Scores*

```{r fig8, message= FALSE, warning= FALSE, fig.align= "center", fig.height= 10, fig.width= 15}
#plot
ggplot(couchto5k, aes(x = health, y = happiness, fill = week_stopped)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  labs(x = "Health Score", y = "Happiness Score") +
  theme_classic()
```

<br>

**Table 7**

*Results of a Multiple Linear Regression Examining the Effect of Interviewing Season, and the Interaction of the Week in Which They Stopped the Couch to 5K Programme and Health Scores, on Participants' Happiness Scores*

```{r tab7, message= FALSE, warning= FALSE, fig.align= "center", fig.height= 10, fig.width= 15}
#table
tab_model(lm5)
```

<br>

Overall, the season in which participants were interviewed, as well as their health scores and the week in which they dropped out of the programme, predicted their happiness scores. The week in which participants dropped out of the programme significantly predicted their happiness scores (*p* = .001). With each week the participants got further along, their happiness scores decreased by 16.95 units. Health was a weak but significant predictor of happiness (*p* < .001), where a one unit increase on the health metric predicted a 2.64 unit decrease on participants' happiness scores. This means that the healthier participants were, the less happy they felt. Furthermore, there was a small but significant interaction between participants health scores and the week they stopped the programme (*p* < .001), meaning that the further along participants got in the programme, the stronger the effect of health was on happiness. The model explained 22.4% (R^2 = .224) of the variance in the data. Moreover, the F-statistic indicates that the model fits the data significantly better than the null mean model, F(6, 115) = 5.53, *p* < .001.

<br>

-----------------------------------------------------------------------------------------------------------------------------

# Question 4: 
*Create a subset of the data, including only those participants who completed the programme. Create a plot of the average happiness ratings grouped by season and city, that can be used in a presentation to the funders of the project.*

```{r q4, message = FALSE}
#subset
q4_subset <- couchto5k %>%
  filter(complete == 1) %>%
  group_by(season, city) %>%
  summarise(mean_happiness = mean(happiness))
```
<br>

**Figure 9**

*Participants' Average Happiness Ratings Grouped by Season of Interview and City*

```{r fig9, message= FALSE, warning= FALSE, fig.align= "center", fig.height= 10, fig.width= 15}
#plot
q4_subset %>%
  ggplot(aes(x = season, y = mean_happiness, fill = season)) +
  geom_col() +
  labs (x = "Season", y= "Mean Happiness Ratings") +
  facet_wrap(~city) +
  theme_classic() + 
  scale_fill_brewer(palette = "Dark2")
```

<br>

-----------------------------------------------------------------------------------------------------------------------------

# Question 5

## Question 5a: 
*Build a model that predicts the likelihood of dropping out (at all).*

```{r q5a prep}
#Martin's function
l2p <- function(logits) {
  odds = exp(logits)
  prob = odds / (1+odds)
  return(prob)
}

#dropping out
couchto5k <- couchto5k %>%
  mutate(stopped = as.factor(ifelse(week_stopped == 9, 0, 1)))
```

<br>

Firstly, a variable for whether participants dropped out of the Couch to 5K programme was added to the dataset.

```{r q5a glm, include = FALSE}
#generalised linear model
glm1 <- glm(stopped ~ accountability + selfmot + health + happiness + season + city, data = couchto5k, family = "binomial")
summary(glm1)

glm2 <- glm(stopped ~ selfmot + season, data = couchto5k, family = "binomial")

#coefficients
glm_coef <- coef(glm2)

#logit coefficients
intercept <- glm_coef[1]
glm_selfmot <- glm_coef[2]
logits_dropout <- intercept + 16.058 * glm_selfmot
l2p(logits_dropout)

#accuracy
guess <- predict(glm2)
guess <- ifelse(guess > 0, 1, 0)
hits <- sum(guess == couchto5k$stopped)
hits / length(couchto5k$stopped)
```

<br>

Next, a generalised linear regression analysis was conducted to identify any potential predictors of participants dropping out of the Couch to 5K programme. Accountability, health, happiness, and city were not significant predictors of how likely participants were to drop out. Therefore, they were excluded from the final model. Hence, the model that predicts the likelihood of dropping out is the following: 

```{r q5a model, warning = FALSE}
summary(glm2)
as.tibble(anova(glm2, test = "Chisq"))
```

<br>

## Question 5b: 
*Briefly describe the effects in your model as you would in an academic paper.*

<br>

A generalised linear regression analysis was conducted to investigate the predictors of participants dropping out of the Couch to 5K programme, the results of which can be seen in Table 8.

<br>

**Table 8**

*Results of a Generalised Linear Regression Analysis Predicting the Likelihood of Participants Dropping Out of the Couch to 5K Programme*

```{r tab8, message= FALSE, warning= FALSE, fig.align= "center", fig.height= 10, fig.width= 15}
#table
tab_model(glm2)
```

<br>

The season in which participants were interviewed was a significant predictor of whether they dropped out of the programme. Being interviewed in spring (4.462, z = 3.25, *p* = .001), summer (-4.271, z = -5.51, *p* < .001), and winter (-2.975, z = -3.72, *p* < .001) significantly predicted a lower likelihood of dropping out. Adding the interview season to the generalised linear model dropped the residual deviance by 72.58 (*p*(X^2>72.58) < .001), meaning that the model explains significantly more of the deviance in the data in comparison to the null mean model.

Furthermore, participants' self motivation significantly predicted their likelihood of dropping out (-0.188, z = -2.24, *p* = .025), with lower self motivation scores predicting a higher likelihood of dropping out. The probability for dropping out is `r l2p(4.462 + -0.188 * 16.058)` for the mean score of self motivation (16.058)

Adding the interview season to the generalised linear model dropped the residual deviance by 1.27 (*p*(X^2>1.27) < .001), meaning that the model explains a small but more significant amount of the deviance in the data in comparison to the null mean model.

Moreover, the accuracy of the model was `r hits/length(couchto5k$stopped)`, meaning the model explained `r hits/length(couchto5k$stopped)`% of the deviance in the data.

<br>

## Question 5c: 
*Draw a graph representing the probability of quitting as a function of how self motivated participants were.*

<br>

**Figure 10**

*Probability of Participants Quitting the Couch to 5K Programme as a Function of How Self Motivated They Were*

```{r q5c fig10, message= FALSE, warning= FALSE, fig.align= "center", fig.height= 10, fig.width= 15}
couchto5k %>%
  na.omit %>%
  ggplot(aes(x = selfmot, y = stopped)) +
  geom_jitter() +
  geom_smooth(method = "glm", method.args = list(family = binomial), se = TRUE) +
  labs(x = "Self Motivation", y = "Probability of Quitting the Couch to 5K Programme") +
  theme_classic()
```










