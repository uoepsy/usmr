<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>More tests</title>

<script src="site_libs/header-attrs-2.8/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-chevron-circle-right')) {
    f.classList.add('fa-chevron-circle-down')
    f.classList.remove('fa-chevron-circle-right')
} else {
    f.classList.add('fa-chevron-circle-right')
    f.classList.remove('fa-chevron-circle-down')
}
}
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="assets/style-labs.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="https://uoepsy.github.io/usmr/">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    USMR Starts Here!
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="00_introPG.html">Getting started with R &amp; RStudio</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data &amp; Distributions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01_categorical.html">1: Categorical Data</a>
    </li>
    <li>
      <a href="02_numerical.html">2: Numeric Data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tests, Models &amp; Data Wrangling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="03_nhst.html">3: Hypothesis testing</a>
    </li>
    <li>
      <a href="04_tests.html">4: More tests</a>
    </li>
    <li>
      <a href="05_covcor.html">5: Cov, Cor, Functions &amp; Models</a>
    </li>
    <li class="dropdown-header">--- 6: Break Week ---</li>
    <li>
      <a href="06_messy.html">7: Messy data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Regression models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="07_regression.html">8: Linear Regression</a>
    </li>
    <li>
      <a href="08_regression2.html">9: More Linear Regression</a>
    </li>
    <li class="dropdown-header">10: GLM!</li>
    <li class="dropdown-header">11: Writing up</li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Extras
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="zz_assumpt.html">LM Assumptions: Recipe book</a>
    </li>
    <li>
      <a href="zz_incrementalvalidity.html">Incremental Validity: A Caution</a>
    </li>
    <li>
      <a href="zz_ss.html">Sums of Squares</a>
    </li>
    <li>
      <a href="zz_modelselect.html">Model Selection</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">More tests</h1>

</div>


<!-- :::red -->
<!-- **Preliminaries**   -->
<!-- - Be sure to check the [**solutions to last week's exercises**](03_nhst.html). You can still ask any questions about previous weeks' materials if things aren't clear!      -->
<!-- 1. Open Rstudio, make sure you have the USMR project open, and create a new RMarkdown document (giving it a title for this topic).  -->
<!-- ::: -->
<div id="chi2-goodness-of-fit-test" class="section level1">
<h1><span class="math inline">\(\chi^2\)</span> Goodness of Fit Test</h1>
<div class="frame">
<p>As you may remember, in the survey we asked students to complete in welcome week, one of the questions concerned the month in which you were born. You can download the data from <a href="https://uoepsy.github.io/data/surveydata_allcourse.csv" class="uri">https://uoepsy.github.io/data/surveydata_allcourse.csv</a>.</p>
<p>We need to make sure we know how many observations we have. While there are currently 393 observations in our sample, we may have missing data in our variable of interest!</p>
<p>We can use filter to remove any which are missing (or <code>NA</code>s).<br />
Take a bit of time to look at what each bit of this does. To help figure it out, try seeing what <code>is.na(c(NA,1,2))</code> does. Then try <code>!is.na(c(NA,1,2))</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>survey_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://uoepsy.github.io/data/surveydata_allcourse.csv&quot;</span>) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>survey_data <span class="ot">&lt;-</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  survey_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(birthmonth))</span></code></pre></div>
</div>
<div class="question-begin">
Question A1
</div>
<div class="question-body">
<p>What is your intuition about the distribution of all students’ birth-months?<br />
Do you think they will be spread uniformly across all months of the year (like a fair 12-sided dice), or do you think people are more likely to be born in certain months more than others?</p>
<p>Plot the distribution and get an initial idea of how things are looking.</p>
<p><em>Tip:</em> You can do this quickly with <code>barplot()</code> and <code>table()</code>, or you could create try using <code>ggplot()</code> and looking into <code>geom_bar()</code>.</p>
<p><em>(We’ve made the solutions visible immediately for this question, because they contain some useful little bits of code for re-ordering the months)</em></p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-44" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-44&#39;, &#39;sol-start-44&#39;)"> Solution </span>
</div>
<div id="sol-body-44" class="solution-body" style="display: none;">
<p>The quick and dirty way:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(survey_data<span class="sc">$</span>birthmonth))</span></code></pre></div>
<p><img src="04_tests_files/figure-html/unnamed-chunk-2-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>A ggplot option:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> survey_data, <span class="fu">aes</span>(<span class="at">x =</span> birthmonth)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;- Birth Month -&quot;</span>)</span></code></pre></div>
<p><img src="04_tests_files/figure-html/unnamed-chunk-3-1.png" width="80%" style="display: block; margin: auto;" />
To order the months correctly, we need to make the “birthmonth” variable a <em>factor</em> (a categorical variable), and order the levels:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we can make use of month.abb which is the abbreviated months in R</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>month.abb</span></code></pre></div>
<pre><code>##  [1] &quot;Jan&quot; &quot;Feb&quot; &quot;Mar&quot; &quot;Apr&quot; &quot;May&quot; &quot;Jun&quot; &quot;Jul&quot; &quot;Aug&quot; &quot;Sep&quot; &quot;Oct&quot; &quot;Nov&quot; &quot;Dec&quot;</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># but we want them all lower case:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tolower</span>(month.abb)</span></code></pre></div>
<pre><code>##  [1] &quot;jan&quot; &quot;feb&quot; &quot;mar&quot; &quot;apr&quot; &quot;may&quot; &quot;jun&quot; &quot;jul&quot; &quot;aug&quot; &quot;sep&quot; &quot;oct&quot; &quot;nov&quot; &quot;dec&quot;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This is one way to do it</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>survey_data<span class="sc">$</span>birthmonth <span class="ot">&lt;-</span> <span class="fu">factor</span>(survey_data<span class="sc">$</span>birthmonth, <span class="at">levels =</span> <span class="fu">tolower</span>(month.abb), <span class="at">ordered=</span>T)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># and this is another (the tidyverse way):</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>survey_data <span class="ot">&lt;-</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  survey_data <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">birthmonth =</span> <span class="fu">fct_relevel</span>(<span class="fu">factor</span>(birthmonth), <span class="fu">tolower</span>(month.abb))</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p>Now when we plot it, they’re in the right order!</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> survey_data, <span class="fu">aes</span>(<span class="at">x =</span> birthmonth)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;- Birth Month -&quot;</span>)</span></code></pre></div>
<p><img src="04_tests_files/figure-html/unnamed-chunk-5-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question A2
</div>
<div class="question-body">
<p>We’re going to perform a statistical test to assess the extent to which our data conforms to the hypothesis that people are no more likely to be born on one month than another.</p>
<p>Under this hypothesis, what would be the proportional breakdown of observed births in each of the months?</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-45" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-45&#39;, &#39;sol-start-45&#39;)"> Solution </span>
</div>
<div id="sol-body-45" class="solution-body" style="display: none;">
<p>If people are no more likely to be born in one month than another, then we would expect the same proportion of observed births in each month.<br />
There are 12 months, so we would expect <span class="math inline">\(\frac{1}{12}\)</span> observations in each month.</p>
<p>We can write these as:
<span class="math display">\[
\begin{align}
&amp; p_{jan} = 1/12 \\
&amp; p_{feb} = 1/12 \\
&amp; ... \\
&amp; p_{dec} = 1/12 \\
\end{align}
\]</span></p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question A3
</div>
<div class="question-body">
<p>Given that there are there are 390 people who entered their birth-month, how many observations would we <em>expect</em> to find with a birthday in January? And in February? … and so on?</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-46" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-46&#39;, &#39;sol-start-46&#39;)"> Solution </span>
</div>
<div id="sol-body-46" class="solution-body" style="display: none;">
<p>We would expect <span class="math inline">\(\frac{1}{12} \times\)</span> 390 = 32.5 observations in each month.</p>
</div>
<p class="solution-end">
</p>
<div class="statbox">
<p>The test procedure we are about to apply is called a <strong>chi-square goodness-of-fit test</strong>.</p>
<p>It applies to a categorical variable, and the null hypothesis asserts specific values for the population proportion in each category. The alternative hypothesis simply states that at least one of the population proportions is not as specified in the null hypothesis.</p>
<p>As always, the test statistic measures how far the observed sample results deviate from what is expected if the null hypothesis is true. With a chi-square test, you construct the test statistic by comparing the <strong>observed sample counts</strong> in each category to the <strong>expected counts</strong> under the null hypothesis.</p>
<p>The test-statistic (denoted <span class="math inline">\(\chi^2\)</span>, spelled <em>chi-square</em>, pronounced “kai-square”) is obtained by adding up the standardized squared deviations in each category:<br />
<span class="math display">\[
\chi^2 = \sum_{i} \frac{(\text{Observed}_i - \text{Expected}_i)^2}{\text{Expected}_i}
\]</span></p>
</div>
<div class="question-begin">
Question A4
</div>
<div class="question-body">
<p>The code below creates counts for each month:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>survey_data <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(birthmonth) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">observed =</span> <span class="fu">n</span>()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p>(A shortcut for this would be <code>survey_data %&gt;% count(birthmonth)</code>)</p>
<p>Add to the code above to create columns showing:</p>
<ul>
<li>the expected counts <span class="math inline">\(E_i\)</span></li>
<li>observed-expected (<span class="math inline">\(O_i - E_i\)</span>)</li>
<li>the squared differences <span class="math inline">\((O_i - E_i)^2\)</span></li>
<li>the standardised square differences <span class="math inline">\(\frac{(O_i - E_i)^2}{E_i}\)</span></li>
</ul>
<p>Then calculate the <span class="math inline">\(\chi^2\)</span> statistic (the sum of the standardised squared differences).<br />
If your observed counts matched the expected counts <em>perfectly</em>, what would the <span class="math inline">\(\chi^2\)</span> statistic be?</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-47" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-47&#39;, &#39;sol-start-47&#39;)"> Solution </span>
</div>
<div id="sol-body-47" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the nrow() function tells us how many rows there are in the dataset!</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>totaln <span class="ot">&lt;-</span> <span class="fu">nrow</span>(survey_data)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>chi_table <span class="ot">&lt;-</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    survey_data <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(birthmonth) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">observed =</span> <span class="fu">n</span>(),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">expected =</span> totaln<span class="sc">/</span><span class="dv">12</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">diff =</span> observed<span class="sc">-</span>expected,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">sq_diff =</span> diff<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">std_sq_diff =</span> sq_diff <span class="sc">/</span> expected</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>chi_table</span></code></pre></div>
<pre><code>## # A tibble: 12 × 6
##    birthmonth observed expected  diff sq_diff std_sq_diff
##    &lt;ord&gt;         &lt;int&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;
##  1 jan              36     32.5   3.5   12.2      0.377  
##  2 feb              30     32.5  -2.5    6.25     0.192  
##  3 mar              31     32.5  -1.5    2.25     0.0692 
##  4 apr              23     32.5  -9.5   90.2      2.78   
##  5 may              32     32.5  -0.5    0.25     0.00769
##  6 jun              31     32.5  -1.5    2.25     0.0692 
##  7 jul              34     32.5   1.5    2.25     0.0692 
##  8 aug              32     32.5  -0.5    0.25     0.00769
##  9 sep              36     32.5   3.5   12.2      0.377  
## 10 oct              38     32.5   5.5   30.2      0.931  
## 11 nov              36     32.5   3.5   12.2      0.377  
## 12 dec              31     32.5  -1.5    2.25     0.0692</code></pre>
<p>And we can calculate our <span class="math inline">\(\chi^2\)</span> test statistic by simply summing the values in the last column we created:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(chi_table<span class="sc">$</span>std_sq_diff)</span></code></pre></div>
<pre><code>## [1] 5.323077</code></pre>
<p>If all our observed counts are equal to our expected counts, then the <code>diff</code> column above will be all <span class="math inline">\(0\)</span>, and <span class="math inline">\(0^2=0\)</span>, and <span class="math inline">\(\frac{0}{E_i}\)</span> will be <span class="math inline">\(0\)</span>. So <span class="math inline">\(\chi^2\)</span> will be <span class="math inline">\(0\)</span>.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question A5
</div>
<div class="question-body">
You can see the distribution of <span class="math inline">\(\chi^2\)</span> distributions with different degrees of freedom below.<br />

<div class="figure" style="text-align: center"><span id="fig:chidist"></span>
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Chi-square_pdf.svg/1200px-Chi-square_pdf.svg.png" alt="Chi-Square Distributions" width="80%" />
<p class="caption">
Figure 1: Chi-Square Distributions
</p>
</div>
<p>We can find out the proportion of the distribution which falls to either side of a given value of <span class="math inline">\(\chi^2\)</span> using <code>pchisq()</code>. We need to give it our calculated <span class="math inline">\(\chi^2\)</span> statistic, our degrees of freedom (<code>df</code>), which is equal to the number of categories minus 1. We also need to specify whether we want the proportion to the left (<code>lower.tail=TRUE</code>) or to the right (<code>lower.tail=FALSE</code>).</p>
<ol style="list-style-type: decimal">
<li>Using <code>pchisq()</code>, calculate the probability of observing a <span class="math inline">\(\chi^2\)</span> statistic as least as extreme as the one we have calculated.<br />
</li>
<li>Check that these results match with those provided by R’s built-in function: <code>chisq.test(table(survey_data$birthmonth))</code>.</li>
</ol>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-48" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-48&#39;, &#39;sol-start-48&#39;)"> Solution </span>
</div>
<div id="sol-body-48" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(chi_table<span class="sc">$</span>std_sq_diff)</span></code></pre></div>
<pre><code>## [1] 5.323077</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="fu">sum</span>(chi_table<span class="sc">$</span>std_sq_diff), <span class="at">df =</span> <span class="dv">11</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.9145164</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(survey_data<span class="sc">$</span>birthmonth))</span></code></pre></div>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  table(survey_data$birthmonth)
## X-squared = 5.3231, df = 11, p-value = 0.9145</code></pre>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question A6
</div>
<div class="question-body">
<p>Which months of year had the highest contributions to the chi-square test statistic?</p>
<p><em>Hint:</em> think about your standardised squared deviations.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-49" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-49&#39;, &#39;sol-start-49&#39;)"> Solution </span>
</div>
<div id="sol-body-49" class="solution-body" style="display: none;">
<p><strong>Standardized squared deviations</strong></p>
<p>One possible way to answer this question is to look at the individual contribution of each category to the <span class="math inline">\(\chi^2\)</span> statistic. We computed these values in Question A4.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>chi_table <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(birthmonth, std_sq_diff)</span></code></pre></div>
<pre><code>## # A tibble: 12 × 2
##    birthmonth std_sq_diff
##    &lt;ord&gt;            &lt;dbl&gt;
##  1 jan            0.377  
##  2 feb            0.192  
##  3 mar            0.0692 
##  4 apr            2.78   
##  5 may            0.00769
##  6 jun            0.0692 
##  7 jul            0.0692 
##  8 aug            0.00769
##  9 sep            0.377  
## 10 oct            0.931  
## 11 nov            0.377  
## 12 dec            0.0692</code></pre>
<p>From the barplot we created earlier on, we can see which months make up higher/lower proportions than expected:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(chi_table, <span class="fu">aes</span>(<span class="at">x =</span> birthmonth, <span class="at">y =</span> observed<span class="sc">/</span><span class="fu">nrow</span>(survey_data))) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&#39;lightblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">15</span>)</span></code></pre></div>
<p><img src="04_tests_files/figure-html/unnamed-chunk-12-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><strong>Pearson residuals</strong></p>
<p>Equivalently, you could answer by looking at Pearson residuals:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(survey_data<span class="sc">$</span>birthmonth))<span class="sc">$</span>residuals</span></code></pre></div>
<pre><code>## 
##        jan        feb        mar        apr        may        jun        jul 
##  0.6139406 -0.4385290 -0.2631174 -1.6664102 -0.0877058 -0.2631174  0.2631174 
##        aug        sep        oct        nov        dec 
## -0.0877058  0.6139406  0.9647638  0.6139406 -0.2631174</code></pre>
<p>The greatest <em>absolute</em> values are for apr and oct, showing that for these months the deviations from expected to observed were the greatest.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question A7
</div>
<div class="question-body">
<p>According to the internet (that reliable source of information!), 76% of people in the world have brown eyes, 10% have blue, 5% hazel, 5% amber, 2% green, 1% grey, and 1% have some other eye colouring (red/violet/heterochromia).</p>
<p>Perform a <span class="math inline">\(\chi^2\)</span> goodness of fit test to assess the extent to which our sample of students conform to this theorised distribution of eye-colours.</p>
<ul>
<li><em>Hint:</em> <code>chisq.test(..., p = c(?,?,?,...) )</code>.</li>
</ul>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-50" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-50&#39;, &#39;sol-start-50&#39;)"> Solution </span>
</div>
<div id="sol-body-50" class="solution-body" style="display: none;">
<p>Let’s look at the observed counts:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(survey_data<span class="sc">$</span>eyecolour)</span></code></pre></div>
<pre><code>## 
## amber  blue brown green  grey hazel other 
##     3    92   176    52     8    43    15</code></pre>
<p>Our theoretical probabilities of different eye colours must match the order in the table which we give <code>chisq.test()</code>. They must also always sum to 1.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(survey_data<span class="sc">$</span>eyecolour), <span class="at">p =</span> <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">1</span>,.<span class="dv">76</span>,.<span class="dv">02</span>,.<span class="dv">01</span>,.<span class="dv">05</span>,.<span class="dv">01</span>))</span></code></pre></div>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  table(survey_data$eyecolour)
## X-squared = 450.74, df = 6, p-value &lt; 2.2e-16</code></pre>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question A8
</div>
<div class="question-body">
<p>What are the <em>observed</em> proportions of our sample with each eyecolour?<br />
Can you figure out how to use the <code>prop.table()</code> function?</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-51" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-51&#39;, &#39;sol-start-51&#39;)"> Solution </span>
</div>
<div id="sol-body-51" class="solution-body" style="display: none;">
<p>From the help documentation (<code>?prop.table()</code>), we see that we can pass <code>prop.table()</code> the argument <code>x</code>, which needs to be a table.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(survey_data<span class="sc">$</span>eyecolour))<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## 
##      amber       blue      brown      green       grey      hazel      other 
##  0.7712082 23.6503856 45.2442159 13.3676093  2.0565553 11.0539846  3.8560411</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(survey_data<span class="sc">$</span>eyecolour))<span class="sc">*</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="04_tests_files/figure-html/unnamed-chunk-18-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<p class="solution-end">
</p>
</div>
<div id="chi2-test-of-independence" class="section level1">
<h1><span class="math inline">\(\chi^2\)</span> Test of Independence</h1>
<div class="frame">
<blockquote>
<p><strong>Research Question:</strong> Can telling a joke affect whether or not a waiter in a coffee bar receives a tip from a customer?<br />
A <a href="https://doi.org/10.1111/j.1559-1816.2002.tb00266.x">study</a> published in the Journal of Applied Social Psychology<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> investigated this question at a coffee bar of a famous seaside resort on the west Atlantic coast of France.
The waiter randomly assigned coffee-ordering customers to one of three groups.
When receiving the bill, one group also received a card telling a joke, another group received a card containing an advertisement for a local restaurant, and a third group received no card at all.</p>
</blockquote>
<p>The data are available at <a href="https://uoepsy.github.io/data/TipJoke.csv" class="uri">https://uoepsy.github.io/data/TipJoke.csv</a>.<br />
The dataset contains the variables:</p>
<ul>
<li><code>Card</code>: None, Joke, Ad.</li>
<li><code>Tip</code>: 1 = The customer left a tip, 0 = The customer did not leave tip.</li>
</ul>
</div>
<div class="question-begin">
Question B1
</div>
<div class="question-body">
<p>Produce a plot and a table to display the relationship between whether or not the customer left a tip, and what (if any) card they received alongside the bill.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-52" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-52&#39;, &#39;sol-start-52&#39;)"> Solution </span>
</div>
<div id="sol-body-52" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>tipjoke <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://uoepsy.github.io/data/TipJoke.csv&#39;</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tipjoke<span class="sc">$</span>Card, tipjoke<span class="sc">$</span>Tip)</span></code></pre></div>
<pre><code>##       
##         0  1
##   Ad   60 14
##   Joke 42 30
##   None 49 16</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(tipjoke<span class="sc">$</span>Card, tipjoke<span class="sc">$</span>Tip))</span></code></pre></div>
<p><img src="04_tests_files/figure-html/unnamed-chunk-19-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question B2
</div>
<div class="question-body">
<p>What would you <em>expect</em> the cell counts to look like if there were no relationship between what the waiter left and whether or not the customer tipped?</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-53" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-53&#39;, &#39;sol-start-53&#39;)"> Solution </span>
</div>
<div id="sol-body-53" class="solution-body" style="display: none;">
<p>In total, 60 customers tipped (14+30+16), and 151 did not. So <em>overall</em>, 0.28 (<span class="math inline">\(\frac{60}{(60+151)}\)</span>) of customers tip.</p>
<p>74 customers got an Ad card, 72 customers got a Joke, and 65 got None. If this were independent of whether or not they left a tip, we would expect equal proportions of tippers in each group.<br />
So we would expect 0.28 of each group to leave a tip.</p>
You can think about observed vs expected by looking at the two-way table along with the marginal row and column totals given:<br />

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
0
</th>
<th style="text-align:left;">
1
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Ad
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
74
</td>
</tr>
<tr>
<td style="text-align:left;">
Joke
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
72
</td>
</tr>
<tr>
<td style="text-align:left;">
None
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
65
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
151
</td>
<td style="text-align:left;">
60
</td>
<td style="text-align:left;">
211
</td>
</tr>
</tbody>
</table>
<p>For a given cell of the table we can calculate the expected count as <span class="math inline">\(\text{row total} \times \frac{\text{column total}}{\text{samplesize}}\)</span>:</p>
<strong>Expected:</strong>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
0
</th>
<th style="text-align:right;">
1
</th>
<th style="text-align:right;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Ad
</td>
<td style="text-align:right;">
52.96
</td>
<td style="text-align:right;">
21.04
</td>
<td style="text-align:right;">
74
</td>
</tr>
<tr>
<td style="text-align:left;">
Joke
</td>
<td style="text-align:right;">
51.53
</td>
<td style="text-align:right;">
20.47
</td>
<td style="text-align:right;">
72
</td>
</tr>
<tr>
<td style="text-align:left;">
None
</td>
<td style="text-align:right;">
46.52
</td>
<td style="text-align:right;">
18.48
</td>
<td style="text-align:right;">
65
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
151.00
</td>
<td style="text-align:right;">
60.00
</td>
<td style="text-align:right;">
211
</td>
</tr>
</tbody>
</table>
<p>(If you’re wondering how we do this in R, we saw in the lectures briefly a complicated bit of code using <code>%o%</code> which could do this for us):</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> tipjoke <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Card, Tip) <span class="sc">%&gt;%</span> <span class="fu">table</span>()</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(t) <span class="sc">%o%</span> <span class="fu">colSums</span>(t) <span class="sc">/</span> <span class="fu">sum</span>(t)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>e</span></code></pre></div>
<pre><code>##             0        1
## Ad   52.95735 21.04265
## Joke 51.52607 20.47393
## None 46.51659 18.48341</code></pre>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question B3
</div>
<div class="question-body">
<p>Just like we gave the <code>chisq.test()</code> function a table of observed frequencies when we conducted a goodness of fit test in earlier exercises, we can give it a two-way table of observed frequencies to conduct a test of independence.</p>
<p>Try it now.</p>
<blockquote>
<p><strong>Why is the degrees of freedom 2 (df = 2)?</strong><br />
Degrees of freedom for a <span class="math inline">\(\chi^2\)</span> test of independence is calculated as:<br />
<span class="math display">\[
\begin{align}
&amp; df = (r - 1)(c - 1) \\
&amp; \text{Where:} \\
&amp; r = \text{number of rows} \\
&amp; c = \text{number of columns} \\
\end{align}
\]</span>
Why? Well, remember that the degrees of freedom is the number of values that are <em>free to vary</em> as we estimate parameters. In a <span class="math inline">\(3 \times 2\)</span> table like the one we have for Cards <span class="math inline">\(\times\)</span> Tips, the degrees of freedom is the number of cells in the table that can vary before we can simply calculate the values of the other cells (where we’re constrained by the need to sum to our row/column totals).</p>
</blockquote>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-54" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-54&#39;, &#39;sol-start-54&#39;)"> Solution </span>
</div>
<div id="sol-body-54" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(tipjoke<span class="sc">$</span>Card, tipjoke<span class="sc">$</span>Tip))</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  table(tipjoke$Card, tipjoke$Tip)
## X-squared = 9.9533, df = 2, p-value = 0.006897</code></pre>
</div>
<p class="solution-end">
</p>
</div>
<div id="more-rmarkdown" class="section level1">
<h1>More RMarkdown</h1>
<div class="question-begin">
Question
</div>
<div class="question-body">
<p>Can you create an RMarkdown document which:</p>
<ol style="list-style-type: decimal">
<li>Reads in the <a href="https://uoepsy.github.io/data/TipJoke.csv" class="uri">https://uoepsy.github.io/data/TipJoke.csv</a> data.</li>
<li>Conducts and reports a <span class="math inline">\(\chi^2\)</span> test of independence examining whether telling a joke affect whether or not a waiter in a coffee bar receives a tip from a customer.</li>
<li>Successfully compiles (“knits”) into an <strong>.html</strong> file.</li>
</ol>
</div>
<p class="question-end">
</p>
</div>
<div id="revisiting-nhst" class="section level1">
<h1>Revisiting NHST</h1>
<p>Now that you have performed a number of different types of statistical hypothesis test, it is worth revisiting the general concept in order to consolidate what you’ve been doing.</p>
<ul>
<li>Step 1. We have been starting by considering what a given statistic is <em>likely to be</em> if a given hypothesis (the null) were true.
<ul>
<li>For the <span class="math inline">\(t\)</span>-tests, if the null hypothesis is true (there is no difference between group means/between our observed mean and some value), then our <span class="math inline">\(t\)</span>-statistics (if we could do our study loads of times) will mainly fall around 0, and follow a <span class="math inline">\(t\)</span>-distribution. The precise <span class="math inline">\(t\)</span>-distribution depends on the degrees of freedom, which in turn depends on how much data we have.<br />
</li>
<li>For the <span class="math inline">\(\chi^2\)</span> tests, if the null hypothesis is true and there is no difference between the observed and expected frequencies, then our <span class="math inline">\(\chi^2\)</span>-statistics will follow the <span class="math inline">\(\chi^2\)</span> distribution (i.e., with 2 categories, most of them will be between 0 and 2, with fewer falling &gt;2, see the yellow line in Figure <a href="#fig:chidist">1</a>).<br />
</li>
</ul></li>
<li>Step 2. We calculate our statistic from our <em>observed</em> data.</li>
<li>Step 3. We ask what the probability is of getting a statistic at least as extreme as we get from Step 2, assuming the null hypothesis we stated in Step 1.</li>
</ul>
<div class="lo">
<p><strong>If you’re finding the programming easy, but the statistical concepts difficult</strong></p>
<p>Another way which <em>might</em> help to think about this is that if we can make a computer do something over and over again, we can do stats! You may already be familiar with this idea from exercises with the function <code>replicate()</code>!</p>
<div style="width:60%; display: inline-block">
<ol style="list-style-type: decimal">
<li>make the computer generate random data, based on some null hypothesis. Do it lots of times.</li>
</ol>
</div>
<div style="width:35%; display: inline-block; vertical-align:top">
<p><img src="images/moretests/playmo_investors.jpg" width="80%" style="display: block; margin: auto;" /></p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>what proportion of the simulations produce results similar to the observed data (i.e., as extreme or more extreme)? This is <span class="math inline">\(p\)</span>. The only difference between this and “statistics” is that we calculate <span class="math inline">\(p\)</span> using math, rather than having to generate random data.</li>
</ol>
</div>
</div>
<div id="statistical-vs-practical-significance" class="section level1">
<h1>Statistical vs Practical Significance</h1>
<div class="question-begin">
Question C1
</div>
<div class="question-body">
<p>An agricultural company is testing out a new fertiliser they have developed to improve tomato growth.</p>
<p>They plant 1000 seeds (taken from the same tomato plant) in the same compost and place them in positions with the same amount of sunlight. 500 of the plants receive 100ml of water daily, and the other 500 receive a 100ml of the fertiliser mixed with water. After 100 days, they measure the height of all the tomato plants (in cm).</p>
<p>You can find the data at <a href="https://uoepsy.github.io/data/tomatogrowth.csv" class="uri">https://uoepsy.github.io/data/tomatogrowth.csv</a>.</p>
<p>Conduct the appropriate test to determine whether the fertiliser provides a statistically significant improvement to tomato plant growth.</p>
<p><img src="images/moretests/playmotom.jpg" width="70%" style="display: block; margin: auto;" /></p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-55" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-55&#39;, &#39;sol-start-55&#39;)"> Solution </span>
</div>
<div id="sol-body-55" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>tomato <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://uoepsy.github.io/data/tomatogrowth.csv&quot;</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tomato)</span></code></pre></div>
<pre><code>##      height         group          
##  Min.   : 84.8   Length:1000       
##  1st Qu.:109.3   Class :character  
##  Median :116.0   Mode  :character  
##  Mean   :115.8                     
##  3rd Qu.:123.1                     
##  Max.   :144.8</code></pre>
<p>Our alternative hypothesis is that the difference in means <span class="math inline">\((treatment - control)\)</span> is greater than 0 (i.e., it improves growth). The <code>t.test()</code> function will use alphabetical ordering of the <code>group</code> variable, so if we say <code>alternative="less"</code> then it is the direction we want <span class="math inline">\((control - treatment &lt; 0)\)</span>:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(tomato<span class="sc">$</span>height <span class="sc">~</span> tomato<span class="sc">$</span>group, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  tomato$height by tomato$group
## t = -2.0085, df = 997.97, p-value = 0.02243
## alternative hypothesis: true difference in means between group control and group treatment is less than 0
## 95 percent confidence interval:
##        -Inf -0.2296311
## sample estimates:
##   mean in group control mean in group treatment 
##                115.1955                116.4692</code></pre>
<p>Or, we can set the order by making it a factor and setting the <code>levels</code>:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>tomato <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(group, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;treatment&quot;</span>,<span class="st">&quot;control&quot;</span>))</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>) <span class="ot">-&gt;</span> tomato</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(tomato<span class="sc">$</span>height <span class="sc">~</span> tomato<span class="sc">$</span>group, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  tomato$height by tomato$group
## t = 2.0085, df = 997.97, p-value = 0.02243
## alternative hypothesis: true difference in means between group treatment and group control is greater than 0
## 95 percent confidence interval:
##  0.2296311       Inf
## sample estimates:
## mean in group treatment   mean in group control 
##                116.4692                115.1955</code></pre>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question C2
</div>
<div class="question-body">
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-29"></span>
<img src="04_tests_files/figure-html/unnamed-chunk-29-1.png" alt="Relationship between tomato plant height and crop yield" width="80%" />
<p class="caption">
Figure 2: Relationship between tomato plant height and crop yield
</p>
</div>
<p>Consider the above plot. For every 5cm taller a tomato plant is, it tends to provide 1 more tomato.<br />
Now consider the agricultural company’s situation in the previous question. Given that the fertiliser is comparitively pricey for them to manufacture, is it worth putting into production?</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-56" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-56&#39;, &#39;sol-start-56&#39;)"> Solution </span>
</div>
<div id="sol-body-56" class="solution-body" style="display: none;">
<p>While the fertiliser does improve plant growth to a statistically significant (at <span class="math inline">\(\alpha=0.05\)</span>) degree, the improvement is minimal. The difference in means is only 1.2737, which would result in about 1/4 of a tomato per plant.</p>
<p>Furthermore, if we take a look at the <em>confidence interval</em> provided by the <code>t.test()</code> function, we can see that a plausible value for the <em>true difference</em> in means is 0.23cm, which is tiny!</p>
</div>
<p class="solution-end">
</p>
<div id="things-to-think-about" class="section level2">
<h2>Things to think about</h2>
<p>The above exercises are aimed to demonstrate that whether or not our p-value is below some set criteria (e.g., .05, .01, .001) is only a small part of the picture. There are many things which are good to remember about p-values:</p>
<ol style="list-style-type: decimal">
<li><p>With a big enough sample size, even a tiny tiny effect is detectable at &lt;.05. For example, you might be interested in testing if the difference in population means across two groups is 0 (<span class="math inline">\(\mu_1 - \mu_2 = 0\)</span>. Your calculated sample difference could be <span class="math inline">\(\bar{x}_1 - \bar{x}_2 = 0.00002\)</span> but with a very small p-value of 0.00000001. This would tell you that there is strong evidence that the observed difference in means (0.00002) is significantly different from 0. However, the practical difference, that is - the magnitude of the distance between 0.00002 and 0 - is negligible and of pretty much no interest to practitioners. This is the idea we saw in the tomato-plant example.</p></li>
<li><p>The criteria (<span class="math inline">\(\alpha\)</span>) which we set (at .05, .01, etc.), is <em>arbitrary</em>.<br />
Two things need to be kept in mind: there is the true status of the world (which is unknown to us) and the collected data (which are available and reveal the truth only in part).<br />
An observed p-value smaller than the chosen alpha does not imply the true presence of an effect. The observed difference might be due to sampling variability.<br />
</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-30"></span>
<img src="images/moretests/samples.png" alt="Two possible samples (blue dots) drawn from two populations with same mean. On the left, the selected sample shows a big difference. On the right, the sample shows no difference. Samples such as that on the left are very unlikely to happen (e.g., 5% of the time). It is for these unlikely samples that we would reject the null hypothesis incorrectly 5% of the time." width="80%" />
<p class="caption">
Figure 3: Two possible samples (blue dots) drawn from two populations with same mean. On the left, the selected sample shows a big difference. On the right, the sample shows no difference. Samples such as that on the left are very unlikely to happen (e.g., 5% of the time). It is for these unlikely samples that we would reject the null hypothesis incorrectly 5% of the time.
</p>
</div></li>
<li><p>Even if a null hypothesis about the population is actually true, then 5% (if <span class="math inline">\(\alpha\)</span> = 0.05) of the test-statistics computed on different samples from that population would result in a p-value &lt;.05. If you were to obtain 100 random samples from that population, five out of the 100 p-values are likely to be &lt;.05 <em>even if the null hypothesis about the population was actually true</em>.</p></li>
<li><p>If you have a single dataset, and you perform several tests of hypotheses on those data, each test comes with a probability of incorrectly rejecting the null (making a <em>type I error</em>) of 5%. Hence, considering the entire family of tests computed, your overall type I error probability will be larger than 5%. In simple words, this means that if you perform enough tests on the same data, you’re almost sure to reject one of the null hypotheses by mistake. This concept is known as <strong>multiple comparisons</strong>.</p></li>
</ol>
</div>
</div>
<div id="further-reading" class="section level1">
<h1>Further reading</h1>
<p>There are many different competing approaches to doing statistical analyses.<br />
In this course we are learning about what is known as the <em>frequentist</em> framework. Roughly speaking, this is where probabilities are defined as “long-run frequencies” (i.e., the probability of <span class="math inline">\(x\)</span> happening over many many trials<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>). Even within the <em>frequentist</em> approach, there are different views as to how to how this definition of probability is best utilised.</p>
<p>The following links provide some introductory readings to some of the different schools of thought:</p>
<ol style="list-style-type: decimal">
<li><p><a href="https://www.frontiersin.org/articles/10.3389/fpsyg.2015.00223/full">Perezgonzalez, J. D. (2015). Fisher, Neyman-Pearson or NHST? A tutorial for teaching data testing. Frontiers in Psychology, 6, 223.</a></p></li>
<li><p><a href="https://www.tandfonline.com/doi/full/10.1080/00031305.2018.1518266">Calin-Jageman, R. J., &amp; Cumming, G. (2019). The new statistics for better science: ask how much, how uncertain, and what else is known. The American Statistician, 73(sup1), 271-280.</a></p></li>
<li><p><a href="https://thenewstatistics.com/itns/2019/05/20/reply-to-lakens-the-correctly-used-p-value-needs-an-effect-size-and-ci/">The correctly-used p value needs an effect size and CI</a> - don’t worry too much about the background of this blog, but it offers some useful visualisations to show how important it is to remember about the uncertainty in our estimates.</p></li>
</ol>
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;">

</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Gueaguen, N. (2002). The Effects of a Joke on Tipping When It Is Delivered at the Same Time as the Bill. <em>Journal of Applied Social Psychology, 32</em>(9), 1955-1963.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>For those of you who are interested in what alternative definitions there are, do a google search for “frequentist vs bayesian.” Be prepared that this will open a big can of worms!<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

<div>
  <hr/>
  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br/>
  This workbook was written by Josiah King, Umberto Noe, and Martin
  Corley, and is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
