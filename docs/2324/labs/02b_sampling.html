<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>USMR - 2B: Curves &amp; Sampling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-circle-right')) {
    f.classList.add('fa-circle-down')
    f.classList.remove('fa-circle-right')
} else {
    f.classList.add('fa-circle-right')
    f.classList.remove('fa-circle-down')
}
}
</script>

<script src="https://kit.fontawesome.com/120b08a6f5.js" crossorigin="anonymous"></script>
<link href="site_libs/panelset-0.2.6/panelset.css" rel="stylesheet">
<script src="site_libs/panelset-0.2.6/panelset.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02a_measurement.html">Week 2</a></li><li class="breadcrumb-item"><a href="./02b_sampling.html">2B: Curves &amp; Sampling</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">USMR</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Week 1</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01a_R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1A: A first look at R &amp; RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01b_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1B: More R - Basic Data Skills</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises: Intro R</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Week 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02a_measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2A: Measurement &amp; Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02b_sampling.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">2B: Curves &amp; Sampling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises: More R; Estimates &amp; Intervals</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Week 3</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03a_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3A: Foundations of Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03b_inference2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3B: Practical Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises: T-tests</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Week 4</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04a_chisq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4A: Chi-Square Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04b_revisitnhst.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4B: Revisiting NHST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises: Chi-Square Tests</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Week 5</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Week 6</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Week 7</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Week 8</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Week 9</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Week 10</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Week 11</span></span>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#probability-distributions" id="toc-probability-distributions" class="nav-link active" data-scroll-target="#probability-distributions">Probability distributions</a></li>
  <li><a href="#normal-distributions" id="toc-normal-distributions" class="nav-link" data-scroll-target="#normal-distributions">Normal distributions</a>
  <ul class="collapse">
  <li><a href="#the-standard-normal-distribution" id="toc-the-standard-normal-distribution" class="nav-link" data-scroll-target="#the-standard-normal-distribution">The Standard Normal Distribution</a></li>
  <li><a href="#the-relevance-of-the-normal-distribution" id="toc-the-relevance-of-the-normal-distribution" class="nav-link" data-scroll-target="#the-relevance-of-the-normal-distribution">The relevance of the normal distribution?</a></li>
  </ul></li>
  <li><a href="#sampling-sampling-distributions" id="toc-sampling-sampling-distributions" class="nav-link" data-scroll-target="#sampling-sampling-distributions">Sampling &amp; Sampling Distributions</a></li>
  <li><a href="#standard-error-in-practice" id="toc-standard-error-in-practice" class="nav-link" data-scroll-target="#standard-error-in-practice">Standard Error in practice</a></li>
  <li><a href="#central-limit-theorem-clt" id="toc-central-limit-theorem-clt" class="nav-link" data-scroll-target="#central-limit-theorem-clt">Central Limit Theorem (CLT)</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals">Confidence Intervals</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">2B: Curves &amp; Sampling</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="lo">
<p>This reading:</p>
<ul>
<li>What are probability distributions and why are they relevant?<br>
</li>
<li>How does using a sample to approximate a population lead to uncertainty?</li>
<li>How can we quantify uncertainty due to sampling?</li>
</ul>
</div>
<section id="probability-distributions" class="level1">
<h1>Probability distributions</h1>
<p>We’ve seen some ways of describing and visualising the distributions of variables that we might observe when we collect data. Such a collection of observations on a single variable is often termed a “sample distribution”.</p>
<p>Another type of distribution that will prove to be very useful is a “probability distribution”.</p>
<div class="sticky">
<p>A probability distribution is the (mathematical) description of the probabilities of occurrences of observing the different possible outcomes.</p>
</div>
<p>Note an important jump we are making is that we are moving from talking about distributions that we <em>observe</em>, to something more conceptual. Typically, this is because we want to talk more generally about the underlying process which generates the data.</p>
<p>For example, the function that governs the behaviour of rolling a single die is <strong>uniform</strong> in that each possible response has an equal probability (<span class="math inline">\(\frac{1}{6}\)</span>) of being observed (below left). When we <em>collect</em> data by actually rolling a die 100 times, we will observe a sample distribution (below right).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02b_sampling_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<div class="statbox">
<p><strong>Uniformity</strong></p>
<p>When an equal probability is assigned to each possible response, we have what is known as the <strong>uniform distribution</strong>.<br>
For a fair 6-sided die, the probability of the die landing on each side is 1/6, and the probabilities of all the possible responses sum to 1 (because it has to land on <em>one of</em> the sides).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02b_sampling_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
<p>The dice-rolling example is one involving a categorical distribution - i.e.&nbsp;data which has a discrete set of response options. We don’t have to use a 6-sided die - if it follows a uniform probability distribution, and there are <span class="math inline">\(n\)</span> possible responses, then the probability of each response ocurring is <span class="math inline">\(1/n\)</span>.</p>
<p>However, the uniform probability distribution can be relevant for a continuous numeric variable as well (e.g.&nbsp;something which as well as taking the values 4 and 5 can also take 4.1, 4.11, 4.1111111111, 4.764968473 etc.. - they can take <em>any</em> real value). We can preserve the idea that probability sums to 1 for this sort of variable by having the probability as <span class="math inline">\(\frac{1}{b-a}\)</span>, where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are the lower and upper bounds of the response domain. Why? Because this makes the <strong>area</strong> of the distribution equal to 1 (area of a rectangle = width <span class="math inline">\(\times\)</span> height. <span class="math inline">\((b-a) \times \frac{1}{(b-a)} = \frac{b-a}{b-a} = 1)\)</span>. This means we can compute areas of parts of the distribution in order to calculate probabilities!</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02b_sampling_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="divider div-transparent div-dot">

</div>
</section>
<section id="normal-distributions" class="level1">
<h1>Normal distributions</h1>
<p>We have actually already been talking about some of the parameters that define one of the most important probability distributions in statistics - what we call the “normal distribution”. Sometimes you will hear it referred to as a “bell curve” due to its resemblance to the shape of a bell (<a href="#fig-basicnormal">Figure&nbsp;1</a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-basicnormal" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02b_sampling_files/figure-html/fig-basicnormal-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1: The ‘bell-shaped’ normal distribution. Mean, median and mode are all at the apex of the curve</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="02a_measurement.html#histograms">the previous section</a> we started to visualise sample distributions that looked similar to this (i.e.&nbsp;roughly bell-shaped), and we saw how the shape of such distributions depends on parameters such as the mean and variance/standard deviation<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> (see <a href="#fig-bellsd">Figure&nbsp;2</a>).</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>wechsler <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/wechsler.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> wechsler, <span class="fu">aes</span>(<span class="at">x =</span> test1)) <span class="sc">+</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()<span class="sc">+</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> wechsler, <span class="fu">aes</span>(<span class="at">x =</span> test2)) <span class="sc">+</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()<span class="sc">+</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-bellsd" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02b_sampling_files/figure-html/fig-bellsd-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Scores on test 2 have a larger standard deviation, as seen in the distribution of test 2 being wider.</figcaption>
</figure>
</div>
</div>
</div>
<p>There are certain properties of normal distributions which we can exploit, in order to determine how plausible an observed value is relative to a distribution.</p>
<div class="sticky">
<p>When a distribution is normal (symmetric and bell-shaped):</p>
<ul>
<li>68% of values will lie within 1 standard deviation of the mean.</li>
<li>95% of values will lie within 1.96 standard deviations of the mean.</li>
<li>99.7% of values will lie within 3 standard deviations of the mean.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/hypothesis/normal.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Let’s return to the IQ data we saw in <a href="02a_measurement.html#histograms">2A #histograms</a>. We have our observed sample distribution of IQ scores:</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>wechsler <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/wechsler.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> wechsler, <span class="fu">aes</span>(<span class="at">x =</span> iq)) <span class="sc">+</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02b_sampling_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>We know how to address questions such as “what proportion of our sample has an IQ &gt;120?”. We can use the data we have to calculate the proportion:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of IQ scores greater than 120 divided by number of scores</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(wechsler<span class="sc">$</span>iq <span class="sc">&gt;</span> <span class="dv">120</span>) <span class="sc">/</span> <span class="fu">length</span>(wechsler<span class="sc">$</span>iq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.075</code></pre>
</div>
</div>
<p>This tells us that 0.075 (or 7.5%) of <strong>our sample</strong> has an IQ of more than 120.</p>
<p>We are using IQ as an example here because IQ scales are developed and updated in attempts to standardise the tests so that the scores have an average of 100 and a standard deviation of 15.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> If we think of these two parameters (mean of 100, standard deviation of 15) as defining the <em>expected</em> distribution of IQ scores, then we can ask the question:</p>
<p>“what is the <em>probability</em> of observing someone with an IQ &gt;120?”</p>
<p>What we’re asking here is for the amount of the normal distribution with mean = 100, sd = 15 that falls beyond 120 (<a href="#fig-iq120">Figure&nbsp;3</a>). Note that the distribution we’re talking about here is an abstract one that represents all the possible IQ scores that we <em>might</em> observe if we were to randomly sample the population.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-iq120" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02b_sampling_files/figure-html/fig-iq120-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3: what is the <em>probability</em> of observing someone with an IQ &gt;120?</figcaption>
</figure>
</div>
</div>
</div>
<div class="sticky">
<p><strong>Proportions and Probability</strong></p>
<ul>
<li>A probability is a representation of the chance of some event happening. It is theoretical, not observed.<br>
</li>
<li>A proportion is a summary of how frequently some event <em>actually</em> happened. It is something we observe.</li>
</ul>
</div>
<p>Years ago we would have to work out how many standard deviations this is above the mean (<span class="math inline">\(\frac{120 - 100}{15} = 1\frac{1}{3}\)</span>) and then look up in a <a href="https://en.wikipedia.org/wiki/Standard_normal_table#Cumulative_from_minus_infinity_to_Z" target="_blank">big table</a> to work out the probability of observing something which is 1.33 standard deviations above the mean.</p>
<p>Conveniently, there are some functions which can do this for us. The <code>pnorm()</code> function will give us the area to the left or right (depending on whether we put <code>lower.tail = TRUE/FALSE</code>) of a given number:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">120</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09121122</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pnorm1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02b_sampling_files/figure-html/fig-pnorm1-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4: pnorm() can be used to give us the area to the left/right of some value</figcaption>
</figure>
</div>
</div>
</div>
<p>The probability of observing IQ <strong>&lt;</strong>120 is easily obtained by changing the <code>lower.tail</code> argument:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">120</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9087888</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pnorm3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02b_sampling_files/figure-html/fig-pnorm3-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5: pnorm() can be used to get the area either side by changing the <code>lower.tail</code> argument</figcaption>
</figure>
</div>
</div>
</div>
<p>And we know that the total area under the curve is 1, so we can also use this to get the area to the right again:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">120</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09121122</code></pre>
</div>
</div>
<p>The opposite functionality of <code>pnorm()</code> comes in the <code>qnorm()</code> function, which takes a specified area (e.g.&nbsp;5%) and gives us the value at which that area falls above (or below, depending on the <code>lower.tail</code>).</p>
<p>So to find out at what score is the top 5% percent of IQ scores, we would need to ask the point at which there is 5% to the right, or 95% to the left:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># either: </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.05</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.95</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 124.6728</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-qnorm" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02b_sampling_files/figure-html/fig-qnorm-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;6: qnorm() takes an area and gives us the value on the x-axis at which point the are is to the left/right of. it is the opposite of pnorm()</figcaption>
</figure>
</div>
</div>
</div>
<div class="rtip">
<ul>
<li><code>pnorm()</code> takes a value on the x-axis and returns the area to the left (<code>lower.tail = TRUE</code>) or to the right (<code>lower.tail = FALSE</code>).</li>
<li><code>qnorm()</code> takes an area (from 0 to 1) and returns the value on the x-axis at which point that area is to the left (<code>lower.tail = TRUE</code>) or to the right (<code>lower.tail = FALSE</code>).</li>
</ul>
<p>There are a couple of related functions which it is also worth knowing about:</p>
<ul>
<li><code>dnorm()</code> takes a value on the x-axis and returns the height of the curve (the <strong>d</strong>ensity).<br>
</li>
<li><code>rnorm()</code> returns <code>n</code> randomly generated values.</li>
</ul>
</div>
<section id="the-standard-normal-distribution" class="level2">
<h2 class="anchored" data-anchor-id="the-standard-normal-distribution">The Standard Normal Distribution</h2>
<p>Note that if we translate our “IQ &gt;120” to being in terms of standard deviations - <span class="math inline">\(\frac{120 - 100}{15} = 1\frac{1}{3}\)</span> - then we can perform the same computations as we have done above, but comparing against against a normal distribution with mean of 0 and standard deviation of 1 (which are the defaults for the <code>pnorm()</code> function):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>((<span class="dv">120-100</span>)<span class="sc">/</span><span class="dv">15</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09121122</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pnorm2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02b_sampling_files/figure-html/fig-pnorm2-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7: pnorm() with the ‘standard normal distribution’: the normal distribution with mean = 0 and sd = 1</figcaption>
</figure>
</div>
</div>
</div>
<p>What we’re doing here is re-expressing the observed distribution into one which has mean of 0 and standard deviation of 1 - we are <em>standardising</em> them. This idea will become incredibly useful. For one thing it makes comparisons possible, for example, consider the two statements below:</p>
<ul>
<li>“I am 15 IQ points higher than average, and 24cm taller than average”</li>
<li>“I am 1 standard deviation above the average IQ, and 2 standard deviations above average height”</li>
</ul>
<p>The <strong>standard normal distribution</strong> - the normal distribution with <code>mean = 0, sd = 1</code>, is going to be seen a lot more frequently.</p>
</section>
<section id="the-relevance-of-the-normal-distribution" class="level2">
<h2 class="anchored" data-anchor-id="the-relevance-of-the-normal-distribution">The relevance of the normal distribution?</h2>
<p>We can motivate the relevance of the normal distribution in various ways. For instance, when we take a measurement of something such as the length of a stick, then we always have a bit of imprecision - our measurements will vary a bit. Assuming that our measurement tool is unbiased and this imprecision is purely random, we would expect the measurements of the stick to be ‘normally distributed’ around the true length of the stick (<a href="#fig-measurelec">Figure&nbsp;8</a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-measurelec" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/hypothesis/measurelec.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;8: Snapshots from <a href="../../2122/lectures/lecture_2.html#5">21/22 lecture slides</a> on measurement</figcaption>
</figure>
</div>
</div>
</div>
<p>In this way, the normal distribution captures the idea of random deviations around a central point. As we will see below, this becomes extremely relevant for statistics because we tend to collect data on a <strong>random sample</strong> of people, and each sample we <em>could</em> take will randomly deviate a bit in how well it represents the bigger group that we took it from.</p>
<div class="divider div-transparent div-dot">

</div>
</section>
</section>
<section id="sampling-sampling-distributions" class="level1">
<h1>Sampling &amp; Sampling Distributions</h1>
<p>Often, what we’re really interested does not concern a specific individual but the wider population in general - we are typically interested in things <em>on average</em>, and want to make generalisations such as “drug X will increase life expectancy by <em>on average</em> 2 years” or “higher levels of conscientiousness is <em>typically</em> associated with more happiness”. These sort of statements are made in reference to a population, not about individuals.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p>In practice, it is rarely feasible to directly measure the entire population to calculate the average, so when we do research we tend to collect data from a subset, or <em>sample</em>. By using a random sample to represent a population of interest, we introduce uncertainty (due to sampling variability) in how accurate our <em>sample</em> is as to provide an <em>estimate</em> of something in the <em>population</em>.</p>
<p>For us to better understand the idea of “sampling variability”, it’s going to be necessary for us to clearly distinguish between populations and samples.</p>
<div class="sticky">
<p><strong>Samples &amp; Populations</strong></p>
<p>A <strong>sample statistic</strong> is a computed value based on our sample data, the we use to <em>estimate</em> a <strong>population parameter</strong> (the value of which is unknown).<br>
We use different symbols to denote each of these:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Sample Statistic</th>
<th style="text-align: left;">Population Parameter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mean</td>
<td style="text-align: left;"><span class="math inline">\(\bar{x}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\mu\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">standard deviation</td>
<td style="text-align: left;"><span class="math inline">\(s\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sigma\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">variance</td>
<td style="text-align: left;"><span class="math inline">\(s^2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sigma^2\)</span></td>
</tr>
</tbody>
</table>
</div>
<p>When we discussed IQ <a href="#normal-distributions">above</a>, we had the idea of an underlying <em>population distribution</em> of everybody’s IQ scores. When we randomly choose one person (a sample of <span class="math inline">\(n=1\)</span>), we might get someone who has an IQ a bit lower, or a bit higher, than the average.</p>
<p>The same applies when we take are taking the mean of a sample. Suppose we are interested in the average “life satisfaction rating” (<a href="#fig-lifesat">Figure&nbsp;9</a>) for the entire adult population.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-lifesat" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/hypothesis/slider.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;9: Life Satisfaction rating, slider scale 0-100</figcaption>
</figure>
</div>
</div>
</div>
<p>If we take a sample of say, <span class="math inline">\(n=30\)</span> people, we might just happen to have a few more people in our sample who are highly satisfied, or a few more people who are more dissatisfied. Consequently, the mean of our sample will be a little bit higher/lower than the population average. And we can assume that all the random samples we <em>could</em> take will have “average life-satisfaction ratings” that are <strong>normally distributed</strong> around the true population average.</p>
<p>When we use the mean rating from our sample <span class="math inline">\(\bar x\)</span> as an <em>estimate</em> of the mean rating in the <em>population</em> <span class="math inline">\(\mu\)</span>, it would be good to be able to quantify how much certainty we have in that estimate - i.e.&nbsp;how much do we expect the mean life satisfaction rating from samples of <span class="math inline">\(n=30\)</span> to vary due to the randomness of sampling?</p>
<!-- The same applies when we take are taking the mean of a sample. Suppose we are interested in the average height of the entire adult population. If we take a sample of say, $n=20$ people, we might just happen to have a few more people in our sample who are relatively tall, or a few more people who are relatively shorter. Consequently, the mean of our sample will be a little bit higher/lower than the population average. When we use the mean height from our sample as an _estimate_ of the mean height of the _population_, it would be good to be able to quantify how much certainty we have in that estimate - i.e. how much do we expect the mean height from samples of $n=20$ to vary just due to our random sampling?  -->
<p>Let’s look at this with a little simulation.</p>
<div class="frame">
<p><strong>Simulated Sampling</strong></p>
<p>Let’s pretend that the average life satisfaction rating (measured on the slider in <a href="#fig-lifesat">Figure&nbsp;9</a>) of the entire global adult population is <em>exactly</em> 65, and that the standard deviation of ratings is exactly 12.<br>
However, let’s also pretend that we <em>do not know this</em>, and that we are interested in trying to <em>estimate</em> the average rating. All we have is the measurements of 30 people who we randomly sampled. We want to use the mean rating of our sample as an estimate of the mean rating of the population.</p>
<p>In R, we can simulate the act of randomly sampling 30 people’s ratings from the population with <span class="math inline">\(\mu = 65\)</span> and <span class="math inline">\(\sigma = 12\)</span> using <code>rnorm()</code><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>our_sample <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">65</span>, <span class="at">sd =</span> <span class="dv">12</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(our_sample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 64.28839</code></pre>
</div>
</div>
<p>Note that the mean of our sample (64.29) is not quite the same as the mean of the population (65 exactly). As we know, <em>samples vary</em>. If we do the same thing again, R will take a different sample of 30, and so the mean of this new sample will also be different:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">65</span>, <span class="at">sd =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 68.22701</code></pre>
</div>
</div>
<p>Each time we get a new sample, we get a different mean:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">65</span>, <span class="at">sd =</span> <span class="dv">12</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">65</span>, <span class="at">sd =</span> <span class="dv">12</span>))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">65</span>, <span class="at">sd =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 64.20016</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 65.32239</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 63.86801</code></pre>
</div>
</div>
<p>What we’re wanting to do here is think about <em>all</em> possible samples of 30 people we could have taken, and <em>all</em> the possible resulting mean ratings. Let’s consider 1000 different samples of 30 people that we could have taken, and for each one we calculate the mean rating. Where would all these different means fall? Some would be above our population parameter (i.e.&nbsp;we just might happened to have sampled some slightly more satisfied people) and some would be below.</p>
<p>We can use R to enact this repeated sampling: the <code>replicate()</code> function allows us to repeatedly execute a bit of code, which means we can take lots of samples and calculate their means. These means we can then visualise using <code>hist()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>manysamplemeans <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">65</span>, <span class="at">sd =</span> <span class="dv">12</span>)))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(manysamplemeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02b_sampling_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>What does the simulation show us?</strong></p>
<p>What we’re doing here is showing the process of taking many samples of the same size from a population and calculating a statistic (the mean) for each sample. The distribution of these sample statistics shows how the statistic will vary from sample to sample due to chance. Provided that our sampling is <em>truly</em> random, the sample statistics will be a <strong>normal distribution</strong> centered around the population parameter (the unknown value that we’re trying to estimate).</p>
<p>In the above example, for samples of <span class="math inline">\(n=30\)</span> drawn from a population with mean <span class="math inline">\(\mu=65\)</span> and standard deviation <span class="math inline">\(\sigma=12\)</span>, the sample means are centered around 65, and we’re quite likely to get sample means between 60 and 70, but less likely to see sample means <span class="math inline">\(&lt;60\)</span> and <span class="math inline">\(&gt;70\)</span>. Importantly, we can quantify this. The distribution of means from samples of size <span class="math inline">\(n=30\)</span> has a standard deviation of:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(manysamplemeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.253651</code></pre>
</div>
</div>
<p>This metric, the standard deviation of the sampling distribution of a statistic, is known as the <strong>standard error.</strong></p>
<p><strong>What happens with different sample sizes?</strong></p>
<p>Note what happens to the distribution when we consider the means from 1000 different samples of size <span class="math inline">\(n=200\)</span>, rather than <span class="math inline">\(n=30\)</span>. Many more of the of the values are in a much narrower bracket (pay careful attention to the x-axis) than when we took lots of samples of <span class="math inline">\(n=30\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>manysamplemeans200 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">mean =</span> <span class="dv">65</span>, <span class="at">sd =</span> <span class="dv">12</span>)))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(manysamplemeans200)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02b_sampling_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>We can see that an estimate from a sample of 200 is more precise - rather than being between 60 and 72, most of the distribution is now between 63 and 67. So our estimate from a sample of 200 has a greater chance of being closer to the true population value than an estimate from a sample of 30.</p>
</div>
<div class="sticky">
<p><strong>Sampling Distribution and Standard Error</strong></p>
<ul>
<li>The theoretical distribution of how sample statistics will vary on repeated sampling is known as the <strong>sampling distribution</strong>.<br>
</li>
<li>The standard deviation of the sampling distribution is known as the <strong>standard error</strong>.<br>
</li>
<li>Note that the bigger our sample size, the smaller our standard error - i.e., the more precise our sample means are going to be as estimates of the population mean:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02b_sampling_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="divider div-transparent div-dot">

</div>
</section>
<section id="standard-error-in-practice" class="level1">
<h1>Standard Error in practice</h1>
<p>In practice, we cannot actually take lots and lots of samples in order to construct a sampling distribution, and nor do we know the population parameters which are required to simulate samples like we did above (we do not know the population mean <span class="math inline">\(\mu\)</span> or standard deviation <span class="math inline">\(\sigma\)</span>)</p>
<p>Instead, we start with just one observed sample, e.g.&nbsp;here are the life satisfaction ratings of the 30 people that I surveyed:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>observed_sample <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">53.8</span>, <span class="dv">59</span>, <span class="fl">51.1</span>, <span class="fl">66.7</span>, <span class="fl">86.1</span>, <span class="dv">71</span>, <span class="fl">65.3</span>, <span class="fl">72.6</span>, <span class="fl">56.6</span>, <span class="fl">56.8</span>, <span class="fl">50.1</span>, <span class="fl">57.3</span>, <span class="dv">60</span>, <span class="dv">74</span>, <span class="fl">73.4</span>, <span class="fl">68.3</span>, <span class="fl">53.5</span>, <span class="fl">85.5</span>, <span class="fl">68.8</span>, <span class="fl">67.6</span>, <span class="fl">67.4</span>, <span class="fl">47.9</span>, <span class="fl">46.3</span>, <span class="fl">96.1</span>, <span class="fl">52.8</span>, <span class="fl">78.9</span>, <span class="fl">74.8</span>, <span class="fl">50.9</span>, <span class="fl">78.2</span>, <span class="fl">63.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What we <em>can</em> do is either:</p>
<ul>
<li><p><strong>A:</strong> Estimate the standard error using a formula:<br>
<span class="math display">\[
SE = \frac{\sigma}{\sqrt{n}}  \\
\quad \\
\begin{align}
&amp; \text{Where} \\
&amp; \sigma = \text{standard deviation} \\
&amp; n = \text{sample size} \\
\end{align}
\]</span> Note that <span class="math inline">\(\sigma\)</span> is the standard deviation of the population, which is unknown to us. However, we can use the standard deviation of our sample (<span class="math inline">\(\hat \sigma\)</span> or <span class="math inline">\(s\)</span>) as our estimate of this:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SE = standard deviation / square root of n</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(observed_sample)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(observed_sample))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.275565</code></pre>
</div>
</div></li>
<li><p>or <strong>B:</strong> Simulate lots of sampling via <strong>bootstrapping</strong>.<br>
This uses <em>resampling with replacement</em><a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> from our original sample as a means of imitating repeated sampling. Note the <code>replace = TRUE</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap means of resamples with replacement of the same size as observed sample</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>bootstrap_means <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(observed_sample, <span class="at">replace =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># SE = sd of bootstrap resample means </span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(bootstrap_means)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.251539</code></pre>
</div>
</div></li>
</ul>
<div class="divider div-transparent div-dot">

</div>
</section>
<section id="central-limit-theorem-clt" class="level1">
<h1>Central Limit Theorem (CLT)</h1>
<p>Provided we have a sufficiently large sample, the sampling distribution of a statistic will be approximatley normally distributed even when the underlying population distribution is not normally distributed.</p>
<p>Let’s imagine we are interested in estimating these three things:</p>
<ul>
<li>The average life satisfaction rating of people in Scotland</li>
<li>The proportion of people over 6 foot in Scotland</li>
<li>The average income of people in Scotland</li>
</ul>
<p>If we could, we would collect data from <em>everyone</em> in Scotland, and might find distributions like those in <a href="#fig-cltpop">Figure&nbsp;10</a>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-cltpop" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02b_sampling_files/figure-html/fig-cltpop-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;10: Population distributions on three variables (numbers like 4e+05 on the y-axis are a compact way of writing 400000)</figcaption>
</figure>
</div>
</div>
</div>
<p>If we repeatedly collect samples of say, 50 people, and calculated the mean life satisfaction, the mean income, and the proportion &gt;6 foot tall for each sample of 50, then the distribution of those sample statistics will be normal (<a href="#fig-cltstat">Figure&nbsp;11</a>). This is known known as the “central limit theorem”.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-cltstat" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02b_sampling_files/figure-html/fig-cltstat-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11: Sampling distributions for three statistics computed on samples of n=50</figcaption>
</figure>
</div>
</div>
</div>
<div class="sticky">
<p>The <strong>central limit theorem (CLT)</strong> states that when we take sufficiently large random samples from a population, the distribution of the sample means will be approximately normally distributed. This holds regardless of whether the population is normal (or skewed).</p>
<p>You can find little applets online which help to illustrate this, such as those from <a href="https://www.lock5stat.com/StatKey/sampling_1_quant/sampling_1_quant.html" target="_blank">StatKey</a> and <a href="https://wise1.cgu.edu/vis/bootstrap/" target="_blank">WISE</a>.</p>
</div>
<div class="divider div-transparent div-dot">

</div>
</section>
<section id="confidence-intervals" class="level1">
<h1>Confidence Intervals</h1>
<p>One thing that is often useful to do when using a sample estimate is to construct a <em>range of plausible values</em>, providing a view of our uncertainty, rather than just a <strong>point estimate</strong> (a single value).</p>
<p>In our simulation example (where we repeatedly take samples of the same size), we can simply ask for the points at which 2.5% of the sample means are below, and 2.5% are above. The <code>quantile()</code> function essentially orders our 1000 sample means and gives us the 25th and the 975th:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>manysamplemeans <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">65</span>, <span class="at">sd =</span> <span class="dv">12</span>)))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(manysamplemeans, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    2.5%    97.5% 
60.82298 69.51470 </code></pre>
</div>
</div>
<p>However, in real life remember we <em>don’t have</em> lots of sample means.<br>
We just have the one:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>observed_sample <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">53.8</span>, <span class="dv">59</span>, <span class="fl">51.1</span>, <span class="fl">66.7</span>, <span class="fl">86.1</span>, <span class="dv">71</span>, <span class="fl">65.3</span>, <span class="fl">72.6</span>, <span class="fl">56.6</span>, <span class="fl">56.8</span>, <span class="fl">50.1</span>, <span class="fl">57.3</span>, <span class="dv">60</span>, <span class="dv">74</span>, <span class="fl">73.4</span>, <span class="fl">68.3</span>, <span class="fl">53.5</span>, <span class="fl">85.5</span>, <span class="fl">68.8</span>, <span class="fl">67.6</span>, <span class="fl">67.4</span>, <span class="fl">47.9</span>, <span class="fl">46.3</span>, <span class="fl">96.1</span>, <span class="fl">52.8</span>, <span class="fl">78.9</span>, <span class="fl">74.8</span>, <span class="fl">50.9</span>, <span class="fl">78.2</span>, <span class="fl">63.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now know, however, that we can approximate the standard error using the formula <span class="math inline">\(SE = \frac{sigma}{\sqrt{n}}\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(observed_sample)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(observed_sample))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.275565</code></pre>
</div>
</div>
<p>Remember that the standard error is the standard deviation of the <em>theoretical</em> distribution of all the possible sample statistics we <em>might have computed</em> (from all the samples of <span class="math inline">\(n\)</span> that we <em>might have taken</em>). And recall also that from central limit theorem we can rely on assuming the sampling distribution to be normally distributed.</p>
<p>Combine these with the <a href="#normal-distributions">rules of thumb</a> for normal distributions that we saw above, where 68%/95%/99.7% of values will lie within 1/1.96/3 standard deviation of the mean.</p>
<p>We can use these to create intervals which X% of the time will contain the true population value. For 95%, we simply use 1.96 <span class="math inline">\(\times\)</span> standard error either side of our sample mean. This is called a <strong>confidence interval (CI)</strong>.</p>
<p><span class="math display">\[
\begin{align}
&amp; \text{95\% CI} = \bar{x} \pm 1.96 \times SE \\
\qquad \\
&amp; \text{Where: } \\
&amp; \bar{x} = \text{sample mean} \\
&amp; SE = \text{standard error}
\end{align}
\]</span></p>
<p>Our confidence interval<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> is therefore:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">=</span> <span class="fu">mean</span>(observed_sample)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>se <span class="ot">=</span> <span class="fu">sd</span>(observed_sample)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(observed_sample))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>xbar <span class="sc">-</span> (<span class="fl">1.96</span><span class="sc">*</span>se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60.67989</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>xbar <span class="sc">+</span> (<span class="fl">1.96</span><span class="sc">*</span>se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 69.60011</code></pre>
</div>
</div>
<div class="sticky">
<p><strong>Confidence Interval</strong></p>
<p>A confidence interval is a range of plausible values for an estimate.</p>
<p>When we say that we have “95% confidence”, we mean that if we were to do the whole process (take a sample, compute a mean, compute a standard error, construct a confidence interval) over and over again, then 95 of every 100 confidence intervals we might construct will contain the true population parameter.</p>
<p>Think of it like a <a href="https://en.wikipedia.org/wiki/Ring_toss" target="_blank">game of ring toss</a>: our intervals are the rings, and the value we are trying to estimate is the stake. We are [X]% confindent that the ring will land on the stake.</p>
</div>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>remember that standard deviation is <span class="math inline">\(\sqrt{\text{variance}}\)</span><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Often in neuropsychological testing, a set of “normative values” are provided in order to define “what is expected” (sometimes in reference to a specific population).<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>and the statements may not hold for all individuals - for certain people, some drugs just won’t work! but what is important for a healthcare system deciding on whether or not to purchase supplies of a drug is the <em>average</em> treatment effect.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>If you’re working along with this, yours will be different, because it’s random!<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Imagine a bag full of coloured marbles. If we sample <em>with replacement</em>, then we take a marble out, record its colour, and put it back. Then we take a marble out, record its colour, and put it back. And so on. This means we might get the same marble more than once.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>using the formula <span class="math inline">\(\frac{\sigma}{\sqrt{n}}\)</span> for standard error<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Handle positioning of the toggle
      window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">© Copyright 2019-2023 <a href="https://www.ed.ac.uk/">The University of Edinburgh</a>. Site licensed under the <a href="https://www.gnu.org/licenses/agpl-3.0.en.html">GNU AGPLv3</a> license.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>