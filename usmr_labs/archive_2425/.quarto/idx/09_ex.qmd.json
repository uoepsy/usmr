{"title":"Exercises: Interactions!","markdown":{"yaml":{"title":"Exercises: Interactions!","params":{"SHOW_SOLS":false,"TOGGLE":true},"editor_options":{"chunk_output_type":"console"}},"headingText":"Processing a hangover","containsRefs":false,"markdown":"\n\n```{r}\n#| label: setup\n#| include: false\nsource('assets/setup.R')\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(xaringanExtra)\nxaringanExtra::use_panelset()\nqcounter <- function(){\n  if(!exists(\"qcounter_i\")){\n    qcounter_i <<- 1\n  }else{\n    qcounter_i <<- qcounter_i + 1\n  }\n  qcounter_i\n}\n```\n\n\n\n:::frame\n__Dataset: hangover_speed.csv__  \n\n```{r}\n#| include: false\nset.seed(884)\ndf = tibble(\n  hrs_sleep = rnorm(107),\n  alc = sample(0:1,107,TRUE,prob=c(.4,.6)),\n  sdmt = hrs_sleep*.6 + alc + hrs_sleep*alc*.5 + rnorm(107)\n) |>\n  mutate(\n    hrs_sleep = round((scale(hrs_sleep)[,1]*1.2+7.2)*60/15,0)*15/60,\n    alc = ifelse(alc==0,\"y\",\"n\"),\n    sdmt = round(scale(sdmt)[,1]*12.11 + 54.6)\n  )\nhodat <- df\n#write_csv(hodat, file=\"../../data/hangover_speed.csv\")\n```\n\nHow is hours of sleep associated with processing speed? Is this dependent upon whether or not alcohol was consumed the previous night? \n`r nrow(hodat)` participants completed the Symbol Digit Modalities Task (SDMT), a measure of processing speed. Participants also recorded how many hours they had slept the previous night (to the nearest 15 mins), and whether or not they had consumed alcohol.  \n\nThe dataset is available at [https://uoepsy.github.io/data/hangover_speed.csv](https://uoepsy.github.io/data/hangover_speed.csv){target=\"_blank\"}.  \n\n```{r}\n#| echo: false\ntibble(\n  variable = names(hodat),\n  description = c(\n    \"hours slept the previous night (to the nearest 15 mins)\",\n    \"was alcohol consumed the previous evening? ('y'=yes, 'n'=no)\",\n    \"score on the Symbol Digit Modalities Task (SDMT), a measure of processing speed (range 0 to 100)\")\n) |> gt::gt()\n```\n\n\n:::\n\n`r qbegin(qcounter())`\nRead in the data and provide some simple descriptives.  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\n- What is the mean score on the SDMT, what is the variability in scores?  \n- How many people had alcohol the previous night?  \n- How many hours did people sleep on average? Did this vary between the drinkers and the non-drinkers?  \n\n:::\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nHere's our data. Everything looks within plausible ranges for our two continuous variables `hrs_sleep` and `sdmt`. \n```{r}\nhodat <- read_csv(\"https://uoepsy.github.io/data/hangover_speed.csv\")\n```\n\nWe can get the means and SDs for hours slept and the SDMT:  \n```{r}\nlibrary(psych)\ndescribe(hodat |> select(-alc))\n```\n\nWe can see that `r round(prop.table(table(hodat$alc))*100)[1]`% of participants didn't drink, and `r round(prop.table(table(hodat$alc))*100)[2]`% of them did:  \n```{r}\ntable(hodat$alc)\n```\n\nAnd it doesn't look like they differed very much in their sleep times:\n```{r}\nhodat |> group_by(alc) |>\n  summarise(\n    slept = mean(hrs_sleep)\n  )\n```\n\n`r solend()`\n\n`r qbegin(qcounter())`\nMake a plot of SDMT predicted by hours slept, and colour the points by whether or not the participants had drank alcohol.  \n\nCan you plot a separate `lm` line on the graph using `geom_smooth` for each group (alcohol v no alcohol)?  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\n- to make `geom_smooth()` fit a linear model (`lm`), remember to use `geom_smooth(method=lm)`.  \n- if you have the grouping in the `aes()`, then when you add `geom_smooth()` it should make a different one for each group!  \n\n:::\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r}\nggplot(hodat, aes(x = hrs_sleep, y = sdmt, col = alc)) +\n  geom_point() +\n  geom_smooth(method=lm)\n```\n`r solend()`\n\n`r qbegin(qcounter())`\nAdding a different `geom_smooth(method=lm)` for each group is just fitting a different model to each groups' data - i.e. a slope of `sdmt~hrs_sleep` for the drinkers and a slope for the non-drinkers.  \n\nBut we actually want to _test_ if the two slopes are different, and for that we need to create *one* model that includes the appropriate interaction term.  \n\nFit a model to examine whether the association between `hrs_sleep` and `sdmt` is different depending upon alcohol consumption.  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nThis is the same logic as the air-pollution & APOE-4 example in [9A #it-depends](09a_interactions.html#it-depends){target=\"_blank\"}.  \n\n:::\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r}\nmod_int <- lm(sdmt ~ hrs_sleep * alc, data = hodat)\nsummary(mod_int)\n```\n\n`r solend()`\n\n`r qbegin(qcounter())`\nInterpret each coefficient from your model.  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nOur interaction involves a continuous variable (`hrs_sleep`) and a binary variable (`alc`). An interpretation of a similar example is in [9A #interpretation](09a_interactions.html#interpretation){target=\"_blank\"}.  \n\n:::\n\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r}\n#| eval: false\nsummary(mod_int)\n```\n```\nCoefficients:\n               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)      3.1496     6.9631   0.452   0.6520    \nhrs_sleep        7.6499     0.9643   7.933 2.71e-12 ***\nalcy            17.7151    10.6874   1.658   0.1004    \nhrs_sleep:alcy  -3.5867     1.4593  -2.458   0.0156 *  \n---\n```\n\n```{r}\n#| echo: false\n\nbroom::tidy(mod_int) |> select(term,estimate) |>\ntransmute(\n  coefficient=term,\n  estimate=round(estimate,2),\n  interpretation = c(\n    paste0(\"A non-drinker who slept 0 hours is estimated to have an SDMT score of \",round(coef(mod_int)[1],1), \" - note this is not significantly different from zero\"),\n    paste0(\"For every additional hour slept, non-drinkers scores on SDMT are estimated to increase by \",round(coef(mod_int)[2],1)),\n    paste0(\"drinkers who slept zero hours are estimated to have \",round(coef(mod_int)[3],1),\" higher scores on SDMT than non-drinkers who slept zero hours - note this is not significantly different from zero\"),\n    paste0(\"For every additional hour's sleep, drinkers scores on SDMT  increase by \",round(abs(coef(mod_int)[4]),1), \" *less* than they do for non-drinkers\")\n  )\n) |> gt::gt()\n```\n\n\n`r solend()`\n\n`r qbegin(qcounter())`\nConstruct a plot of the model estimated associations between hours-slept and SDMT for drinkers and non-drinkers.  \n\nBecause we have nothing else in our model, this should end up looking exactly the same as our initial plot in Question 2!    \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nIt all follows the same logic as we have used before:  \n\n1. make a dataframe of the values of the predictors that we wish to plot across\n2. using `augment()`, add to that the predicted values of the model, and the associated confidence intervals\n3. shove it all in ggplot!  \n\nBecause we are wanting to plot across _multiple_ predictors (i.e. we want to plot across a range of `hrs_slept` __and__ both values of `alc`), try using `expand_grid()`.  \n\nPlay around with this to see what it does:  \n```{r}\n#| echo: true\nexpand_grid(\n  continuous = 1:5,\n  binary = c(\"dog\",\"cat\",\"parrot\")\n)\n```\n\nIf you get stuck, a very similar example is in [9A #visualisation](09a_interactions.html#visualisation){target=\"_blank\"}.  \n\n:::\n\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r}\n# plot data\nplotdat <- expand_grid(\n  hrs_sleep = 0:14,\n  alc = c(\"n\",\"y\")\n)\n# plot\nbroom::augment(mod_int, newdata = plotdat, interval=\"confidence\") |>\n  ggplot(aes(x= hrs_sleep, y = .fitted, \n             col = alc, fill = alc)) + \n  geom_line() +\n  geom_ribbon(aes(ymin=.lower,ymax=.upper), alpha=.3)\n\n\n```\n\n\n`r solend()`\n\n`r qbegin(qcounter())`\nNo one in our dataset has slept zero hours, and i'm probably not interested in differences between drinkers/non-drinkers who never sleep.  \n\nRefit the model to adjust the intercept to a more meaningful value. Everyone always goes on about 8 hours of sleep being the minimum?  \n\nHow has the interpretation of your coefficient(s) changed?  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nSee [9A #mean-centering](09a_interactions.html#mean-centering){target=\"_blank\"} for an example of mean-centering a predictor in the interaction. Remember that there are multiple ways to do this - you could make a new variable first, or you could do it all _inside_ the model.  \n\n\n:::\n\n`r qend()`\n\n`r solbegin(label=\"Solution Part 1 - recentering and refitting\", slabel=FALSE,show=TRUE, toggle=params$TOGGLE)`\n\nIf we want to recenter our `hrs_sleep` variable on 8 hours, we could either create a new variable which is `hrs_sleep - 8` (which would therefore make everyone who slept 8 hours be given a value of `0` in the variable), or we could do it _in_ the model:  \n  \n:::panelset\n:::panel\n#### re-centering first\n\n```{r}\n#| eval: false\nhodat <- \n  hodat |>\n    mutate(\n      hrs_8 = hrs_sleep - 8\n    )\n\nmod_int2 <- lm(sdmt ~ hrs_8 * alc, data = hodat)\n```\n:::\n:::panel\n#### doing it all in the model\n\n```{r}\nmod_int2 <- lm(sdmt ~ I(hrs_sleep-8) * alc, data = hodat)\n```\n\n:::\n::::\n\n`r solend()`\n`r solbegin(label=\"Solution Part 2 - interpreting coefficients\", slabel=FALSE,show=TRUE, toggle=params$TOGGLE)`\n\n```{r}\n#| eval: false\nsummary(mod_int2)\n```\n```\nCoefficients:\n                      Estimate Std. Error t value Pr(>|t|)    \n(Intercept)            64.3487     1.4206  45.297  < 2e-16 ***\nI(hrs_sleep - 8)        7.6499     0.9643   7.933 2.71e-12 ***\nalcy                  -10.9786     2.0800  -5.278 7.27e-07 ***\nI(hrs_sleep - 8):alcy  -3.5867     1.4593  -2.458   0.0156 *  \n---\n```\n\n```{r}\n#| echo: false\n\nbroom::tidy(mod_int2) |> select(term,estimate) |>\ntransmute(\n  coefficient=term,\n  estimate=round(estimate,2),\n  interpretation = c(\n    paste0(\"A non-drinker who slept 8 hours is estimated to have an SDMT score of \",round(coef(mod_int2)[1],1)),\n    paste0(\"For every additional hour slept, non-drinkers scores on SDMT are estimated to increase by \",round(coef(mod_int2)[2],1)),\n    paste0(\"drinkers who slept 8 hours are estimated to have \",round(abs(coef(mod_int2)[3]),1),\" lower scores on SDMT than non-drinkers who slept 8 hours\"),\n    paste0(\"For every additional hour's sleep, drinkers scores on SDMT  increase by \",round(abs(coef(mod_int2)[4]),1), \" *less* than they do for non-drinkers\")\n  )\n) |> gt::gt()\n```\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# The monkeys are back!  \n\n```{r}\n#| include: false\n#| eval: false\nss = runif(1,1e3,1e6)\nset.seed(ss)\nset.seed(695026.8)\ndf = \n  expand_grid(\n    obj_type = 0:1,\n    obj_colour = 0:2,\n    obj_size = 0:2,\n    n = 1:12\n  ) |> select(-n) |>\n  mutate(\n    species = sample(c(\"macaque\",\"capuchin\",\"tamarin\"), n(), T),\n    age = round(runif(n(),1,21) + 4*(species==\"tamarin\"))\n  )\nxm = model.matrix(lm(rnorm(nrow(df)) ~ age + obj_size + obj_type * species,df |> mutate(species=fct_relevel(factor(species),\"macaque\"))))\ncolnames(xm)\ndf$exptime = xm %*% c(14, -.2, -.5, 2, 4, 1.8,1,-2.9) + rnorm(nrow(df),0,3.5)\n\n# df$lostint = rbinom(nrow(df), 1, plogis(scale(xm %*% c(14, -.2, -.5, 2, 4, 1.8,1,-2.5))))\n\ndf$exptime = round(df$exptime[,1],1)\n# df |> mutate(adult=ifelse(age>8,1,0)) |> pairs()\n\ndf <- df |> select(age,species,obj_type,obj_colour, obj_size,exptime) |>\n  mutate(\n    obj_type = factor(obj_type, labels=c(\"soft\",\"mechanical\")),\n    obj_colour = factor(obj_colour, labels=c(\"red\",\"green\",\"blue\")),\n    obj_size = map_dbl(obj_size, ~30+round(rnorm(1,.*20,11.5))),\n    obj_size = pmax(5,obj_size)\n    #obj_size = factor(obj_size, labels=c(\"small\",\"medium\",\"large\")),\n  )\n\ndf$exptime <- pmax(0,df$exptime)\n#df <- slice_sample(df,prop=.95)\n\nsomenames = read.table(\"https://artofmemory.com/files/forum/947/initials.txt\",header=F,sep=\",\")\ndf$name = sample(somenames$V2, nrow(df))\ndf <- df |> relocate(name)\n\nctmtoys <- df\n#write_csv(ctmtoys,\"../../data/ctmtoys.csv\")\n\n# lm(exptime ~  age + obj_colour+ obj_size + obj_type*species, \n#    data=ctmtoys |> mutate(across(c(obj_type,species),factor))) |> #summary()\n#   sjPlot::plot_model(type=\"int\")\n\n```\n\n\n\n:::frame\n__Data: ctmtoys.csv__  \n\nSo far, we have analysed the data for two studies (not real!) of the inquisitive nature of monkeys. Initially ([week 5 exercises](05_ex.html#monkey-exploration){target=\"_blank\"}), Archer, Winther & Gandolfi (2024a) investigated age differences in exploration of novel objects, and found that older monkeys spend on average less time playing with a novel object than their younger counterparts (we looked at this with both with the linear effect of age in years, and by comparing adults to juveniles). Following this, in our [week 7 exercises](07_ex.html#more-monkeys){target=\"_blank\"} Bolton, Archer, Peng, Winther & Gandolfi (2024b) wanted to see if monkeys showed a preference for different _types_ of object (i.e. ones with moving parts vs ones that are soft). They found that, after accounting for differences due to age, monkeys showed a significant preference for toys with moving parts in comparison to soft toys.  \n\nThe same team of researchers are again asking for our help, and this time with a bigger study, of `r nrow(df)` monkeys. They are interested in whether the preference for mechanical toys over soft toys is different for different species of monkey. \nBoth the previous studies were conducted on Rhesus Macaques (a species that have adapted very well to human dominated landscapes), so this study has re-run the same experiment on `r sum(grepl(\"cap\",df$species))` Capuchin monkeys, `r sum(grepl(\"tam\",df$species))` Tamarin monkeys and `r sum(grepl(\"mac\",df$species))` Macaques.  \n\nThe aim of this study is to investigate the following question:  \n\n> Are preferences between soft toys vs mechanical toys different for different species of monkey?  \n\nThe data is available at [https://uoepsy.github.io/data/ctmtoys.csv](https://uoepsy.github.io/data/ctmtoys.csv){target=\"_blank\"} and contains the variables described in @tbl-ctmtoys\n```{r}\n#| label: tbl-ctmtoys\n#| tbl-cap: \"Data dictionary for ctmtoys.csv\"\n#| echo: false\nctmtoys <- read_csv(\"https://uoepsy.github.io/data/ctmtoys.csv\")\ntibble(\n  variable = names(ctmtoys),\n  description = c(\"Monkey Name\",\n                  \"Age of monkey in years\", \n                  \"Species (capuchin, macaque, tamarin)\",\n                  \"Type of novel object given (mechanical / soft)\",\n                  \"Main colour of object (red / green / blue)\",\n                  \"Size of object in cm (length of largest dimension of the object)\",\n                  \"Time (in minutes) spent exploring the object\")\n) |>\n  gt::gt()\n```\n\n:::\n\n\n`r qbegin(qcounter())`\nAs always, begin by reading in your data and making some exploratory plots to get an idea of the distributions we're dealing with.  \n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nEverything looks okay in terms of our variable ranges here:  \n```{r}\nctmtoys <- read_csv(\"https://uoepsy.github.io/data/ctmtoys.csv\")\nsummary(ctmtoys)\n```\n\nLet's shove it in `pairs.panels`:  \n```{r}\nctmtoys |> \n  select(age, obj_size, exptime) |>\n  psych::pairs.panels()\n```\n\nAnd let's tabulate `obj_type` and `species`: \n```{r}\nctmtoys |>\n  select(obj_type, species) |>\n  table()\n```\n\n`r solend()`\n\n`r qbegin(qcounter())`\nTry making some initial exploratory plots of the relationships in the data that are relevant to the research question.  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nWe're wanting to plot `exploration_time` and `obj_type` here, but we're also wanting to show it for each species.  This means we'll need things like colours, facets, etc.  \n\n:::\n\n`r qend()`\n`r solbegin(show=TRUE, toggle=params$TOGGLE)`\n\nFrom initial exploration - it looks like capuchins are generally spending more time playing with the objects (of both types).  \nThe slight preference for mechanical toys seems to be present Capuchins and Macaques, but it's less clear in the Tamarins.  \n\n```{r}\nggplot(ctmtoys, aes(x = obj_type, y = exptime, \n                    col = obj_type)) +\n  geom_violin() + \n  geom_jitter(width=.2, alpha=.4) + \n  facet_wrap(~species)\n```\n\n\nAll of this is just initial speculation, however - we haven't considered lots of things such as the distributions of ages between the species, or whether they all saw objects of similar sizes and colours. These things could make these plots appear to show relationships that are actually driven by other things. They could also make these plots hide relationships that are present once these things are controlled for.  \n\n`r solend()`\n\n`r qbegin(qcounter())`\nFit an appropriate model to address the research question.  \nThink about what we already know from previous studies - we'll likely want to control for age and for other aspects of objects like size and colour.  \n\nThen think about the specific research question and what is needed to test it.  \n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r}\nmodelmonkey <- lm(exptime ~ age + obj_size + obj_colour +\n                obj_type * species, data = ctmtoys)\n```\n\n`r solend()`\n\n`r qbegin(qcounter())`\nNow that you've fitted your model, test the interaction to get an overall answer to \"Do species differ in their preference for different types of object?\"  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nThink about how the question is worded - there's no \"how\"/\"what\" etc, it's just \"*are* there differences?\" (this is just the same as we did last week, and in [8B #testing-group-differences](08b_catpred.html#testing-group-differences){target=\"_blank\"} - try a model comparison?).  \n\n:::\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nLet's compare a reduced model _without_ the interaction to our model _with_ the interaction:  \n\n```{r}\nmodelmonkey0 <- lm(exptime ~ age + obj_size + obj_colour +\n                obj_type + species, data = ctmtoys)\n\nanova(modelmonkey0, modelmonkey)\n```\n\n\nAlternatively, we could use the shortcut and just give one model to `anova()` and take a look at the last line. They should be the same:  \n```{r}\nanova(modelmonkey)\n```\n\n\n```{r}\n#| include: false\nres<-anova(modelmonkey0, modelmonkey)\n```\n\n\n:::int\nSpecies significantly differed in the extent to which exploration time varied between different types of object ($F(`r res[2,3]`, `r res[2,1]`)=`r round(res[2,5],2)`, p=`r format.pval(res[2,6],eps=.001,digits=3)`$).  \n:::\n\n`r solend()`\n\n`r qbegin(qcounter())`\nWe're almost always going to want to know __how__ species differ in their preferences for different types of object (if they do differ).  \n\nTo get this information, we can just look at the model coefficients.  \nTake a look at the interaction coefficients - notice anything that _appears to_ contradict the previous question?  \n`r qend()`\n`r solbegin(show=TRUE, toggle=params$TOGGLE)`\n\n```{r}\nsummary(modelmonkey)\n```\n\nIn our model coefficients, both interaction terms are non-significant.  \nBut we just said before that in the previous question that there _is_ an interaction (we got our F test for it).  \n\nThe coefficients above are telling us that, compared to the reference species (capuchins), neither macaques nor tamarins show significant differences in their preference for mechanical toys vs soft toys.  \n\nBut while macaques and tamarins may not be different from capuchins, it is entirely possible that macaques and tamarins could be different _from each other_?  \n\n`r solend()`\n\n\n`r qbegin(qcounter())`\nModel coefficients are always relative to some reference point (i.e. capuchins with mechanical toys).  \n\n1. Change the reference point to Macaques with soft toys.  \n2. Refit the model.\n3. Interpret the coefficients.  \n\n`r qend()`\n`r solbegin(show=TRUE, toggle=params$TOGGLE)`\n\nWe always get to choose which level we want as a reference. Sometimes, this will be easy because on level represents the norm/status quo. In this context, Macaques is possibly a more useful reference, given that the study description earlier mentioned the previous studies were conducted on Macaques.   \n\nRe-levelling `obj_type` to have \"soft\" as the reference won't make much difference - it will just swap the signs of the coefficients (comparing mechanical to soft, as opposed to comparing soft to mechanical).  \n```{r}\nctmtoys <- \n  ctmtoys |>\n  mutate(\n    species = fct_relevel(species, \"macaque\"),\n    obj_type = fct_relevel(obj_type, \"soft\")\n  )\n\nlm(exptime ~ age + obj_size + obj_colour +\n                obj_type * species, data = ctmtoys) |>\n  summary()\n```\n\nThese coefficients show us that Macaques tend to spend 3.5 more minutes playing with mechanical toys than soft toys, and that Capuchins do not significantly differ in this respect, but Tamarins do. Relative to Macaques, Tamarins spend 3.05 less additional time with mechanical toys compared to soft toys.  \n\n`r solend()`\n\n`r qbegin(qcounter())`\nThe interpretation of interaction coefficients tends to be quite confusing, and invariably it helps to tie these to a visualisation. We're going to do it manually here, because it's a very useful learning exercise. \n\nBelow are our coefficients of interest from the model, when the reference level for `obj_type` is \"soft\" and for `species` is \"macaque\".  \n```\n...\nobj_typemechanical                  3.47317    0.76957   4.513 1.07e-05 ***\nspeciescapuchin                     5.41843    0.80728   6.712 1.83e-10 ***\nspeciestamarin                      1.87117    0.80555   2.323  0.02116 *  \nobj_typemechanical:speciescapuchin -1.51124    1.11855  -1.351  0.17816    \nobj_typemechanical:speciestamarin  -3.05110    1.11480  -2.737  0.00674 ** \n```\n\nGrab a piece of paper, and draw the points for each species & obj_type combination, relative to the reference point.  \nStart with the plot below:  \n\n```{r}\n#| echo: false\neffects::effect(\"obj_type*species\",modelmonkey) |>\n  as.data.frame() |> \n  mutate(obj_type=fct_relevel(factor(obj_type),\"soft\")) |>\n  mutate(fit=ifelse(obj_type==\"soft\",10.2587,NA),p = c(1,1,2,2,0,0)) |>\n  arrange(p) |>\n  ggplot(aes(x=obj_type, y=fit, col=species))+\n  geom_point(size=3)+\n  scale_y_continuous(limits=c(4,19.5),breaks=4:19)\n```\n\n`r qend()`\n`r solbegin(label=\"Solution Part 1 - coefficient: obj_typemechanical\", slabel=FALSE,show=TRUE, toggle=params$TOGGLE)`\n\nThe coefficient \"obj_typemechanical\" tells us the difference between soft and mechanical toys _when species is zero_ - i.e., when it is at the reference level (macaques).  \n\nSo we know that macaques spend 3.5 more minutes with mechanical toys compared to soft toys:  \n\n```{r}\n#| echo: false\neffects::effect(\"obj_type*species\",modelmonkey) |>\n  as.data.frame() |> \n  mutate(obj_type=fct_relevel(factor(obj_type),\"soft\")) |>\n  mutate(fit=\n           case_when(\n             obj_type==\"mechanical\" & species==\"macaque\" ~ fit,\n             obj_type==\"soft\" ~ 10.2587,\n             TRUE~NA\n           ),\n         p = c(1,1,2,2,0,0)) |>\n  arrange(p) |>\n  ggplot(aes(x=obj_type, y=fit, col=species))+\n  geom_point(size=3)+\n  scale_y_continuous(limits=c(4,19.5),breaks=4:19)\n```\n\n\n`r solend()`\n`r solbegin(label=\"Solution Part 2 - coefficient: speciescapuchin\", slabel=FALSE,show=TRUE, toggle=params$TOGGLE)`\n\nThe coefficient \"speciescapuchin\" tells us the difference between capuchins and macaques, _when obj_type is zero_ - i.e., when it is at the reference level (soft).  \n\nSo we know that capuchins spend 5.4 more minutes with soft toys compared to macaques with soft toys:  \n\n```{r}\n#| echo: false\neffects::effect(\"obj_type*species\",modelmonkey) |>\n  as.data.frame() |> \n  mutate(obj_type=fct_relevel(factor(obj_type),\"soft\")) |>\n  mutate(fit=\n           case_when(\n             obj_type==\"mechanical\" & species==\"macaque\" ~ fit,\n             obj_type==\"soft\" & species==\"capuchin\"~fit,\n             obj_type==\"soft\" ~ 10.2587,\n             TRUE~NA\n           ),\n         p = c(1,1,2,2,0,0)) |>\n  arrange(p) |>\n  ggplot(aes(x=obj_type, y=fit, col=species))+\n  geom_point(size=3)+\n  scale_y_continuous(limits=c(4,19.5),breaks=4:19)\n```\n\n`r solend()`\n`r solbegin(label=\"Solution Part 3 - coefficient: speciestamarin\", slabel=FALSE,show=TRUE, toggle=params$TOGGLE)`\n\nThe coefficient \"speciestamarin\" tells us the difference between tamarins and macaques, _when obj_type is zero_ - i.e., when it is at the reference level (soft).  \n\nSo we know that tamarins spend 1.9 more minutes with soft toys compared to macaques with soft toys:  \n\n```{r}\n#| echo: false\neffects::effect(\"obj_type*species\",modelmonkey) |>\n  as.data.frame() |> \n  mutate(obj_type=fct_relevel(factor(obj_type),\"soft\")) |>\n  mutate(fit=\n           case_when(\n             obj_type==\"mechanical\" & species==\"macaque\" ~ fit,\n             obj_type==\"soft\" ~ fit,\n             TRUE~NA\n           ),\n         p = c(1,1,2,2,0,0)) |>\n  arrange(p) |>\n  ggplot(aes(x=obj_type, y=fit, col=species))+\n  geom_point(size=3)+\n  scale_y_continuous(limits=c(4,19.5),breaks=4:19)\n```\n\n`r solend()`\n\n`r solbegin(label=\"Solution Part 4 - coefficient: obj_typemechanical:speciescapuchin\", slabel=FALSE,show=TRUE, toggle=params$TOGGLE)`\n\nThe coefficient \"obj_typemechanical:speciescapuchin\" tells us the difference between capuchins and macaques' soft-vs-mechanical differences.  \ni.e. when moving from macaques to capuchins, the soft-to-mechanical difference changes by this much.  \n\nSo we know that whereas macaques spend 3.5 more minutes with mechanical toys compared to soft toys, for capuchins this is 1.5 minutes less.  \nSo rather than going up 3.5, we go up $3.5-1.5=2$.  \n\nHowever, this is non-significant. So the difference could easily just be 0 - i.e. they could increase by the same 3.5 minutes as Macaques do. So we know that the uncertainty here should also capture as if Capuchins and Macaques have the same increases from soft to mechanical.  \n\n```{r}\n#| echo: false\n\ndd = tibble(obj_type=\"mechanical\",species=\"capuchin\",fit=17.63906,\n            fit2=3.5+15.67713)\neffects::effect(\"obj_type*species\",modelmonkey) |>\n  as.data.frame() |> \n  mutate(fit=\n           case_when(\n             obj_type==\"mechanical\" & species==\"tamarin\" ~ NA,\n             TRUE ~ fit\n           ),\n         p = c(1,1,2,2,0,0)) |>\n  mutate(obj_type=fct_relevel(factor(obj_type),\"soft\")) |>\n  arrange(p) |>\n  ggplot(aes(x=obj_type, y=fit, col=species))+\n  geom_point(size=3)+\n  geom_segment(data=dd,aes(x=obj_type,xend=obj_type,y=fit,yend=fit2),lwd=1)+\n  scale_y_continuous(limits=c(4,19.5),breaks=4:19)\n```\n\n`r solend()`\n`r solbegin(label=\"Solution Part 5 - coefficient: obj_typemechanical:speciestamarin\", slabel=FALSE,show=TRUE, toggle=params$TOGGLE)`\n\nThe coefficient \"obj_typemechanical:speciestamarin\" tells us the difference between tamarins and macaques' soft-vs-mechanical differences.  \ni.e. when moving from macaques to tamarins, the soft-to-mechanical difference changes by this much.  \n\nSo we know that whereas macaques spend 3.5 more minutes with mechanical toys compared to soft toys, for tamarins this is 3.05 minutes less.  \nSo rather than going up 3.5, we go up $3.5-3.05=0.45$:    \n\n```{r}\n#| echo: false\neffects::effect(\"obj_type*species\",modelmonkey) |>\n  as.data.frame() |>\n  mutate(obj_type=fct_relevel(factor(obj_type),\"soft\")) |>\n  ggplot(aes(x=obj_type, y=fit, col=species))+\n  geom_point(size=3)+\n  geom_segment(data=dd,aes(x=obj_type,xend=obj_type,y=fit,yend=fit2),lwd=1)+\n  scale_y_continuous(limits=c(4,19.5),breaks=4:19)\n```\n\n`r solend()`\n\n\n`r qbegin(qcounter())`\nOkay, now let's make a plot in R.  \n\nTry running this code in pieces to see what each bit does, and then running it all at once to get the plot.  \n\nDoes it match with what you sketched in the previous question?  \n\n```{r}\n#| eval: false\nlibrary(effects)\neffect(\"obj_type*species\",modelmonkey) |>\n  as.data.frame() |>\n  mutate(\n    obj_type = fct_relevel(factor(obj_type), \"soft\")\n  ) |>\n  ggplot(aes(x=obj_type, y=fit, col=species)) +\n  geom_pointrange(aes(ymin=lower,ymax=upper))\n```\n\n\n::: {.callout-note collapse=\"true\"}\n#### Why use the effects package?  \n\nUp to now, when we've been plotting our associations of interest we've been choosing to construct our plots at the mean of our other predictors.  \n\nHowever, in our current monkey model, we've also got a categorical covariate (`obj_colour`) in our model. What should we do with that?\n\n```{r}\n#| eval: false\nplotdat <- expand_grid(\n  age = mean(ctmtoys$age),\n  obj_size = mean(ctmtoys$obj_size),\n  obj_colour = ???\n  obj_type = c(\"soft\",\"mechanical\"), # of interest\n  species = c(\"macaque\",\"capuchin\",\"tamarin\") # of interest\n)\n```\n\nWe could:\n\na) choose just one colour to plot it at\nb) make separate plots to  each colour\nc) plot the association of interest holding the colours at their proportions\n\nTo achieve a) or b), we can use the strategy we have been using already (make a little dataframe, use `augment` etc).  \n\nHowever, to achieve c), it is easiest to use something like the `effect()` function from the __effects__ package. This will also come in handy next semester, as we will use it for plotting effects from more complex models.  \n\n:::\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r}\nlibrary(effects)\neffect(\"obj_type*species\",modelmonkey) |>\n  as.data.frame() |>\n  mutate(\n    obj_type = fct_relevel(factor(obj_type), \"soft\")\n  ) |>\n  ggplot(aes(x=obj_type, y=fit, col=species)) +\n  geom_pointrange(aes(ymin=lower,ymax=upper))\n```\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Teamwork and Communication\n\n:::frame\n__Dataset: teamprod.csv__  \n\nA company has recently decided to move towards having more structured team-based projects for its employees, rather than giving individual projects. They want better understanding what makes teams work well together. Specifically, they want to know whether the amount of communication in a team is associated with better quality work, and if this is different depending upon the teams' 'collective efficacy' (their belief in their ability to do the work)?   \n\nThey have collected data on 80 teams. Prior to starting the projects, each team completed a questionnaire measuring 'collective efficacy' (the teams' belief in their ability to succeed at their project), and 'collective experience' (a measure of how much relevant experience the team has). At the end of the projects, each team's work was rated across various measures (timeliness, quality, relevance etc) to provide a metric of 'work quality'. In addition, information was gathered on the volume of each teams' communication (via the company's workspace chat platform). \n\nThe data is available at [https://uoepsy.github.io/data/teamqual.csv](https://uoepsy.github.io/data/teamqual.csv){target=\"_blank\"}\n\n```{r}\n#| echo: false\nset.seed(5887)\ndf = tibble(\n  commvol = runif(80,150,1500)/30,\n  exp = rnorm(80),\n  colleff = exp*.4 + rnorm(80),\n  work_qual = exp*.2 + colleff*1 + commvol*.1 + colleff*commvol*-.02 + rnorm(80)\n) |>\n  mutate(\n    team_id = paste0(\"team\",1:80),\n    work_qual=round(scale(work_qual)[,1]*26+70),\n    colleff = scale(colleff)[,1]*12+31,\n    colleff = round(pmax(0,colleff))\n    ) |> relocate(team_id)\n#write_csv(df, file=\"../../data/teamqual.csv\")\ntibble(\n  variable=names(df),\n  description=c(\"Team ID\",\"Volume of communication (avg messages per day)\",\"Prior experience (Z-scored)\",\"Collective Efficacy measure of team's belief in ability to succeed (range 0 - 70)\",\"Work Quality measure (metric based on timeliness, quality, relevance etc). Ranges 0 to Infinity\")\n) |> gt::gt()\n```\n\n\n:::\n\n\n`r qbegin(qcounter())`\nBelow, we have provided a regression table, a plot, and a written paragraph.  \n\nThere are _lots_ of mistakes in the writing (both mismatching numbers _and_ errors in interpretation). Note down as many errors as you can find.  \nFeel free to read in the data yourself to play around.  \n\n::::panelset\n:::panel\n#### Table\n```{r}\n#| echo: false\nsjPlot::tab_model(lm(work_qual~exp+commvol*colleff,df),\n                  show.ci = F,show.se=T,show.stat = T)\n```\n\n:::\n:::panel\n#### Plot\n\n```{r}\n#| echo: false\nsjPlot::plot_model(lm(work_qual~exp+commvol*colleff,df),\n                   type=\"eff\",terms=c(\"commvol\",\"colleff\"))\n```\n\n:::\n:::panel\n#### Writing\n\nWork quality was modelled using multiple regression. Team experience (Z-scored), Communication volume (messages per day) and Collective efficacy (Z-scored) were included as predictors, along with the interaction between communication and collective efficacy. The model explained 80% of the variance in work-quality scores. More experienced teams were found to produce significantly better quality work ($\\beta=0.82, t(74)=0.4, p>.05$). Volume of communication was significantly associated with work quality ($\\beta=2.68, t(75)=6.17, p<.001$), suggesting that teams that communicate more produced better quality work. Collective efficacy was also significantly associated with work quality ($\\beta=1.59, t(75)=3.64, p<.001$), indicating that better quality work will be produced by a team that has collective efficacy (compared to those that do not). A significant interaction ($\\beta=-0.03, t=2.68, p < .09$) was found between volume of communication and collective efficacy, suggesting that these two predictors are related. Overall these results suggest that for teams that have more collective efficacy, communication is more important in producing quality work.  \n\n:::\n::::\n\n`r qend()`\n\n\n\n\n\n\n\n","srcMarkdownNoYaml":"\n\n```{r}\n#| label: setup\n#| include: false\nsource('assets/setup.R')\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(xaringanExtra)\nxaringanExtra::use_panelset()\nqcounter <- function(){\n  if(!exists(\"qcounter_i\")){\n    qcounter_i <<- 1\n  }else{\n    qcounter_i <<- qcounter_i + 1\n  }\n  qcounter_i\n}\n```\n\n\n# Processing a hangover\n\n:::frame\n__Dataset: hangover_speed.csv__  \n\n```{r}\n#| include: false\nset.seed(884)\ndf = tibble(\n  hrs_sleep = rnorm(107),\n  alc = sample(0:1,107,TRUE,prob=c(.4,.6)),\n  sdmt = hrs_sleep*.6 + alc + hrs_sleep*alc*.5 + rnorm(107)\n) |>\n  mutate(\n    hrs_sleep = round((scale(hrs_sleep)[,1]*1.2+7.2)*60/15,0)*15/60,\n    alc = ifelse(alc==0,\"y\",\"n\"),\n    sdmt = round(scale(sdmt)[,1]*12.11 + 54.6)\n  )\nhodat <- df\n#write_csv(hodat, file=\"../../data/hangover_speed.csv\")\n```\n\nHow is hours of sleep associated with processing speed? Is this dependent upon whether or not alcohol was consumed the previous night? \n`r nrow(hodat)` participants completed the Symbol Digit Modalities Task (SDMT), a measure of processing speed. Participants also recorded how many hours they had slept the previous night (to the nearest 15 mins), and whether or not they had consumed alcohol.  \n\nThe dataset is available at [https://uoepsy.github.io/data/hangover_speed.csv](https://uoepsy.github.io/data/hangover_speed.csv){target=\"_blank\"}.  \n\n```{r}\n#| echo: false\ntibble(\n  variable = names(hodat),\n  description = c(\n    \"hours slept the previous night (to the nearest 15 mins)\",\n    \"was alcohol consumed the previous evening? ('y'=yes, 'n'=no)\",\n    \"score on the Symbol Digit Modalities Task (SDMT), a measure of processing speed (range 0 to 100)\")\n) |> gt::gt()\n```\n\n\n:::\n\n`r qbegin(qcounter())`\nRead in the data and provide some simple descriptives.  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\n- What is the mean score on the SDMT, what is the variability in scores?  \n- How many people had alcohol the previous night?  \n- How many hours did people sleep on average? Did this vary between the drinkers and the non-drinkers?  \n\n:::\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nHere's our data. Everything looks within plausible ranges for our two continuous variables `hrs_sleep` and `sdmt`. \n```{r}\nhodat <- read_csv(\"https://uoepsy.github.io/data/hangover_speed.csv\")\n```\n\nWe can get the means and SDs for hours slept and the SDMT:  \n```{r}\nlibrary(psych)\ndescribe(hodat |> select(-alc))\n```\n\nWe can see that `r round(prop.table(table(hodat$alc))*100)[1]`% of participants didn't drink, and `r round(prop.table(table(hodat$alc))*100)[2]`% of them did:  \n```{r}\ntable(hodat$alc)\n```\n\nAnd it doesn't look like they differed very much in their sleep times:\n```{r}\nhodat |> group_by(alc) |>\n  summarise(\n    slept = mean(hrs_sleep)\n  )\n```\n\n`r solend()`\n\n`r qbegin(qcounter())`\nMake a plot of SDMT predicted by hours slept, and colour the points by whether or not the participants had drank alcohol.  \n\nCan you plot a separate `lm` line on the graph using `geom_smooth` for each group (alcohol v no alcohol)?  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\n- to make `geom_smooth()` fit a linear model (`lm`), remember to use `geom_smooth(method=lm)`.  \n- if you have the grouping in the `aes()`, then when you add `geom_smooth()` it should make a different one for each group!  \n\n:::\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r}\nggplot(hodat, aes(x = hrs_sleep, y = sdmt, col = alc)) +\n  geom_point() +\n  geom_smooth(method=lm)\n```\n`r solend()`\n\n`r qbegin(qcounter())`\nAdding a different `geom_smooth(method=lm)` for each group is just fitting a different model to each groups' data - i.e. a slope of `sdmt~hrs_sleep` for the drinkers and a slope for the non-drinkers.  \n\nBut we actually want to _test_ if the two slopes are different, and for that we need to create *one* model that includes the appropriate interaction term.  \n\nFit a model to examine whether the association between `hrs_sleep` and `sdmt` is different depending upon alcohol consumption.  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nThis is the same logic as the air-pollution & APOE-4 example in [9A #it-depends](09a_interactions.html#it-depends){target=\"_blank\"}.  \n\n:::\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r}\nmod_int <- lm(sdmt ~ hrs_sleep * alc, data = hodat)\nsummary(mod_int)\n```\n\n`r solend()`\n\n`r qbegin(qcounter())`\nInterpret each coefficient from your model.  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nOur interaction involves a continuous variable (`hrs_sleep`) and a binary variable (`alc`). An interpretation of a similar example is in [9A #interpretation](09a_interactions.html#interpretation){target=\"_blank\"}.  \n\n:::\n\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r}\n#| eval: false\nsummary(mod_int)\n```\n```\nCoefficients:\n               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)      3.1496     6.9631   0.452   0.6520    \nhrs_sleep        7.6499     0.9643   7.933 2.71e-12 ***\nalcy            17.7151    10.6874   1.658   0.1004    \nhrs_sleep:alcy  -3.5867     1.4593  -2.458   0.0156 *  \n---\n```\n\n```{r}\n#| echo: false\n\nbroom::tidy(mod_int) |> select(term,estimate) |>\ntransmute(\n  coefficient=term,\n  estimate=round(estimate,2),\n  interpretation = c(\n    paste0(\"A non-drinker who slept 0 hours is estimated to have an SDMT score of \",round(coef(mod_int)[1],1), \" - note this is not significantly different from zero\"),\n    paste0(\"For every additional hour slept, non-drinkers scores on SDMT are estimated to increase by \",round(coef(mod_int)[2],1)),\n    paste0(\"drinkers who slept zero hours are estimated to have \",round(coef(mod_int)[3],1),\" higher scores on SDMT than non-drinkers who slept zero hours - note this is not significantly different from zero\"),\n    paste0(\"For every additional hour's sleep, drinkers scores on SDMT  increase by \",round(abs(coef(mod_int)[4]),1), \" *less* than they do for non-drinkers\")\n  )\n) |> gt::gt()\n```\n\n\n`r solend()`\n\n`r qbegin(qcounter())`\nConstruct a plot of the model estimated associations between hours-slept and SDMT for drinkers and non-drinkers.  \n\nBecause we have nothing else in our model, this should end up looking exactly the same as our initial plot in Question 2!    \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nIt all follows the same logic as we have used before:  \n\n1. make a dataframe of the values of the predictors that we wish to plot across\n2. using `augment()`, add to that the predicted values of the model, and the associated confidence intervals\n3. shove it all in ggplot!  \n\nBecause we are wanting to plot across _multiple_ predictors (i.e. we want to plot across a range of `hrs_slept` __and__ both values of `alc`), try using `expand_grid()`.  \n\nPlay around with this to see what it does:  \n```{r}\n#| echo: true\nexpand_grid(\n  continuous = 1:5,\n  binary = c(\"dog\",\"cat\",\"parrot\")\n)\n```\n\nIf you get stuck, a very similar example is in [9A #visualisation](09a_interactions.html#visualisation){target=\"_blank\"}.  \n\n:::\n\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r}\n# plot data\nplotdat <- expand_grid(\n  hrs_sleep = 0:14,\n  alc = c(\"n\",\"y\")\n)\n# plot\nbroom::augment(mod_int, newdata = plotdat, interval=\"confidence\") |>\n  ggplot(aes(x= hrs_sleep, y = .fitted, \n             col = alc, fill = alc)) + \n  geom_line() +\n  geom_ribbon(aes(ymin=.lower,ymax=.upper), alpha=.3)\n\n\n```\n\n\n`r solend()`\n\n`r qbegin(qcounter())`\nNo one in our dataset has slept zero hours, and i'm probably not interested in differences between drinkers/non-drinkers who never sleep.  \n\nRefit the model to adjust the intercept to a more meaningful value. Everyone always goes on about 8 hours of sleep being the minimum?  \n\nHow has the interpretation of your coefficient(s) changed?  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nSee [9A #mean-centering](09a_interactions.html#mean-centering){target=\"_blank\"} for an example of mean-centering a predictor in the interaction. Remember that there are multiple ways to do this - you could make a new variable first, or you could do it all _inside_ the model.  \n\n\n:::\n\n`r qend()`\n\n`r solbegin(label=\"Solution Part 1 - recentering and refitting\", slabel=FALSE,show=TRUE, toggle=params$TOGGLE)`\n\nIf we want to recenter our `hrs_sleep` variable on 8 hours, we could either create a new variable which is `hrs_sleep - 8` (which would therefore make everyone who slept 8 hours be given a value of `0` in the variable), or we could do it _in_ the model:  \n  \n:::panelset\n:::panel\n#### re-centering first\n\n```{r}\n#| eval: false\nhodat <- \n  hodat |>\n    mutate(\n      hrs_8 = hrs_sleep - 8\n    )\n\nmod_int2 <- lm(sdmt ~ hrs_8 * alc, data = hodat)\n```\n:::\n:::panel\n#### doing it all in the model\n\n```{r}\nmod_int2 <- lm(sdmt ~ I(hrs_sleep-8) * alc, data = hodat)\n```\n\n:::\n::::\n\n`r solend()`\n`r solbegin(label=\"Solution Part 2 - interpreting coefficients\", slabel=FALSE,show=TRUE, toggle=params$TOGGLE)`\n\n```{r}\n#| eval: false\nsummary(mod_int2)\n```\n```\nCoefficients:\n                      Estimate Std. Error t value Pr(>|t|)    \n(Intercept)            64.3487     1.4206  45.297  < 2e-16 ***\nI(hrs_sleep - 8)        7.6499     0.9643   7.933 2.71e-12 ***\nalcy                  -10.9786     2.0800  -5.278 7.27e-07 ***\nI(hrs_sleep - 8):alcy  -3.5867     1.4593  -2.458   0.0156 *  \n---\n```\n\n```{r}\n#| echo: false\n\nbroom::tidy(mod_int2) |> select(term,estimate) |>\ntransmute(\n  coefficient=term,\n  estimate=round(estimate,2),\n  interpretation = c(\n    paste0(\"A non-drinker who slept 8 hours is estimated to have an SDMT score of \",round(coef(mod_int2)[1],1)),\n    paste0(\"For every additional hour slept, non-drinkers scores on SDMT are estimated to increase by \",round(coef(mod_int2)[2],1)),\n    paste0(\"drinkers who slept 8 hours are estimated to have \",round(abs(coef(mod_int2)[3]),1),\" lower scores on SDMT than non-drinkers who slept 8 hours\"),\n    paste0(\"For every additional hour's sleep, drinkers scores on SDMT  increase by \",round(abs(coef(mod_int2)[4]),1), \" *less* than they do for non-drinkers\")\n  )\n) |> gt::gt()\n```\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# The monkeys are back!  \n\n```{r}\n#| include: false\n#| eval: false\nss = runif(1,1e3,1e6)\nset.seed(ss)\nset.seed(695026.8)\ndf = \n  expand_grid(\n    obj_type = 0:1,\n    obj_colour = 0:2,\n    obj_size = 0:2,\n    n = 1:12\n  ) |> select(-n) |>\n  mutate(\n    species = sample(c(\"macaque\",\"capuchin\",\"tamarin\"), n(), T),\n    age = round(runif(n(),1,21) + 4*(species==\"tamarin\"))\n  )\nxm = model.matrix(lm(rnorm(nrow(df)) ~ age + obj_size + obj_type * species,df |> mutate(species=fct_relevel(factor(species),\"macaque\"))))\ncolnames(xm)\ndf$exptime = xm %*% c(14, -.2, -.5, 2, 4, 1.8,1,-2.9) + rnorm(nrow(df),0,3.5)\n\n# df$lostint = rbinom(nrow(df), 1, plogis(scale(xm %*% c(14, -.2, -.5, 2, 4, 1.8,1,-2.5))))\n\ndf$exptime = round(df$exptime[,1],1)\n# df |> mutate(adult=ifelse(age>8,1,0)) |> pairs()\n\ndf <- df |> select(age,species,obj_type,obj_colour, obj_size,exptime) |>\n  mutate(\n    obj_type = factor(obj_type, labels=c(\"soft\",\"mechanical\")),\n    obj_colour = factor(obj_colour, labels=c(\"red\",\"green\",\"blue\")),\n    obj_size = map_dbl(obj_size, ~30+round(rnorm(1,.*20,11.5))),\n    obj_size = pmax(5,obj_size)\n    #obj_size = factor(obj_size, labels=c(\"small\",\"medium\",\"large\")),\n  )\n\ndf$exptime <- pmax(0,df$exptime)\n#df <- slice_sample(df,prop=.95)\n\nsomenames = read.table(\"https://artofmemory.com/files/forum/947/initials.txt\",header=F,sep=\",\")\ndf$name = sample(somenames$V2, nrow(df))\ndf <- df |> relocate(name)\n\nctmtoys <- df\n#write_csv(ctmtoys,\"../../data/ctmtoys.csv\")\n\n# lm(exptime ~  age + obj_colour+ obj_size + obj_type*species, \n#    data=ctmtoys |> mutate(across(c(obj_type,species),factor))) |> #summary()\n#   sjPlot::plot_model(type=\"int\")\n\n```\n\n\n\n:::frame\n__Data: ctmtoys.csv__  \n\nSo far, we have analysed the data for two studies (not real!) of the inquisitive nature of monkeys. Initially ([week 5 exercises](05_ex.html#monkey-exploration){target=\"_blank\"}), Archer, Winther & Gandolfi (2024a) investigated age differences in exploration of novel objects, and found that older monkeys spend on average less time playing with a novel object than their younger counterparts (we looked at this with both with the linear effect of age in years, and by comparing adults to juveniles). Following this, in our [week 7 exercises](07_ex.html#more-monkeys){target=\"_blank\"} Bolton, Archer, Peng, Winther & Gandolfi (2024b) wanted to see if monkeys showed a preference for different _types_ of object (i.e. ones with moving parts vs ones that are soft). They found that, after accounting for differences due to age, monkeys showed a significant preference for toys with moving parts in comparison to soft toys.  \n\nThe same team of researchers are again asking for our help, and this time with a bigger study, of `r nrow(df)` monkeys. They are interested in whether the preference for mechanical toys over soft toys is different for different species of monkey. \nBoth the previous studies were conducted on Rhesus Macaques (a species that have adapted very well to human dominated landscapes), so this study has re-run the same experiment on `r sum(grepl(\"cap\",df$species))` Capuchin monkeys, `r sum(grepl(\"tam\",df$species))` Tamarin monkeys and `r sum(grepl(\"mac\",df$species))` Macaques.  \n\nThe aim of this study is to investigate the following question:  \n\n> Are preferences between soft toys vs mechanical toys different for different species of monkey?  \n\nThe data is available at [https://uoepsy.github.io/data/ctmtoys.csv](https://uoepsy.github.io/data/ctmtoys.csv){target=\"_blank\"} and contains the variables described in @tbl-ctmtoys\n```{r}\n#| label: tbl-ctmtoys\n#| tbl-cap: \"Data dictionary for ctmtoys.csv\"\n#| echo: false\nctmtoys <- read_csv(\"https://uoepsy.github.io/data/ctmtoys.csv\")\ntibble(\n  variable = names(ctmtoys),\n  description = c(\"Monkey Name\",\n                  \"Age of monkey in years\", \n                  \"Species (capuchin, macaque, tamarin)\",\n                  \"Type of novel object given (mechanical / soft)\",\n                  \"Main colour of object (red / green / blue)\",\n                  \"Size of object in cm (length of largest dimension of the object)\",\n                  \"Time (in minutes) spent exploring the object\")\n) |>\n  gt::gt()\n```\n\n:::\n\n\n`r qbegin(qcounter())`\nAs always, begin by reading in your data and making some exploratory plots to get an idea of the distributions we're dealing with.  \n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nEverything looks okay in terms of our variable ranges here:  \n```{r}\nctmtoys <- read_csv(\"https://uoepsy.github.io/data/ctmtoys.csv\")\nsummary(ctmtoys)\n```\n\nLet's shove it in `pairs.panels`:  \n```{r}\nctmtoys |> \n  select(age, obj_size, exptime) |>\n  psych::pairs.panels()\n```\n\nAnd let's tabulate `obj_type` and `species`: \n```{r}\nctmtoys |>\n  select(obj_type, species) |>\n  table()\n```\n\n`r solend()`\n\n`r qbegin(qcounter())`\nTry making some initial exploratory plots of the relationships in the data that are relevant to the research question.  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nWe're wanting to plot `exploration_time` and `obj_type` here, but we're also wanting to show it for each species.  This means we'll need things like colours, facets, etc.  \n\n:::\n\n`r qend()`\n`r solbegin(show=TRUE, toggle=params$TOGGLE)`\n\nFrom initial exploration - it looks like capuchins are generally spending more time playing with the objects (of both types).  \nThe slight preference for mechanical toys seems to be present Capuchins and Macaques, but it's less clear in the Tamarins.  \n\n```{r}\nggplot(ctmtoys, aes(x = obj_type, y = exptime, \n                    col = obj_type)) +\n  geom_violin() + \n  geom_jitter(width=.2, alpha=.4) + \n  facet_wrap(~species)\n```\n\n\nAll of this is just initial speculation, however - we haven't considered lots of things such as the distributions of ages between the species, or whether they all saw objects of similar sizes and colours. These things could make these plots appear to show relationships that are actually driven by other things. They could also make these plots hide relationships that are present once these things are controlled for.  \n\n`r solend()`\n\n`r qbegin(qcounter())`\nFit an appropriate model to address the research question.  \nThink about what we already know from previous studies - we'll likely want to control for age and for other aspects of objects like size and colour.  \n\nThen think about the specific research question and what is needed to test it.  \n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r}\nmodelmonkey <- lm(exptime ~ age + obj_size + obj_colour +\n                obj_type * species, data = ctmtoys)\n```\n\n`r solend()`\n\n`r qbegin(qcounter())`\nNow that you've fitted your model, test the interaction to get an overall answer to \"Do species differ in their preference for different types of object?\"  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nThink about how the question is worded - there's no \"how\"/\"what\" etc, it's just \"*are* there differences?\" (this is just the same as we did last week, and in [8B #testing-group-differences](08b_catpred.html#testing-group-differences){target=\"_blank\"} - try a model comparison?).  \n\n:::\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nLet's compare a reduced model _without_ the interaction to our model _with_ the interaction:  \n\n```{r}\nmodelmonkey0 <- lm(exptime ~ age + obj_size + obj_colour +\n                obj_type + species, data = ctmtoys)\n\nanova(modelmonkey0, modelmonkey)\n```\n\n\nAlternatively, we could use the shortcut and just give one model to `anova()` and take a look at the last line. They should be the same:  \n```{r}\nanova(modelmonkey)\n```\n\n\n```{r}\n#| include: false\nres<-anova(modelmonkey0, modelmonkey)\n```\n\n\n:::int\nSpecies significantly differed in the extent to which exploration time varied between different types of object ($F(`r res[2,3]`, `r res[2,1]`)=`r round(res[2,5],2)`, p=`r format.pval(res[2,6],eps=.001,digits=3)`$).  \n:::\n\n`r solend()`\n\n`r qbegin(qcounter())`\nWe're almost always going to want to know __how__ species differ in their preferences for different types of object (if they do differ).  \n\nTo get this information, we can just look at the model coefficients.  \nTake a look at the interaction coefficients - notice anything that _appears to_ contradict the previous question?  \n`r qend()`\n`r solbegin(show=TRUE, toggle=params$TOGGLE)`\n\n```{r}\nsummary(modelmonkey)\n```\n\nIn our model coefficients, both interaction terms are non-significant.  \nBut we just said before that in the previous question that there _is_ an interaction (we got our F test for it).  \n\nThe coefficients above are telling us that, compared to the reference species (capuchins), neither macaques nor tamarins show significant differences in their preference for mechanical toys vs soft toys.  \n\nBut while macaques and tamarins may not be different from capuchins, it is entirely possible that macaques and tamarins could be different _from each other_?  \n\n`r solend()`\n\n\n`r qbegin(qcounter())`\nModel coefficients are always relative to some reference point (i.e. capuchins with mechanical toys).  \n\n1. Change the reference point to Macaques with soft toys.  \n2. Refit the model.\n3. Interpret the coefficients.  \n\n`r qend()`\n`r solbegin(show=TRUE, toggle=params$TOGGLE)`\n\nWe always get to choose which level we want as a reference. Sometimes, this will be easy because on level represents the norm/status quo. In this context, Macaques is possibly a more useful reference, given that the study description earlier mentioned the previous studies were conducted on Macaques.   \n\nRe-levelling `obj_type` to have \"soft\" as the reference won't make much difference - it will just swap the signs of the coefficients (comparing mechanical to soft, as opposed to comparing soft to mechanical).  \n```{r}\nctmtoys <- \n  ctmtoys |>\n  mutate(\n    species = fct_relevel(species, \"macaque\"),\n    obj_type = fct_relevel(obj_type, \"soft\")\n  )\n\nlm(exptime ~ age + obj_size + obj_colour +\n                obj_type * species, data = ctmtoys) |>\n  summary()\n```\n\nThese coefficients show us that Macaques tend to spend 3.5 more minutes playing with mechanical toys than soft toys, and that Capuchins do not significantly differ in this respect, but Tamarins do. Relative to Macaques, Tamarins spend 3.05 less additional time with mechanical toys compared to soft toys.  \n\n`r solend()`\n\n`r qbegin(qcounter())`\nThe interpretation of interaction coefficients tends to be quite confusing, and invariably it helps to tie these to a visualisation. We're going to do it manually here, because it's a very useful learning exercise. \n\nBelow are our coefficients of interest from the model, when the reference level for `obj_type` is \"soft\" and for `species` is \"macaque\".  \n```\n...\nobj_typemechanical                  3.47317    0.76957   4.513 1.07e-05 ***\nspeciescapuchin                     5.41843    0.80728   6.712 1.83e-10 ***\nspeciestamarin                      1.87117    0.80555   2.323  0.02116 *  \nobj_typemechanical:speciescapuchin -1.51124    1.11855  -1.351  0.17816    \nobj_typemechanical:speciestamarin  -3.05110    1.11480  -2.737  0.00674 ** \n```\n\nGrab a piece of paper, and draw the points for each species & obj_type combination, relative to the reference point.  \nStart with the plot below:  \n\n```{r}\n#| echo: false\neffects::effect(\"obj_type*species\",modelmonkey) |>\n  as.data.frame() |> \n  mutate(obj_type=fct_relevel(factor(obj_type),\"soft\")) |>\n  mutate(fit=ifelse(obj_type==\"soft\",10.2587,NA),p = c(1,1,2,2,0,0)) |>\n  arrange(p) |>\n  ggplot(aes(x=obj_type, y=fit, col=species))+\n  geom_point(size=3)+\n  scale_y_continuous(limits=c(4,19.5),breaks=4:19)\n```\n\n`r qend()`\n`r solbegin(label=\"Solution Part 1 - coefficient: obj_typemechanical\", slabel=FALSE,show=TRUE, toggle=params$TOGGLE)`\n\nThe coefficient \"obj_typemechanical\" tells us the difference between soft and mechanical toys _when species is zero_ - i.e., when it is at the reference level (macaques).  \n\nSo we know that macaques spend 3.5 more minutes with mechanical toys compared to soft toys:  \n\n```{r}\n#| echo: false\neffects::effect(\"obj_type*species\",modelmonkey) |>\n  as.data.frame() |> \n  mutate(obj_type=fct_relevel(factor(obj_type),\"soft\")) |>\n  mutate(fit=\n           case_when(\n             obj_type==\"mechanical\" & species==\"macaque\" ~ fit,\n             obj_type==\"soft\" ~ 10.2587,\n             TRUE~NA\n           ),\n         p = c(1,1,2,2,0,0)) |>\n  arrange(p) |>\n  ggplot(aes(x=obj_type, y=fit, col=species))+\n  geom_point(size=3)+\n  scale_y_continuous(limits=c(4,19.5),breaks=4:19)\n```\n\n\n`r solend()`\n`r solbegin(label=\"Solution Part 2 - coefficient: speciescapuchin\", slabel=FALSE,show=TRUE, toggle=params$TOGGLE)`\n\nThe coefficient \"speciescapuchin\" tells us the difference between capuchins and macaques, _when obj_type is zero_ - i.e., when it is at the reference level (soft).  \n\nSo we know that capuchins spend 5.4 more minutes with soft toys compared to macaques with soft toys:  \n\n```{r}\n#| echo: false\neffects::effect(\"obj_type*species\",modelmonkey) |>\n  as.data.frame() |> \n  mutate(obj_type=fct_relevel(factor(obj_type),\"soft\")) |>\n  mutate(fit=\n           case_when(\n             obj_type==\"mechanical\" & species==\"macaque\" ~ fit,\n             obj_type==\"soft\" & species==\"capuchin\"~fit,\n             obj_type==\"soft\" ~ 10.2587,\n             TRUE~NA\n           ),\n         p = c(1,1,2,2,0,0)) |>\n  arrange(p) |>\n  ggplot(aes(x=obj_type, y=fit, col=species))+\n  geom_point(size=3)+\n  scale_y_continuous(limits=c(4,19.5),breaks=4:19)\n```\n\n`r solend()`\n`r solbegin(label=\"Solution Part 3 - coefficient: speciestamarin\", slabel=FALSE,show=TRUE, toggle=params$TOGGLE)`\n\nThe coefficient \"speciestamarin\" tells us the difference between tamarins and macaques, _when obj_type is zero_ - i.e., when it is at the reference level (soft).  \n\nSo we know that tamarins spend 1.9 more minutes with soft toys compared to macaques with soft toys:  \n\n```{r}\n#| echo: false\neffects::effect(\"obj_type*species\",modelmonkey) |>\n  as.data.frame() |> \n  mutate(obj_type=fct_relevel(factor(obj_type),\"soft\")) |>\n  mutate(fit=\n           case_when(\n             obj_type==\"mechanical\" & species==\"macaque\" ~ fit,\n             obj_type==\"soft\" ~ fit,\n             TRUE~NA\n           ),\n         p = c(1,1,2,2,0,0)) |>\n  arrange(p) |>\n  ggplot(aes(x=obj_type, y=fit, col=species))+\n  geom_point(size=3)+\n  scale_y_continuous(limits=c(4,19.5),breaks=4:19)\n```\n\n`r solend()`\n\n`r solbegin(label=\"Solution Part 4 - coefficient: obj_typemechanical:speciescapuchin\", slabel=FALSE,show=TRUE, toggle=params$TOGGLE)`\n\nThe coefficient \"obj_typemechanical:speciescapuchin\" tells us the difference between capuchins and macaques' soft-vs-mechanical differences.  \ni.e. when moving from macaques to capuchins, the soft-to-mechanical difference changes by this much.  \n\nSo we know that whereas macaques spend 3.5 more minutes with mechanical toys compared to soft toys, for capuchins this is 1.5 minutes less.  \nSo rather than going up 3.5, we go up $3.5-1.5=2$.  \n\nHowever, this is non-significant. So the difference could easily just be 0 - i.e. they could increase by the same 3.5 minutes as Macaques do. So we know that the uncertainty here should also capture as if Capuchins and Macaques have the same increases from soft to mechanical.  \n\n```{r}\n#| echo: false\n\ndd = tibble(obj_type=\"mechanical\",species=\"capuchin\",fit=17.63906,\n            fit2=3.5+15.67713)\neffects::effect(\"obj_type*species\",modelmonkey) |>\n  as.data.frame() |> \n  mutate(fit=\n           case_when(\n             obj_type==\"mechanical\" & species==\"tamarin\" ~ NA,\n             TRUE ~ fit\n           ),\n         p = c(1,1,2,2,0,0)) |>\n  mutate(obj_type=fct_relevel(factor(obj_type),\"soft\")) |>\n  arrange(p) |>\n  ggplot(aes(x=obj_type, y=fit, col=species))+\n  geom_point(size=3)+\n  geom_segment(data=dd,aes(x=obj_type,xend=obj_type,y=fit,yend=fit2),lwd=1)+\n  scale_y_continuous(limits=c(4,19.5),breaks=4:19)\n```\n\n`r solend()`\n`r solbegin(label=\"Solution Part 5 - coefficient: obj_typemechanical:speciestamarin\", slabel=FALSE,show=TRUE, toggle=params$TOGGLE)`\n\nThe coefficient \"obj_typemechanical:speciestamarin\" tells us the difference between tamarins and macaques' soft-vs-mechanical differences.  \ni.e. when moving from macaques to tamarins, the soft-to-mechanical difference changes by this much.  \n\nSo we know that whereas macaques spend 3.5 more minutes with mechanical toys compared to soft toys, for tamarins this is 3.05 minutes less.  \nSo rather than going up 3.5, we go up $3.5-3.05=0.45$:    \n\n```{r}\n#| echo: false\neffects::effect(\"obj_type*species\",modelmonkey) |>\n  as.data.frame() |>\n  mutate(obj_type=fct_relevel(factor(obj_type),\"soft\")) |>\n  ggplot(aes(x=obj_type, y=fit, col=species))+\n  geom_point(size=3)+\n  geom_segment(data=dd,aes(x=obj_type,xend=obj_type,y=fit,yend=fit2),lwd=1)+\n  scale_y_continuous(limits=c(4,19.5),breaks=4:19)\n```\n\n`r solend()`\n\n\n`r qbegin(qcounter())`\nOkay, now let's make a plot in R.  \n\nTry running this code in pieces to see what each bit does, and then running it all at once to get the plot.  \n\nDoes it match with what you sketched in the previous question?  \n\n```{r}\n#| eval: false\nlibrary(effects)\neffect(\"obj_type*species\",modelmonkey) |>\n  as.data.frame() |>\n  mutate(\n    obj_type = fct_relevel(factor(obj_type), \"soft\")\n  ) |>\n  ggplot(aes(x=obj_type, y=fit, col=species)) +\n  geom_pointrange(aes(ymin=lower,ymax=upper))\n```\n\n\n::: {.callout-note collapse=\"true\"}\n#### Why use the effects package?  \n\nUp to now, when we've been plotting our associations of interest we've been choosing to construct our plots at the mean of our other predictors.  \n\nHowever, in our current monkey model, we've also got a categorical covariate (`obj_colour`) in our model. What should we do with that?\n\n```{r}\n#| eval: false\nplotdat <- expand_grid(\n  age = mean(ctmtoys$age),\n  obj_size = mean(ctmtoys$obj_size),\n  obj_colour = ???\n  obj_type = c(\"soft\",\"mechanical\"), # of interest\n  species = c(\"macaque\",\"capuchin\",\"tamarin\") # of interest\n)\n```\n\nWe could:\n\na) choose just one colour to plot it at\nb) make separate plots to  each colour\nc) plot the association of interest holding the colours at their proportions\n\nTo achieve a) or b), we can use the strategy we have been using already (make a little dataframe, use `augment` etc).  \n\nHowever, to achieve c), it is easiest to use something like the `effect()` function from the __effects__ package. This will also come in handy next semester, as we will use it for plotting effects from more complex models.  \n\n:::\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r}\nlibrary(effects)\neffect(\"obj_type*species\",modelmonkey) |>\n  as.data.frame() |>\n  mutate(\n    obj_type = fct_relevel(factor(obj_type), \"soft\")\n  ) |>\n  ggplot(aes(x=obj_type, y=fit, col=species)) +\n  geom_pointrange(aes(ymin=lower,ymax=upper))\n```\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Teamwork and Communication\n\n:::frame\n__Dataset: teamprod.csv__  \n\nA company has recently decided to move towards having more structured team-based projects for its employees, rather than giving individual projects. They want better understanding what makes teams work well together. Specifically, they want to know whether the amount of communication in a team is associated with better quality work, and if this is different depending upon the teams' 'collective efficacy' (their belief in their ability to do the work)?   \n\nThey have collected data on 80 teams. Prior to starting the projects, each team completed a questionnaire measuring 'collective efficacy' (the teams' belief in their ability to succeed at their project), and 'collective experience' (a measure of how much relevant experience the team has). At the end of the projects, each team's work was rated across various measures (timeliness, quality, relevance etc) to provide a metric of 'work quality'. In addition, information was gathered on the volume of each teams' communication (via the company's workspace chat platform). \n\nThe data is available at [https://uoepsy.github.io/data/teamqual.csv](https://uoepsy.github.io/data/teamqual.csv){target=\"_blank\"}\n\n```{r}\n#| echo: false\nset.seed(5887)\ndf = tibble(\n  commvol = runif(80,150,1500)/30,\n  exp = rnorm(80),\n  colleff = exp*.4 + rnorm(80),\n  work_qual = exp*.2 + colleff*1 + commvol*.1 + colleff*commvol*-.02 + rnorm(80)\n) |>\n  mutate(\n    team_id = paste0(\"team\",1:80),\n    work_qual=round(scale(work_qual)[,1]*26+70),\n    colleff = scale(colleff)[,1]*12+31,\n    colleff = round(pmax(0,colleff))\n    ) |> relocate(team_id)\n#write_csv(df, file=\"../../data/teamqual.csv\")\ntibble(\n  variable=names(df),\n  description=c(\"Team ID\",\"Volume of communication (avg messages per day)\",\"Prior experience (Z-scored)\",\"Collective Efficacy measure of team's belief in ability to succeed (range 0 - 70)\",\"Work Quality measure (metric based on timeliness, quality, relevance etc). Ranges 0 to Infinity\")\n) |> gt::gt()\n```\n\n\n:::\n\n\n`r qbegin(qcounter())`\nBelow, we have provided a regression table, a plot, and a written paragraph.  \n\nThere are _lots_ of mistakes in the writing (both mismatching numbers _and_ errors in interpretation). Note down as many errors as you can find.  \nFeel free to read in the data yourself to play around.  \n\n::::panelset\n:::panel\n#### Table\n```{r}\n#| echo: false\nsjPlot::tab_model(lm(work_qual~exp+commvol*colleff,df),\n                  show.ci = F,show.se=T,show.stat = T)\n```\n\n:::\n:::panel\n#### Plot\n\n```{r}\n#| echo: false\nsjPlot::plot_model(lm(work_qual~exp+commvol*colleff,df),\n                   type=\"eff\",terms=c(\"commvol\",\"colleff\"))\n```\n\n:::\n:::panel\n#### Writing\n\nWork quality was modelled using multiple regression. Team experience (Z-scored), Communication volume (messages per day) and Collective efficacy (Z-scored) were included as predictors, along with the interaction between communication and collective efficacy. The model explained 80% of the variance in work-quality scores. More experienced teams were found to produce significantly better quality work ($\\beta=0.82, t(74)=0.4, p>.05$). Volume of communication was significantly associated with work quality ($\\beta=2.68, t(75)=6.17, p<.001$), suggesting that teams that communicate more produced better quality work. Collective efficacy was also significantly associated with work quality ($\\beta=1.59, t(75)=3.64, p<.001$), indicating that better quality work will be produced by a team that has collective efficacy (compared to those that do not). A significant interaction ($\\beta=-0.03, t=2.68, p < .09$) was found between volume of communication and collective efficacy, suggesting that these two predictors are related. Overall these results suggest that for teams that have more collective efficacy, communication is more important in producing quality work.  \n\n:::\n::::\n\n`r qend()`\n\n\n\n\n\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"include-in-header":["assets/toggling.html",{"text":"<link rel=\"stylesheet\" href=\"https://uoepsy.github.io/assets/css/ccfooter.css\" />\n"}],"number-sections":false,"output-file":"09_ex.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","toc_float":true,"code-annotations":"hover","link-citations":true,"theme":["united","assets/style-labs.scss"],"title":"Exercises: Interactions!","params":{"SHOW_SOLS":false,"TOGGLE":true},"editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}