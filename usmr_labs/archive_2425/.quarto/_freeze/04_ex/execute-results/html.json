{
  "hash": "da4e4f3d0d8e1ed23d16c6168a402765",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Exercises: Binomial & Chi-Square Tests\"\nparams: \n    SHOW_SOLS: FALSE\n    TOGGLE: TRUE\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n\n\n# Binomials\n\n## Cats n Dogs\n\n> **Research Question:** Is the probability that a student prefers Dogs over Cats greater than 50%?\n\n:::frame\n__Data: Past Surveys__  \nIn the last few years, we have asked students of the statistics courses in the Psychology department to fill out a little survey.  \nAnonymised data are available at [https://uoepsy.github.io/data/surveydata_historical.csv](https://uoepsy.github.io/data/surveydata_historical.csv).  \n\n__Note:__ this does _not_ contain the responses from this year. \n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsurveydata <- \n  read_csv(\"https://uoepsy.github.io/data/surveydata_historical.csv\")\n```\n:::\n\n\n\n:::\n\n\n\n\n<div class='question-begin'>Question 1</div><div class='question-body'>\n\n\nCalculate the proportion of students who chose cats vs dogs in the survey.\nIf the probability that a student prefers dogs to cats is 50%, what would we _expect_ to see?  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints  \n`table() |> prop.table()` might be the quickest way here.   \n:::\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div style=\"display:none;\">\n\n\n\nI sometimes like adding a `|> print() |>` in the middle of these sequences of pipes to print out the intermediary output as well:  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntable(surveydata$catdog) |>\n  print() |>\n  prop.table()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ncat dog \n222 317 \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n      cat       dog \n0.4118738 0.5881262 \n```\n\n\n:::\n:::\n\n\n\n\nIf the probability was 50%, or 0.5, then we would expect the numbers to be equal. We have 539 responses here, so we would expect 269.5 to be team cats, and 269.5 to be team dogs!  \n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 2</div><div class='question-body'>\n\n\n> **Research Question:** Is the probability that a student prefers Dogs over Cats **greater** than 50%?\n\nConduct a test to address the research question.  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\n- Note the \"tailedness\" of the question. Just like `t.test()`, the function we use here should allow us to specify our hypothesis.  \n- You can see an example of this test in [4A #binomials](04a_chisq.html#binomials){target=\"_blank\"}.   \n\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div style=\"display:none;\">\n\n\n\nWe're going to want to use the `binom.test()` function. This is just like the reading, where we tested the proportion of our sample who were left-handed.  \n\nWe can either type in the numbers of \"Dog\" people out of our total number:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbinom.test(317, 539, p = 0.5, alternative = \"greater\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tExact binomial test\n\ndata:  317 and 539\nnumber of successes = 317, number of trials = 539, p-value = 2.468e-05\nalternative hypothesis: true probability of success is greater than 0.5\n95 percent confidence interval:\n 0.5520308 1.0000000\nsample estimates:\nprobability of success \n             0.5881262 \n```\n\n\n:::\n:::\n\n\n\nOr give the function a table.  \n_BUT_ we need to make sure that it is picking up the right value as \"successes\".  \nNotice that this gives us a different result:\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tExact binomial test\n\ndata:  table(surveydata$catdog)\nnumber of successes = 222, number of trials = 539, p-value = 1\nalternative hypothesis: true probability of success is greater than 0.5\n95 percent confidence interval:\n 0.3764991 1.0000000\nsample estimates:\nprobability of success \n             0.4118738 \n```\n\n\n:::\n:::\n\n\n\nThis is because it is taking the first entry as the number of successes. So it is saying that Cat people = 1 and Dog people = 0. But we want it the other way around! You could either create a different table (or switch its order), or simply switch to the alternative being \"less\" (because in this unrealistic binary world, the question \"is the probability of being Dog person >0.5?\" is the same thing as \"is probability of being Cat person <0.5?\")\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n\n# Chi-Square Tests\n\n## Birth-Months\n\n> **Research Question:** Are students more likely to be born in certain months than others?  \n\n:::frame\n__Data: Past Surveys__  \nIn the last few years, we have asked students of the statistics courses in the Psychology department to fill out a little survey.  \nAnonymised data are available at [https://uoepsy.github.io/data/surveydata_historical.csv](https://uoepsy.github.io/data/surveydata_historical.csv).  \n\n__Note:__ this does _not_ contain the responses from this year. \n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsurveydata <- \n  read_csv(\"https://uoepsy.github.io/data/surveydata_historical.csv\")\n```\n:::\n\n\n\n:::\n\n\n\n\n<div class='question-begin'>Question 3</div><div class='question-body'>\n\n\nWhat is your intuition about the distribution of all students' birth-months?  \nDo you think they will be spread uniformly across all months of the year (like a fair 12-sided dice), or do you think people are more likely to be born in certain months more than others?  \n\nPlot the distribution and get an initial idea of how things are looking.  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints  \nYou can do this quickly with `barplot()` and `table()`, or you could create try using `ggplot()` and looking into `geom_bar()`.  \n:::\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n\n<div style=\"display:none;\">\n\n\nThe quick and dirty way to plot:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbarplot(table(surveydata$birthmonth))\n```\n\n::: {.cell-output-display}\n![](04_ex_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\nA ggplot option:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = surveydata, aes(x = birthmonth)) +\n    geom_bar() +\n    labs(x = \"- Birth Month -\")\n```\n\n::: {.cell-output-display}\n![](04_ex_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 4</div><div class='question-body'>\n\n\nWe're going to perform a statistical test to assess the extent to which our data conforms to the hypothesis that people are no more likely to be born on one month than another.  \n\nUnder this hypothesis, what would be the proportional breakdown of observed births in each of the months?  \n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div style=\"display:none;\">\n\n\nIf people are no more likely to be born in one month than another, then we would expect the same proportion of observed births in each month.  \nThere are 12 months, so we would expect $\\frac{1}{12}$ observations in each month.  \n\nWe can write these as: \n$$\n\\begin{align}\n& p_{jan} = 1/12 \\\\\n& p_{feb} = 1/12 \\\\\n& ... \\\\\n& p_{dec} = 1/12 \\\\\n\\end{align}\n$$\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 5</div><div class='question-body'>\n\n\n\nHow many observations in our sample would we *expect* to find with a birthday in January? And in February? ... and so on?  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nHow many responses (i.e. not missing values) do we have for this question?  \n\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n\n<div style=\"display:none;\">\n\n\nThere are 544 people who have non-NA values (`sum(!is.na(surveydata$birthmonth))`).  \n\nUnder the null hypothesis, we would expect $\\frac{1}{12} \\times$ 544 = 45.33 observations born in each month. \n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 6</div><div class='question-body'>\n\n\nThe code below creates counts for each month. Before doing that, it removes the rows which have an NA in them for birthmonth: \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsurveydata |>\n  filter(!is.na(birthmonth)) |>\n  group_by(birthmonth) |>\n  summarise(\n      observed = n()\n  )\n```\n:::\n\n\n\n(A shortcut for this would be `surveydata |> filter(!is.na(birthmonth)) |> count(birthmonth)`)  \n\nAdd to the code above to create columns showing:\n\n- the expected counts $E_i$\n- observed-expected ($O_i - E_i$)\n- the squared differences $(O_i - E_i)^2$\n- the standardised square differences $\\frac{(O_i - E_i)^2}{E_i}$  \n\nThen calculate the $\\chi^2$ statistic (the sum of the standardised squared differences).  \nIf your observed counts matched the expected counts *perfectly*, what would the $\\chi^2$ statistic be? \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints  \nThis was all done in the step-by-step example of a $\\chi^2$ test in [4A #chi2-goodness-of-fit-test](04a_chisq.html#chi2-goodness-of-fit-test){target=\"_blank\"}\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div style=\"display:none;\">\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nchi_table <- \n    surveydata |>\n    filter(!is.na(birthmonth)) |>\n    group_by(birthmonth) |>\n    summarise(\n        observed = n(),\n        expected = sum(!is.na(surveydata$birthmonth))/12,\n        diff = observed-expected,\n        sq_diff = diff^2,\n        std_sq_diff = sq_diff / expected\n    )\nchi_table\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 12 Ã— 6\n   birthmonth observed expected    diff sq_diff std_sq_diff\n   <chr>         <int>    <dbl>   <dbl>   <dbl>       <dbl>\n 1 apr              37     45.3  -8.33   69.4       1.53   \n 2 aug              42     45.3  -3.33   11.1       0.245  \n 3 dec              42     45.3  -3.33   11.1       0.245  \n 4 feb              35     45.3 -10.3   107.        2.36   \n 5 jan              49     45.3   3.67   13.4       0.297  \n 6 jul              54     45.3   8.67   75.1       1.66   \n 7 jun              46     45.3   0.667   0.444     0.00980\n 8 mar              47     45.3   1.67    2.78      0.0613 \n 9 may              49     45.3   3.67   13.4       0.297  \n10 nov              46     45.3   0.667   0.444     0.00980\n11 oct              50     45.3   4.67   21.8       0.480  \n12 sep              47     45.3   1.67    2.78      0.0613 \n```\n\n\n:::\n:::\n\n\n\n\nAnd we can calculate our $\\chi^2$ test statistic by simply summing the values in the last column we created:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsum(chi_table$std_sq_diff)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 7.25\n```\n\n\n:::\n:::\n\n\n\n\nIf all our observed counts are equal to our expected counts, then the `diff` column above will be all $0$, and $0^2=0$, and $\\frac{0}{E_i}$ will be $0$. So $\\chi^2$ will be $0$. \n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 7</div><div class='question-body'>\n\n\nYou can see the distribution of $\\chi^2$ statistics with different degrees of freedom below.  \n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Chi-Square Distributions](https://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Chi-square_pdf.svg/1200px-Chi-square_pdf.svg.png){#fig-chidist fig-align='center' width=80%}\n:::\n:::\n\n\n\n\nWe can find out the proportion of the distribution which falls to either side of a given value of $\\chi^2$ using `pchisq()`. We need to give it our calculated $\\chi^2$ statistic, our degrees of freedom (`df`), which is equal to the number of categories minus 1. We also need to specify whether we want the proportion to the left (`lower.tail=TRUE`) or to the right (`lower.tail=FALSE`).  \n\n1. Using `pchisq()`, calculate the probability of observing a $\\chi^2$ statistic as least as extreme as the one we have calculated.  \n2. Check that these results match with those provided by R's built-in function: `chisq.test(table(surveydata$birthmonth))` (the `table` function will ignore NAs by default, so we don't need to do anything extra for this).    \n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div style=\"display:none;\">\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsum(chi_table$std_sq_diff)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 7.25\n```\n\n\n:::\n\n```{.r .cell-code}\npchisq(sum(chi_table$std_sq_diff), df = 11, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.7784916\n```\n\n\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nchisq.test(table(surveydata$birthmonth))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tChi-squared test for given probabilities\n\ndata:  table(surveydata$birthmonth)\nX-squared = 7.25, df = 11, p-value = 0.7785\n```\n\n\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 8</div><div class='question-body'>\n\n\nWhich months of year had the highest contributions to the chi-square test statistic?  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints  \nThink about your standardised squared deviations. \n:::\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div style=\"display:none;\">\n\n\n**Standardized squared deviations**  \n\nOne possible way to answer this question is to look at the individual contribution of each category to the $\\chi^2$ statistic. We computed these values in an earlier question.  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nchi_table |>\n  select(birthmonth, std_sq_diff)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 12 Ã— 2\n   birthmonth std_sq_diff\n   <chr>            <dbl>\n 1 apr            1.53   \n 2 aug            0.245  \n 3 dec            0.245  \n 4 feb            2.36   \n 5 jan            0.297  \n 6 jul            1.66   \n 7 jun            0.00980\n 8 mar            0.0613 \n 9 may            0.297  \n10 nov            0.00980\n11 oct            0.480  \n12 sep            0.0613 \n```\n\n\n:::\n:::\n\n\n\n\nFrom the barplot we created earlier on, we can see which months make up higher/lower proportions than expected:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(chi_table, aes(x = birthmonth, y = observed/nrow(surveydata))) +\n  geom_col(fill = 'lightblue') +\n  geom_hline(yintercept = 1/12, color = 'red') +\n  theme_classic(base_size = 15)\n```\n\n::: {.cell-output-display}\n![](04_ex_files/figure-html/unnamed-chunk-16-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n**Pearson residuals**\n\nEquivalently, you could answer by looking at Pearson residuals:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nchisq.test(table(surveydata$birthmonth))$residuals\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n        apr         aug         dec         feb         jan         jul \n-1.23768443 -0.49507377 -0.49507377 -1.53472869  0.54458115  1.28719181 \n        jun         mar         may         nov         oct         sep \n 0.09901475  0.24753689  0.54458115  0.09901475  0.69310328  0.24753689 \n```\n\n\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\nThe greatest *absolute* values are for feb and jul, showing that for these months the deviations from expected to observed were the greatest. \n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n## Children's Favourite Colours\n\n> **Research Question:** Do childrens' favourite colours correspond to the those suggested by the internet?  \n\n:::frame\nAccording to one part of the internet, 30% of children have red as their favourite colour, 20% have blue, 15% yellow, 11% purple, 9% green, and 15% prefer some other colour.  \n\nWe collected data from 50 children aged between 2 and 5, and got them to choose one of a set of objects that were identical apart from colour. You can see the data in @tbl-childcols\n\n\n\n\n::: {#tbl-childcols .cell layout-align=\"center\" tbl-cap='Colour preferences of 50 children aged between 2 and 5'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"jpyrryyozk\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#jpyrryyozk table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#jpyrryyozk thead, #jpyrryyozk tbody, #jpyrryyozk tfoot, #jpyrryyozk tr, #jpyrryyozk td, #jpyrryyozk th {\n  border-style: none;\n}\n\n#jpyrryyozk p {\n  margin: 0;\n  padding: 0;\n}\n\n#jpyrryyozk .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#jpyrryyozk .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#jpyrryyozk .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#jpyrryyozk .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#jpyrryyozk .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jpyrryyozk .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jpyrryyozk .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jpyrryyozk .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#jpyrryyozk .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#jpyrryyozk .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#jpyrryyozk .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#jpyrryyozk .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#jpyrryyozk .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#jpyrryyozk .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#jpyrryyozk .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#jpyrryyozk .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#jpyrryyozk .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#jpyrryyozk .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#jpyrryyozk .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jpyrryyozk .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#jpyrryyozk .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#jpyrryyozk .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#jpyrryyozk .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jpyrryyozk .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#jpyrryyozk .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#jpyrryyozk .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jpyrryyozk .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jpyrryyozk .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#jpyrryyozk .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jpyrryyozk .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#jpyrryyozk .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jpyrryyozk .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jpyrryyozk .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jpyrryyozk .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jpyrryyozk .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jpyrryyozk .gt_left {\n  text-align: left;\n}\n\n#jpyrryyozk .gt_center {\n  text-align: center;\n}\n\n#jpyrryyozk .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#jpyrryyozk .gt_font_normal {\n  font-weight: normal;\n}\n\n#jpyrryyozk .gt_font_bold {\n  font-weight: bold;\n}\n\n#jpyrryyozk .gt_font_italic {\n  font-style: italic;\n}\n\n#jpyrryyozk .gt_super {\n  font-size: 65%;\n}\n\n#jpyrryyozk .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#jpyrryyozk .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#jpyrryyozk .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#jpyrryyozk .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#jpyrryyozk .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#jpyrryyozk .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#jpyrryyozk .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#jpyrryyozk .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#jpyrryyozk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"colour\">colour</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Freq\">Freq</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"colour\" class=\"gt_row gt_center\">blue</td>\n<td headers=\"Freq\" class=\"gt_row gt_right\">10</td></tr>\n    <tr><td headers=\"colour\" class=\"gt_row gt_center\">green</td>\n<td headers=\"Freq\" class=\"gt_row gt_right\">6</td></tr>\n    <tr><td headers=\"colour\" class=\"gt_row gt_center\">other</td>\n<td headers=\"Freq\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><td headers=\"colour\" class=\"gt_row gt_center\">purple</td>\n<td headers=\"Freq\" class=\"gt_row gt_right\">8</td></tr>\n    <tr><td headers=\"colour\" class=\"gt_row gt_center\">red</td>\n<td headers=\"Freq\" class=\"gt_row gt_right\">8</td></tr>\n    <tr><td headers=\"colour\" class=\"gt_row gt_center\">yellow</td>\n<td headers=\"Freq\" class=\"gt_row gt_right\">15</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n:::\n\n\n\n<div class='question-begin'>Question 9</div><div class='question-body'>\n\n\nPerform a $\\chi^2$ goodness of fit test to assess the extent to which our sample of children conform to this theorised distribution of colour preferences.  \n\nNo need to do this manually - once is enough. Just go straight to using the `chisq.test()` function.  \nHowever, we will need to get the numbers into R somehow.. \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints  \nYou can make a table from scratch using, for example: `as.table(c(1,2,3,4,5))`.  \n\nFor the test, try using `chisq.test(..., p = c(?,?,?,...) )`.  \nWe saw the use of `chisq.test()` in the example goodness of fit test, [4A #chi2-goodness-of-fit-test](04a_chisq.html#chi2-goodness-of-fit-test){target=\"_blank\"}  \n:::\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div style=\"display:none;\">\n\n\nLet's get the data in:  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nchildcols <- as.table(c(10,6,3,8,8,15))\nnames(childcols) <- c(\"blue\",\"green\",\"other\",\"purple\",\"red\",\"yellow\")\nchildcols\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  blue  green  other purple    red yellow \n    10      6      3      8      8     15 \n```\n\n\n:::\n:::\n\n\n\nOur theoretical probabilities of different colours must match the order in the table which we give `chisq.test()`. They must also always sum to 1.  \n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nchisq.test(childcols, p = c(.20,.09,.15,.11,.30,.15))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in chisq.test(childcols, p = c(0.2, 0.09, 0.15, 0.11, 0.3, 0.15)):\nChi-squared approximation may be incorrect\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tChi-squared test for given probabilities\n\ndata:  childcols\nX-squared = 15.103, df = 5, p-value = 0.009931\n```\n\n\n:::\n:::\n\n\n\n\nNote, we get a warning here of <span style=\"color:blue\">\"Chi-squared approximation may be incorrect\"</span>. This is because some of the expected cell counts are <5.  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nchisq.test(childcols, \n           p = c(.20,.09,.15,.11,.30,.15))$expected\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  blue  green  other purple    red yellow \n  10.0    4.5    7.5    5.5   15.0    7.5 \n```\n\n\n:::\n:::\n\n\n\n\nThere are a couple of options here, but the easiest is to use the functionality of `chisq.test()` that allows us to compute the p-value by using a simulation (similar to the idea we saw in [2B#sampling-&-sampling-distributions](02b_sampling.html#sampling-sampling-distributions){target=\"_blank\"}), rather than by comparing it to a theoretical $\\chi^2$ distribution.  We can do this by using:  \n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nchisq.test(childcols, p = c(.20,.09,.15,.11,.30,.15),\n           simulate.p.value = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tChi-squared test for given probabilities with simulated p-value (based\n\ton 2000 replicates)\n\ndata:  childcols\nX-squared = 15.103, df = NA, p-value = 0.01249\n```\n\n\n:::\n:::\n\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 10</div><div class='question-body'>\n\n\nWhat are the *observed* proportions of children who prefer each colour?  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nLook up the `prop.table()` function?  \n\n:::\n\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div style=\"display:none;\">\n\n\nFrom the help documentation (`?prop.table()`), we see that we can pass `prop.table()` the argument `x`, which needs to be a table. \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprop.table(childcols)*100\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  blue  green  other purple    red yellow \n    20     12      6     16     16     30 \n```\n\n\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbarplot(prop.table(childcols)*100)\n```\n\n::: {.cell-output-display}\n![](04_ex_files/figure-html/unnamed-chunk-25-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Jokes and Tips\n\n:::frame\n__Data: TipJokes__  \n\n> **Research Question:** Can telling a joke affect whether or not a waiter in a coffee bar receives a tip from a customer?  \n\nA [study](https://doi.org/10.1111/j.1559-1816.2002.tb00266.x) published in the Journal of Applied Social Psychology^[Gueaguen, N. (2002). The Effects of a Joke on Tipping When It Is Delivered at the Same Time as the Bill. _Journal of Applied Social Psychology, 32_(9), 1955-1963.] investigated this question at a coffee bar of a famous seaside resort on the west Atlantic coast of France. \nThe waiter randomly assigned coffee-ordering customers to one of three groups. \nWhen receiving the bill, one group also received a card telling a joke, another group received a card containing an advertisement for a local restaurant, and a third group received no card at all. \n\nThe data are available at https://uoepsy.github.io/data/TipJoke.csv.  \nThe dataset contains the variables:\n\n- `Card`: None, Joke, Ad.\n- `Tip`: 1 = The customer left a tip, 0 = The customer did not leave tip. \n\n:::\n\n\n\n\n<div class='question-begin'>Question 11</div><div class='question-body'>\n\n\nProduce a plot and a table to display the relationship between whether or not the customer left a tip, and what (if any) card they received alongside the bill.  \n\nDon't worry about making it all pretty. Mosaic plots in R are a bit difficult. \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints  \n`plot(table(...))` will give you something. You can see one in the example $\\chi^2$ test of independence,[4A #chi2-test-of-independence](04a_chisq.html#chi2-test-of-independence){target=\"_blank\"}.  \n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div style=\"display:none;\">\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntipjoke <- read_csv('https://uoepsy.github.io/data/TipJoke.csv')\n\ntable(tipjoke$Card, tipjoke$Tip)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      \n        0  1\n  Ad   60 14\n  Joke 42 30\n  None 49 16\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(table(tipjoke$Card, tipjoke$Tip))\n```\n\n::: {.cell-output-display}\n![](04_ex_files/figure-html/unnamed-chunk-26-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 12</div><div class='question-body'>\n\n\nWhat would you *expect* the cell counts to look like if there were no relationship between what the waiter left and whether or not the customer tipped?  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nThink about what proportion of customers tipped. \nThen work out how many customers got each type of card. If there were no relationship, then the proportions would be the same in each group. \n\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div style=\"display:none;\">\n\n\nIn total, 60 customers tipped (14+30+16), and 151 did not. So *overall*, 0.28 ($\\frac{60}{(60+151)}$) of customers tip.  \n\n74 customers got an Ad card, 72 customers got a Joke, and 65 got None. If this were independent of whether or not they left a tip, we would expect equal proportions of tippers in each group.  \nSo we would expect 0.28 of each group to leave a tip.  \n\n::: {.callout-caution collapse=\"true\"}\n#### some calculations\n\nYou can think about observed vs expected by looking at the two-way table along with the marginal row and column totals given:   \n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">  </th>\n   <th style=\"text-align:left;\"> 0 </th>\n   <th style=\"text-align:left;\"> 1 </th>\n   <th style=\"text-align:left;\">  </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Ad </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> 74 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Joke </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> 72 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> None </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> 65 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> 151 </td>\n   <td style=\"text-align:left;\"> 60 </td>\n   <td style=\"text-align:left;\"> 211 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\nFor a given cell of the table we can calculate the expected count as $\\text{row total} \\times \\frac{\\text{column total}}{\\text{samplesize}}$:\n\n**Expected:**\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">  </th>\n   <th style=\"text-align:right;\"> 0 </th>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\">  </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Ad </td>\n   <td style=\"text-align:right;\"> 52.96 </td>\n   <td style=\"text-align:right;\"> 21.04 </td>\n   <td style=\"text-align:right;\"> 74 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Joke </td>\n   <td style=\"text-align:right;\"> 51.53 </td>\n   <td style=\"text-align:right;\"> 20.47 </td>\n   <td style=\"text-align:right;\"> 72 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> None </td>\n   <td style=\"text-align:right;\"> 46.52 </td>\n   <td style=\"text-align:right;\"> 18.48 </td>\n   <td style=\"text-align:right;\"> 65 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:right;\"> 151.00 </td>\n   <td style=\"text-align:right;\"> 60.00 </td>\n   <td style=\"text-align:right;\"> 211 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n\nIf you're wondering how we do this in R.. \nhere's our table:  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nt <- tipjoke |>\n  select(Card, Tip) |> table()\nt\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Tip\nCard    0  1\n  Ad   60 14\n  Joke 42 30\n  None 49 16\n```\n\n\n:::\n:::\n\n\n\nHere are the row totals:  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrowSums(t)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Ad Joke None \n  74   72   65 \n```\n\n\n:::\n:::\n\n\n\nand column totals divided by total:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncolSums(t) / sum(t)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        0         1 \n0.7156398 0.2843602 \n```\n\n\n:::\n:::\n\n\n\n\nthere's a complicated bit of code using `%o%` which could do this for us. You don't need to remember %o%, it's very rarely used): \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ne <- rowSums(t) %o% colSums(t) / sum(t)\ne\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            0        1\nAd   52.95735 21.04265\nJoke 51.52607 20.47393\nNone 46.51659 18.48341\n```\n\n\n:::\n:::\n\n\n\n\nOr, alternatively, do it one by one:  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrowSums(t) * (colSums(t) / sum(t))[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Ad     Joke     None \n52.95735 51.52607 46.51659 \n```\n\n\n:::\n\n```{.r .cell-code}\nrowSums(t) * (colSums(t) / sum(t))[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Ad     Joke     None \n21.04265 20.47393 18.48341 \n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 13</div><div class='question-body'>\n\n\nJust like we gave the `chisq.test()` function a table of observed frequencies when we conducted a goodness of fit test in earlier exercises, we can give it a two-way table of observed frequencies to conduct a test of independence.  \n\nTry it now.  \n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div style=\"display:none;\">\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nchisq.test(table(tipjoke$Card, tipjoke$Tip))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  table(tipjoke$Card, tipjoke$Tip)\nX-squared = 9.9533, df = 2, p-value = 0.006897\n```\n\n\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Some RMarkdown/Quarto\n\n\n\n\n\n\n\n\n\n\nUsing one of the $t$-tests we saw in the previous week's exercises, we can use an RMarkdown document in which we write our results so that they get compiled to look nice and pretty:  \n\n::: {.panelset}\n\n::: {.panel}\n#### Writing this\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/hypothesis/rmarkdownbacktick.png){fig-align='center' width=1000px}\n:::\n:::\n\n\n\n\n:::\n::: {.panel}\n#### Compiles to this\n\n:::frame\n\nA one-sided one-sample t-test was conducted in order to determine if the average score on the Procrastination Assessment Scale for Students (PASS) for a sample of 20 students at Edinburgh University was significantly lower ($\\alpha = .05$) than the average score obtained during development of the PASS. \n\nEdinburgh University students scored lower (Mean = 30.7, SD = 3.31) than the score reported by the authors of the PASS (Mean = 33). This difference was statistically significant (t(19)=-3.11, p < .05, one-tailed).  \n\n\n:::\n\n:::\n\n:::\n\nThis is one of the huge benefits of RMarkdown (and \"Quarto\" which is basically RMarkdown v2!). Imagine we collected more data - we wouldn't have to edit all the results, we could simply recompile and they would update for us!  \nNote how it works:  \n\n  - the code chunk saves the results of the `t.test()` function as a named object `res2`.\n  - in text, the backticks <code>&grave;r ... ... ... &grave;</code> are used to execute small bits of R code, and include the output within the text. For instance, the line <code>&grave;r res2\\$statistic |> round(2)&grave;</code> gets the t-statistic from the results, and rounds it to 2 decimal places, which get's printed out as -3.11. \n  - the bits between the dollar signs, e.g. \\$\\\\alpha\\$ will get printed as mathematical symbols such as $\\alpha$. \n\n\n\n::: {.callout-important collapse=\"true\"}\n#### RMarkdown/Quarto documents are self-contained.\n\nYou need to to put **everything** that is needed to reproduce your analysis **in the correct order**.  \n\nFor instance, if you have used the console (bottom left window) to define an object `peppapig <- 30`, you will have an object in your environment (top right window) called \"peppapig\" which has the value 30.  \n\nIf you were to refer to that object in your RMarkdown document, you will be able to run a line of code such as `peppapig/10` because it will find the \"peppapig\" object in **your** environment. __BUT__ you won't be able to compile the document because it \"starts fresh\" (i.e., compiles within its own environment). In order for it to compile, you would need to *define* what \"peppapig\" is **inside** your document, and **before** the document then refers to it. \n\nThe same applies with using functions in from packages. The RMarkdown document needs to know what packages to load before it uses functions from them. Just because *you* yourself have loaded a package in your session, it does not mean the compilation process for your RMarkdown has access to it. \n\n:::\n\nIf you want some extra explanations on these aspects of RMarkdown, then please see Lessons 0-3 of our [Rmd-bootcamp](https://uoepsy.github.io/scs/rmd-bootcamp/){target=\"_blank\"}.  \n\n\n\n<div class='question-begin'>Question 14</div><div class='question-body'>\n\n\nCan you create an RMarkdown/Quarto document which:\n\n1. Reads in the [https://uoepsy.github.io/data/TipJoke.csv](https://uoepsy.github.io/data/TipJoke.csv) data.\n2. Conducts and reports a $\\chi^2$ test of independence examining whether telling a joke affect whether or not a waiter in a coffee bar receives a tip from a customer.\n3. Successfully compiles (\"knits\") into an **.html** file. \n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Optional Extras\n\n\n\n<div class='question-begin'>Optional Extra 1</div><div class='question-body'>\n\n\n> **Research Question:** Do childrens' favourite colours differ from Adults?  \n\n:::frame\nAlong with the 50 children from whom we collected data on their favourite colours, we also had 100 adult participants. You can see the data in @tbl-childadultcols\n\n\n\n\n::: {#tbl-childadultcols .cell layout-align=\"center\" tbl-cap='Colour preferences of 50 children aged between 2 and 5, and 50 Adults (aged 18+)'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"zwwkhhrzsg\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#zwwkhhrzsg table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#zwwkhhrzsg thead, #zwwkhhrzsg tbody, #zwwkhhrzsg tfoot, #zwwkhhrzsg tr, #zwwkhhrzsg td, #zwwkhhrzsg th {\n  border-style: none;\n}\n\n#zwwkhhrzsg p {\n  margin: 0;\n  padding: 0;\n}\n\n#zwwkhhrzsg .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zwwkhhrzsg .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#zwwkhhrzsg .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zwwkhhrzsg .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zwwkhhrzsg .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zwwkhhrzsg .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zwwkhhrzsg .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zwwkhhrzsg .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zwwkhhrzsg .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zwwkhhrzsg .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zwwkhhrzsg .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zwwkhhrzsg .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zwwkhhrzsg .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#zwwkhhrzsg .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#zwwkhhrzsg .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zwwkhhrzsg .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zwwkhhrzsg .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zwwkhhrzsg .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zwwkhhrzsg .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwwkhhrzsg .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#zwwkhhrzsg .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#zwwkhhrzsg .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#zwwkhhrzsg .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwwkhhrzsg .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#zwwkhhrzsg .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#zwwkhhrzsg .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zwwkhhrzsg .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwwkhhrzsg .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zwwkhhrzsg .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zwwkhhrzsg .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zwwkhhrzsg .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zwwkhhrzsg .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zwwkhhrzsg .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwwkhhrzsg .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zwwkhhrzsg .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwwkhhrzsg .gt_left {\n  text-align: left;\n}\n\n#zwwkhhrzsg .gt_center {\n  text-align: center;\n}\n\n#zwwkhhrzsg .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zwwkhhrzsg .gt_font_normal {\n  font-weight: normal;\n}\n\n#zwwkhhrzsg .gt_font_bold {\n  font-weight: bold;\n}\n\n#zwwkhhrzsg .gt_font_italic {\n  font-style: italic;\n}\n\n#zwwkhhrzsg .gt_super {\n  font-size: 65%;\n}\n\n#zwwkhhrzsg .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#zwwkhhrzsg .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#zwwkhhrzsg .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#zwwkhhrzsg .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#zwwkhhrzsg .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#zwwkhhrzsg .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#zwwkhhrzsg .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#zwwkhhrzsg .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#zwwkhhrzsg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"colour\">colour</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"children\">children</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"adults\">adults</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"colour\" class=\"gt_row gt_center\">blue</td>\n<td headers=\"children\" class=\"gt_row gt_right\">10</td>\n<td headers=\"adults\" class=\"gt_row gt_right\">24</td></tr>\n    <tr><td headers=\"colour\" class=\"gt_row gt_center\">green</td>\n<td headers=\"children\" class=\"gt_row gt_right\">6</td>\n<td headers=\"adults\" class=\"gt_row gt_right\">11</td></tr>\n    <tr><td headers=\"colour\" class=\"gt_row gt_center\">other</td>\n<td headers=\"children\" class=\"gt_row gt_right\">3</td>\n<td headers=\"adults\" class=\"gt_row gt_right\">19</td></tr>\n    <tr><td headers=\"colour\" class=\"gt_row gt_center\">purple</td>\n<td headers=\"children\" class=\"gt_row gt_right\">8</td>\n<td headers=\"adults\" class=\"gt_row gt_right\">7</td></tr>\n    <tr><td headers=\"colour\" class=\"gt_row gt_center\">red</td>\n<td headers=\"children\" class=\"gt_row gt_right\">8</td>\n<td headers=\"adults\" class=\"gt_row gt_right\">24</td></tr>\n    <tr><td headers=\"colour\" class=\"gt_row gt_center\">yellow</td>\n<td headers=\"children\" class=\"gt_row gt_right\">15</td>\n<td headers=\"adults\" class=\"gt_row gt_right\">15</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\nGetting this into R is a little more tricky, so we're giving you the code below: \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nas.table(matrix(c(10,6,3,8,8,15,24,11,19,7,24,15), ncol=2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   A  B\nA 10 24\nB  6 11\nC  3 19\nD  8  7\nE  8 24\nF 15 15\n```\n\n\n:::\n:::\n\n\n\n:::\n\nConduct an appropriate test to address the research question.  \n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div style=\"display:none;\">\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nchildadult <- as.table(matrix(c(10,6,3,8,8,15,24,11,19,7,24,15), ncol=2))\n\nchisq.test(childadult)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  childadult\nX-squared = 11.556, df = 5, p-value = 0.04141\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Optional Extra 2</div><div class='question-body'>\n\n\nUsing the data from the past surveys: [https://uoepsy.github.io/data/surveydata_historical.csv](https://uoepsy.github.io/data/surveydata_historical.csv).  \n\nIs students' preference for evenings over mornings associated with a pet preference (cats vs dogs)? \n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div style=\"display:none;\">\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsurveydata <- read_csv(\"https://uoepsy.github.io/data/surveydata_historical.csv\")\n\nsurveydata |> \n  select(ampm, catdog) |>\n  table() |> print() |>\n  chisq.test()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                catdog\nampm             cat dog\n  Evening person  56  72\n  Morning person  33  37\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  print(table(select(surveydata, ampm, catdog)))\nX-squared = 0.09573, df = 1, p-value = 0.757\n```\n\n\n:::\n:::\n\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n\n\n\n\n\n<div class=\"tocify-extend-page\" data-unique=\"tocify-extend-page\" style=\"height: 0;\"></div>",
    "supporting": [
      "04_ex_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/panelset-0.3.0/panelset.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/panelset-0.3.0/panelset.js\"></script>\n<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}