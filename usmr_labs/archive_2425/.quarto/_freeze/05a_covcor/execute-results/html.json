{
  "hash": "8fc3fd06896f7a146889b47ae9e43c60",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"5A: Covariance and Correlation\"\nparams: \n    SHOW_SOLS: TRUE\n    TOGGLE: TRUE\n---\n\n\n\n\n:::lo\nThis reading:  \n\n- How can we describe the relationship between two continuous variables?  \n- How can we test the relationship between two continuous variables?  \n\n:::\n\n\n\n\n\n\n\n\n\n\n\n\nIn the last couple of weeks we have covered a range of the basic statistical tests that can be conducted when we have a single outcome variable, and sometimes also a single explanatory variable. Our outcome variables have been both continuous ($t$-tests) and categorical ($\\chi^2$-tests). We're going to look at one more relationship now, which is that between two continuous variables. This will also provide us with our starting point for the second block of the course.  \n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> outcome </th>\n   <th style=\"text-align:left;\"> explanatory </th>\n   <th style=\"text-align:left;\"> test </th>\n   <th style=\"text-align:left;\"> examines </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> continuous </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> t.test(y, mu = ?) </td>\n   <td style=\"text-align:left;\"> is the mean of y different from [specified value]? </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> continuous </td>\n   <td style=\"text-align:left;\"> binary </td>\n   <td style=\"text-align:left;\"> t.test(y ~ x) </td>\n   <td style=\"text-align:left;\"> is the mean of y different between the two groups? </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> categorical </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> chisq.test(table(y), prob = c(?,...,?)) </td>\n   <td style=\"text-align:left;\"> is the distribution of categories of y different from [specified proportions]? </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> categorical </td>\n   <td style=\"text-align:left;\"> categorical </td>\n   <td style=\"text-align:left;\"> chisq.test(table(y,x)) </td>\n   <td style=\"text-align:left;\"> is the distribution of categories of y dependent on the category of x? </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(243, 227, 229, 255) !important;\"> continuous </td>\n   <td style=\"text-align:left;background-color: rgba(243, 227, 229, 255) !important;\"> continuous </td>\n   <td style=\"text-align:left;background-color: rgba(243, 227, 229, 255) !important;\"> ??? </td>\n   <td style=\"text-align:left;background-color: rgba(243, 227, 229, 255) !important;\"> ??? </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n\n\n\n\n:::frame\n> **Research Question:** Is there a correlation between accuracy and self-perceived confidence of memory recall?  \n\nOur data for this walkthrough is from a (hypothetical) study on memory. Twenty participants studied passages of text (c500 words long), and were tested a week later. The testing phase presented participants with 100 statements about the text. They had to answer whether each statement was true or false, as well as rate their confidence in each answer (on a sliding scale from 0 to 100). The dataset contains, for each participant, the percentage of items correctly answered, and the average confidence rating. Participants' ages were also recorded.   \n\nThe data are available at [\"https://uoepsy.github.io/data/recalldata.csv](https://uoepsy.github.io/data/recalldata.csv).  \n\n:::\n\nLet's take a look visually at the relationships between the percentage of items answered correctly (`recall_accuracy`) and participants' average self-rating of confidence in their answers (`recall_confidence`). Let's also look at the relationship between accuracy and age.  \n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(patchwork)\n\nrecalldata <- read_csv('https://uoepsy.github.io/data/recalldata.csv')\n\nggplot(recalldata, aes(x=recall_confidence, recall_accuracy))+\n  geom_point() + \nggplot(recalldata, aes(x=age, recall_accuracy))+\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](05a_covcor_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\nThese two relationships look quite different.  \n\n+ For participants who tended to be more confident in their answers, the percentage of items they correctly answered tends to be higher.  \n+ The older participants were, the lower the percentage of items they correctly answered tended to be.  \n\nWhich relationship should we be more confident in and why? \n\nIdeally, we would have some means of quantifying the strength and direction of these sorts of relationship. This is where we come to the two summary statistics which we can use to talk about the association between two numeric variables: __Covariance__ and __Correlation__.  \n\n# Covariance \n\nCovariance is the measure of how two variables vary together. \nIt is the change in one variable associated with the change in another variable.   \n\nCovariance is calculated using the following formula:\n\n$$\\mathrm{cov}(x,y)=\\frac{\\sum_{i=1}^n (x_{i}-\\bar{x})(y_{i}-\\bar{y})}{n-1}$$\nwhere:\n\n- $x$ and $y$ are two variables; e.g., `age` and `recall_accuracy`;\n- $i$ denotes the observational unit, such that $x_i$ is value that the $x$ variable takes on the $i$th observational unit, and similarly for $y_i$;\n- $n$ is the sample size.\n\n\nThis can initially look like quite a big equation, so let's break it down.  \n\n:::frame\n__Covariance explained visually__  \n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\nConsider the following scatterplot:  \n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](05a_covcor_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n<br>\nNow let's superimpose a vertical dashed line at the mean of $x$ ($\\bar{x}$) and a horizontal dashed line at the mean of $y$ ($\\bar{y}$):\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](05a_covcor_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n<br>\nNow let's pick one of the points, call it $x_i$, and show $(x_{i}-\\bar{x})$ and $(y_{i}-\\bar{y})$.  \nNotice that this makes a rectangle.  \n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](05a_covcor_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\nAs $(x_{i}-\\bar{x})$ and $(y_{i}-\\bar{y})$ are both positive values, their product --- $(x_{i}-\\bar{x})(y_{i}-\\bar{y})$ --- is positive. \n\nIn fact, for any pair of values $x_i$ and $y_i$ where both values are above their respective means, or both are below, then product $(x_{i}-\\bar{x})(y_{i}-\\bar{y})$ will be positive (remember that a negative multiplied by a negative gives a positive):  \n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](05a_covcor_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\nAnd for all those other points (in blue) the product $(x_{i}-\\bar{x})(y_{i}-\\bar{y})$ is negative:  \n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](05a_covcor_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n<br>\nNow let's take another look at the formula for covariance:  \n\n$$\\mathrm{cov}(x,y)=\\frac{\\sum_{i=1}^n (x_{i}-\\bar{x})(y_{i}-\\bar{y})}{n-1}$$\n  \nIt is the sum of all these products divided by $n-1$. It is the average of the products! You can almost think of this as the average area of all the rectangles!  \nSo for plots like this where we have been colouring them in blue or red, the measure of covariance moves up and down depending upon how much blue vs how much red there is! It will be zero when there is the same amount of blue as there is red. \n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/cov.gif){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n\n\n:::\n\n:::rtip\n**Covariance in R**  \n\nWe can calculate covariance in R using the `cov()` function.  \n`cov()` can take two variables `cov(x = , y = )`.  \n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncov(x = recalldata$recall_accuracy, y = recalldata$recall_confidence)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 118.0768\n```\n\n\n:::\n:::\n\n\n\n  \nIf necessary, we can choose use only the complete observations (i.e. ignoring all rows where either value is an `NA`) by specifying:  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncov(x = ..., y = ..., use = \"complete.obs\")\n```\n:::\n\n\n\n:::\n\n\n::: {.callout-caution collapse=\"true\"}\n### Step-by-step calculations of covariance\n\n1. Create 2 new columns in the memory recall data, one of which is the mean recall accuracy, and one which is the mean recall confidence. \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrecalldata <-\n  recalldata |> mutate(\n    maccuracy = mean(recall_accuracy),\n    mconfidence = mean(recall_confidence)\n  )\n```\n:::\n\n\n\n\n2. Now create three new columns which are:\n\n    i. recall accuracy minus the mean recall accuracy - this is the $(x_i - \\bar{x})$ part.   \n    ii. confidence minus the mean confidence - and this is the $(y_i - \\bar{y})$ part.   \n    iii. the product of i. and ii. - this is calculating $(x_i - \\bar{x})$$(y_i - \\bar{y})$.    \n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrecalldata <- \n  recalldata |> \n    mutate(\n      acc_minus_mean_acc = recall_accuracy - maccuracy,\n      conf_minus_mean_conf = recall_confidence - mconfidence,\n      prod_acc_conf = acc_minus_mean_acc * conf_minus_mean_conf\n    )\n\nrecalldata\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 20 × 9\n   ppt    recall_accuracy recall_confidence   age maccuracy mconfidence\n   <chr>            <dbl>             <dbl> <dbl>     <dbl>       <dbl>\n 1 ppt_1               72              66.6    72      69.2        55.4\n 2 ppt_2               66              47.1    35      69.2        55.4\n 3 ppt_3               47              43.8    48      69.2        55.4\n 4 ppt_4               84              58.9    52      69.2        55.4\n 5 ppt_5               84              75.1    46      69.2        55.4\n 6 ppt_6               58              53.5    41      69.2        55.4\n 7 ppt_7               52              48.5    86      69.2        55.4\n 8 ppt_8               76              67.1    58      69.2        55.4\n 9 ppt_9               41              40.4    59      69.2        55.4\n10 ppt_10              67              46.8    22      69.2        55.4\n11 ppt_11              60              50.6    62      69.2        55.4\n12 ppt_12              67              28.7    40      69.2        55.4\n13 ppt_13              76              69.0    47      69.2        55.4\n14 ppt_14              93              67.9    51      69.2        55.4\n15 ppt_15              71              54.5    34      69.2        55.4\n16 ppt_16              71              64.6    37      69.2        55.4\n17 ppt_17              99              66.3    37      69.2        55.4\n18 ppt_18              66              49.0    51      69.2        55.4\n19 ppt_19              77              58.5    41      69.2        55.4\n20 ppt_20              58              51.4    57      69.2        55.4\n# ℹ 3 more variables: acc_minus_mean_acc <dbl>, conf_minus_mean_conf <dbl>,\n#   prod_acc_conf <dbl>\n```\n\n\n:::\n:::\n\n\n\n\n3. Finally, sum the products, and divide by $n-1$\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrecalldata |>\n  summarise(\n    prod_sum = sum(prod_acc_conf),\n    n = n()\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n  prod_sum     n\n     <dbl> <int>\n1    2243.    20\n```\n\n\n:::\n\n```{.r .cell-code}\n2243.46 / (20-1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 118.0768\n```\n\n\n:::\n:::\n\n\n\n\nWhich is the same result as using `cov()`:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncov(x = recalldata$recall_accuracy, y = recalldata$recall_confidence)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 118.0768\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n# Correlation\n\nOne thing to note with covariance is that it is sensitive to the units of measurement. The covariance between height-in-centimeters and weight-in-grams will be a much bigger number than the covariance between height-in-meters and weight-in-kilograms.  \n\nCorrelation solves this issue, and you can think of correlation as a standardised covariance. It has a scale from negative one to one, on which the distance from zero indicates the strength of the relationship.  \nJust like covariance, positive/negative values reflect the nature of the relationship.  \n\nThe __correlation coefficient__ is a standardised number which quantifies the strength and direction of the **linear** relationship between two variables. In a population it is denoted by $\\rho$, and in a sample it is denoted by $r$.  \n  \nWe can calculate $r$ using the following formula:  \n$$\nr_{(x,y)}=\\frac{\\mathrm{cov}(x,y)}{s_xs_y}\n$$ \n\nWe can actually rearrange this formula to show that the correlation is simply the covariance, but with the values $(x_i - \\bar{x})$ divided by the standard deviation ($s_x$), and the values $(y_i - \\bar{y})$ divided by $s_y$: \n$$\nr_{(x,y)}=\\frac{1}{n-1} \\sum_{i=1}^n \\left( \\frac{x_{i}-\\bar{x}}{s_x} \\right) \\left( \\frac{y_{i}-\\bar{y}}{s_y} \\right)\n$$\n<br>\nThe correlation is the simply the covariance of **standardised** variables (variables expressed as the distance _in standard deviations_ from the mean).    \n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/cor.gif){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n\n:::sticky\n**Properties of correlation coefficients**\n\n+ $-1 \\leq r \\leq 1$\n+ The sign indicates the direction of association\n  + _positive association_ ($r > 0$) means that values of one variable tend to be higher when values of the other variable are higher\n  + _negative association_ ($r < 0$) means that values of one variable tend to be lower when values of the other variable are higher\n  + _no linear association_ ($r \\approx 0$) means that higher/lower values of one variable do not tend to occur with higher/lower values of the other variable \n+ The closer $r$ is to $\\pm 1$, the stronger the linear association\n+ $r$ has no units and does not depend on the units of measurement\n+ The correlation between $x$ and $y$ is the same as the correlation between $y$ and $x$\n\n:::\n\n:::rtip\n**Correlation in R**  \nJust like R has a `cov()` function for calculating covariance, there is a `cor()` function for calculating correlation: \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncor(x = recalldata$recall_accuracy, y = recalldata$recall_confidence)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.6993654\n```\n\n\n:::\n:::\n\n\n\n\nIf necessary, we can choose use only the complete observations (i.e. ignoring all rows where either value is an `NA`) by specifying:  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncor(x = ..., y = ..., use = \"complete.obs\")\n```\n:::\n\n\n\n:::\n\n::: {.callout-note collapse=\"true\"}\n### Step-by-step calculations\n\nWe calculated above that $\\text{cov}(\\text{recall-accuracy}, \\text{recall-confidence})$ = 118.077.  \n  \nTo calculate the _correlation_, we can simply divide this by the standard deviations of the two variables $s_{\\text{recall-accuracy}} \\times s_{\\text{recall-confidence}}$\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrecalldata |> summarise(\n  s_ra = sd(recall_accuracy),\n  s_rc = sd(recall_confidence)\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n   s_ra  s_rc\n  <dbl> <dbl>\n1  14.5  11.6\n```\n\n\n:::\n\n```{.r .cell-code}\n118.08 / (14.527 * 11.622)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.6993902\n```\n\n\n:::\n:::\n\n\n\n\nWhich is the same result as using `cor()`:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncor(x = recalldata$recall_accuracy, y = recalldata$recall_confidence)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.6993654\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Correlation Tests  \n\nNow that we've seen the formulae for _covariance_ and _correlation_, as well as how to quickly calculate them in R using `cov()` and `cor()`, we can use a statistical test to establish the probability of finding an association this strong by chance alone.  \n\n:::statbox\n__Hypotheses:__  \n\nThe hypotheses of the correlation test are, as always, statements about the _population_ parameter (in this case the correlation between the two variables in the population - i.e., $\\rho$).  \n\n\nIf we are conducting a two tailed test, then \n\n- $H_0: \\rho = 0$. There is _not_ a linear relationship between $x$ and $y$ in the population.  \n- $H_1: \\rho \\neq 0$ There is a linear relationship between $x$ and $y$.  \n  \nIf we instead conduct a one-tailed test, then we are testing either\n\n- $H_0: \\rho \\leq 0$ There is a negative or no linear relationship between $x$ and $y$   \nvs  \n$H_1: \\rho > 0$ There is a positive linear relationship between $x$ and $y$.\n- $H_0: \\rho \\geq 0$ There is a positive or no linear relationship between $x$ and $y$   \nvs  \n$H_1: \\rho < 0$ There is a negative linear relationship between $x$ and $y$.  \n\n__Test Statistic__  \n\nThe __test statistic__ for this test here is _another_ $t$ statistic, the formula for which depends on both the observed correlation ($r$) and the sample size ($n$):\n\n$$t = r \\sqrt{\\frac{n-2}{1-r^2}}$$\n\n\n__p-value__  \n\nWe calculate the p-value for our $t$-statistic as the long-run probability of a $t$-statistic with $n-2$ degrees of freedom being less than, greater than, or more extreme in either direction (depending on the direction of our alternative hypothesis) than our observed $t$-statistic.  \n\n__Assumptions__  \n\nFor a test of Pearson's correlation coefficient $r$, we need to make sure a few conditions are met:  \n\n+ Both variables are quantitative\n+ Both variables should be drawn from normally distributed populations.\n+ The relationship between the two variables should be linear.  \n\n:::\n\n::: {.callout-note collapse=\"true\"}\n### Quick and easy `cor.test()`  \n\nWe can test the significance of the correlation coefficient really easily with the function `cor.test()`:  \n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncor.test(recalldata$recall_accuracy, recalldata$recall_confidence)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  recalldata$recall_accuracy and recalldata$recall_confidence\nt = 4.1512, df = 18, p-value = 0.0005998\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.3719603 0.8720125\nsample estimates:\n      cor \n0.6993654 \n```\n\n\n:::\n:::\n\n\n\n\nby default, `cor.test()` will include only observations that have no missing data on either variable.  \ne.g., running `cor.test()` on `x` and `y` in the dataframe below will include only the yellow rows:  \n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> x </th>\n   <th style=\"text-align:right;\"> y </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;font-weight: bold;background-color: rgba(252, 187, 6, 255) !important;\"> 2 </td>\n   <td style=\"text-align:right;font-weight: bold;background-color: rgba(252, 187, 6, 255) !important;\"> 6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;font-weight: bold;background-color: rgba(252, 187, 6, 255) !important;\"> 4 </td>\n   <td style=\"text-align:right;font-weight: bold;background-color: rgba(252, 187, 6, 255) !important;\"> 7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;font-weight: bold;background-color: rgba(252, 187, 6, 255) !important;\"> 5 </td>\n   <td style=\"text-align:right;font-weight: bold;background-color: rgba(252, 187, 6, 255) !important;\"> 9 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n:::\n\n::: {.callout-note collapse=\"true\"}\n### Step-by-step calculations\n\nOr, if we want to calculate our test statistic manually: \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#calculate r\nr = cor(recalldata$recall_accuracy, recalldata$recall_confidence)\n\n#get n\nn = nrow(recalldata)\n\n#calculate t    \ntstat = r * sqrt((n - 2) / (1 - r^2))\n\n#calculate p-value for t, with df = n-2 \n2*(1-pt(tstat, df=n-2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.0005998222\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n::: {.callout-caution collapse=\"true\"}\n#### optional: (completely optional!) why t?\n\nWhy exactly do we have a $t$ statistic? We're calculating $r$, not $t$??  \n\nRemember that in hypothesis testing, we need a distribution against which to compare a statistic. But $r$ is bounded (it can only be between -1 and 1). This means the distributions of \"$r$'s that we would expect if under repeated sampling\" is not easily defined in a standard way. Consider how the shape changes when our sample size changes:  \n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](05a_covcor_files/figure-html/unnamed-chunk-26-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\nSo what we do is convert the $r$ statistic to a $t$ statistic, and then we can compare _that_ to a $t$ distribution!  \n\n$t$ statistics are generally calculated by using $\\frac{estimate - 0}{standard\\, error}$.  \nThe standard error for a correlation $r$ is quantifiable as $\\sqrt{\\frac{(1-r^2)}{(n-2)}}$.  \nWe can think of this as what variance gets left-over ($1-r^2$) in relation to how much data is free to vary ($n-2$ because we have calculated 2 means in the process of getting $r$). This logic maps to how our standard error of the mean was calculated $\\frac{\\sigma}{\\sqrt{n}}$, in that it is looking at $\\frac{\\text{leftover variation}}{\\text{free datapoints}}$.  \n\nWhat this means is we can convert $r$ into a $t$ that we can then test!  \n\n$$\nt = \\, \\, \\frac{r}{SE_r} \\,\\,=\\,\\, \\frac{r}{\\sqrt{\\frac{(1-r^2)}{(n-2)}}} \\,\\,=\\,\\, r \\sqrt{\\frac{n-2}{1-r^2}}\n$$\n\n\n:::\n\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Cautions!\n\nCorrelation is an invaluable tool for quantifying relationships between variables, but __must be used with care__.  \n\nBelow are a few things to be aware of when we talk about correlation. \n\n:::frame\n__Correlation can be heavily affected by outliers. Always plot your data!__  \n\nThe two plots below only differ with respect to the inclusion of _one_ observation. However, the correlation coefficient for the two sets of observations is markedly different.  \n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](05a_covcor_files/figure-html/unnamed-chunk-27-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n:::\n\n:::frame\n__r = 0 means no linear association. The variables could still be otherwise associated. Always plot your data!__  \n\nThe correlation coefficient in @fig-joface below is negligible, suggesting no _linear_ association. The word \"linear\" here is crucial - the data are very clearly related. \n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Unrelated data?](05a_covcor_files/figure-html/fig-joface-1.png){#fig-joface fig-align='center' width=80%}\n:::\n:::\n\n\n\n\nSimilarly, take look at all the sets of data in @fig-datasaurus below. The summary statistics (means and standard deviations of each variable, and the correlation) are almost identical, but the visualisations suggest that the data are very different from one another.\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Datasaurus! From Matejka, J., & Fitzmaurice, G. (2017, May): Same stats, different graphs: generating datasets with varied appearance and identical statistics through simulated annealing.](https://media1.giphy.com/media/UN2kVJQeMFUje/source.gif){#fig-datasaurus fig-align='center' width=80%}\n:::\n:::\n\n\n\n:::\n\n:::frame\n__Correlation does not imply causation!__  \n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![https://twitter.com/quantitudepod/status/1309135514839248896](images/covcor/corcaus.jpeg){#fig-xkcdcor fig-align='center' width=80%}\n:::\n:::\n\n\n\n\nYou will have likely heard the phrase \"correlation does not imply causation\". There is even a whole [wikipedia entry](https://en.wikipedia.org/wiki/Correlation_does_not_imply_causation) devoted to the topic.  \n\n__Just because you observe an association between x and y, we should not deduce that x causes y__\n\nAn often cited [paper](http://www.nejm.org/doi/full/10.1056/NEJMon1211064){target=\"_blank\"} which appears to fall foul of this error took a correlation between a country's chocolate consumption and its number of nobel prize winners (see @fig-choco) to suggest a _causal relationship_ between the two (\"chocolate intake provides the abundant fertile ground needed for the sprouting of Nobel laureates\"):  \n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Chocolate consumption causes more Nobel Laureates?](images/covcor/choco.jpeg){#fig-choco fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n:::\n\n\n<div class=\"tocify-extend-page\" data-unique=\"tocify-extend-page\" style=\"height: 0;\"></div>\n\n",
    "supporting": [
      "05a_covcor_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}