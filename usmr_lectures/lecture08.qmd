---
title: "Interactions"
---

```{r}
#| label: setup
#| include: false

library(tidyverse)
source('_theme/theme_quarto.R')
```

```{r}
#| include: false

load("R/reading.Rdata")
load("R/reading2.Rdata")
```

## Two Weeks Ago {transition="zoom"}

![](img/playmo_teach.jpg){.center-img}


## Two Weeks Ago {transition="zoom"}

```{r}
mod.m <- lm(R_AGE ~ age + hrs_wk, data=reading)
summary(mod.m)
```

## Two Weeks Ago

```{r}
#| include: false
steps=49
age <- with(reading,seq(min(age),max(age),length=steps))
hrs_wk <- with(reading,seq(min(hrs_wk),max(hrs_wk),length=steps))
newdat <- expand.grid(age=age,hrs_wk=hrs_wk)
```


```{r}
#| label: 3d
#| echo: false
#| fig-align: center
library(rgl)

fit <- lm(R_AGE~age+hrs_wk,data=reading)
R_AGE <- matrix(predict(fit, newdat),steps,steps)
plot3d(x=reading$hrs_wk,y=reading$age,z=reading$R_AGE,
       type='s',
       radius=.1,
       xlab="practise",ylab="age",zlab="READING AGE")
persp3d(hrs_wk,age,R_AGE,col="lightgrey",alpha=0.5,add=TRUE)
rglwidget()
```

## Model with Interaction

```{r}
#| label: 3di
#| echo: false
#| fig-align: center
fit <- lm(R_AGE~age*hrs_wk,data=reading)
R_AGE <- matrix(predict(fit, newdat),steps,steps)
plot3d(x=reading$hrs_wk,y=reading$age,z=reading$R_AGE,
       type='s',
       radius=.1,
       xlab="practise",ylab="age",zlab="READING AGE")
persp3d(hrs_wk,age,R_AGE,col="lightgrey",alpha=0.5,add=TRUE)
rglwidget()
```

