---
title: "Interactions"
---

```{r}
#| label: setup
#| include: false

library(tidyverse)
source('_theme/theme_quarto.R')
```

```{r}
#| include: false
load("R/reading.Rdata")
load("R/reading2.Rdata")
```

## Two Weeks Ago {transition="zoom"}

![](img/playmo_teach.jpg){.center-img}

## Two Weeks Ago {transition="zoom"}

```{r}
#| echo: false
library(gt)

reading |> slice(c(1:3,48:50)) %>% gt() |>
  data_color(columns=c("age","hrs_wk","R_AGE"),colors="#d0d9ff",alpha=.8) |>
  tab_options(table.font.size=pct(70))
```


## Two Weeks Ago {transition="zoom"}

```{r}
mod.m <- lm(R_AGE ~ age + hrs_wk, data=reading)
summary(mod.m)
```

## Two Weeks Ago

```{r}
#| include: false
steps=49
age <- with(reading,seq(min(age),max(age),length=steps))
hrs_wk <- with(reading,seq(min(hrs_wk),max(hrs_wk),length=steps))
newdat <- expand.grid(age=age,hrs_wk=hrs_wk)
```


```{r}
#| label: 3d
#| echo: false
#| fig-align: center
library(rgl)

fit <- lm(R_AGE~age+hrs_wk,data=reading)
R_AGE <- matrix(predict(fit, newdat),steps,steps)
plot3d(x=reading$hrs_wk,y=reading$age,z=reading$R_AGE,
       type='s',
       radius=.1,
       xlab="practise",ylab="age",zlab="READING AGE")
persp3d(hrs_wk,age,R_AGE,col="lightgrey",alpha=0.5,add=TRUE)
rglwidget()
```

## How Good is the Model?

```r
plot(mod.m, which=1:4)
```

```{r}
#| echo: false
#| fig-align: center
par(mfrow=c(2,2))
plot(mod.m, which=1:4)
```

## Next Steps

- (obviously) we could add `method` as a predictor



## Model with Interaction

```{r}
#| label: 3di
#| echo: false
#| fig-align: center
fit <- lm(R_AGE~age*hrs_wk,data=reading)
R_AGE <- matrix(predict(fit, newdat),steps,steps)
plot3d(x=reading$hrs_wk,y=reading$age,z=reading$R_AGE,
       type='s',
       radius=.1,
       xlab="practise",ylab="age",zlab="READING AGE")
persp3d(hrs_wk,age,R_AGE,col="lightgrey",alpha=0.5,add=TRUE)
rglwidget()
```

